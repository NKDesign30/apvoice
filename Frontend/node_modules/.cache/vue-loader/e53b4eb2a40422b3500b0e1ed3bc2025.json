{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/src/views/Raffle.vue?vue&type=style&index=0&id=4962a7a2&lang=scss&scoped=true&","dependencies":[{"path":"/app/src/views/Raffle.vue","mtime":1683275992581},{"path":"/app/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/app/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jaG9pY2UtY29udGFpbmVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgbWF4LXdpZHRoOiA3MDBweDsKICBtYXJnaW46IDAgYXV0bzsKfQoKLmNob2ljZSB7CiAgJi1sYWJlbCB7CiAgICBAYXBwbHkgYm9yZGVyLWdyYXktNzAwOwogICAgQGFwcGx5IGJsb2NrOwogICAgQGFwcGx5IGJvcmRlci00OwogICAgQGFwcGx5IGN1cnNvci1wb2ludGVyOwogICAgQGFwcGx5IGgtMTY7CiAgICBAYXBwbHkgb3ZlcmZsb3ctaGlkZGVuOwogICAgQGFwcGx5IHJlbGF0aXZlOwogICAgQGFwcGx5IHJvdW5kZWQtZnVsbDsKICAgIHdpZHRoOiAzMDBweDsKICAgIEBhcHBseSBtLTI7CgogICAgJjpob3ZlciwKICAgICYuaXMtYWN0aXZlIHsKICAgICAgQGFwcGx5IGJvcmRlci1ncmF5LTkwMDsKICAgIH0KICB9CgogICYtdGV4dCB7CiAgICBAYXBwbHkgYWJzb2x1dGU7CiAgICBAYXBwbHkgYmctd2hpdGU7CiAgICBAYXBwbHkgYm9yZGVyLTU7CiAgICBAYXBwbHkgYm9yZGVyLXdoaXRlOwogICAgQGFwcGx5IGZsZXg7CiAgICBAYXBwbHkgaC1mdWxsOwogICAgQGFwcGx5IGl0ZW1zLWNlbnRlcjsKICAgIEBhcHBseSBsZWZ0LTA7CiAgICBAYXBwbHkganVzdGlmeS1jZW50ZXI7CiAgICBAYXBwbHkgcm91bmRlZC1mdWxsOwogICAgQGFwcGx5IHRleHQtZ3JheS03MDA7CiAgICBAYXBwbHkgdGV4dC14bDsKICAgIEBhcHBseSB0b3AtMDsKICAgIEBhcHBseSB3LWZ1bGw7CiAgfQoKICAmLWxhYmVsOmhvdmVyICYtdGV4dCwKICAmLWxhYmVsLmlzLWFjdGl2ZSAmLXRleHQgewogICAgQGFwcGx5IGJnLWdyYXktOTAwOwogICAgQGFwcGx5IHRleHQtd2hpdGU7CiAgfQp9CgouZGVsZXRlIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgdG9wOiAtMTBweDsKfQoKLmhyZWYtZGVjb3JhdGlvbiB7CiAgL2RlZXAvIGEgewogICAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmUgIWltcG9ydGFudDsKICB9Cn0KCg=="},{"version":3,"sources":["Raffle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwdA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Raffle.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <apo-wait for=\"raffle\">\n      <template #waiting>\n        <apo-loading-overlay\n          class=\"my-15\"\n          :message=\"$t('loaders.raffle')\"\n        />\n      </template>\n      <apo-not-found-page v-if=\"isOverview\" />\n      <div v-else>\n        <div v-if=\"raffleDetail\">\n          <apo-stage\n            v-if=\"stage\"\n            :stage-data=\"stage\"\n          />\n          <component\n            :is=\"`apo-cms-${renderer}-renderer`\"\n            v-for=\"(components, renderer) in content\"\n            :key=\"`${renderer}-renderer`\"\n            :components=\"components || []\"\n          />\n          <div v-if=\"participationCheck\">\n            <form\n              v-if=\"\n                !submitSuccessful &&\n                  (!hasParticipated ||\n                  raffleDetail.configuration.participation === 'Several times') &&\n                  !participationLimitReached &&\n                  !raffleExpired\n              \"\n              ref=\"submitForm\"\n              @submit.prevent=\"submit\"\n            >\n              <div\n                v-if=\"contest\"\n                class=\"py-10\"\n              >\n                <div class=\"container\">\n                  <div\n                    v-if=\"contest.headline\"\n                    class=\"text-center mb-4\"\n                  >\n                    {{ contest.headline }}\n                  </div>\n                  <div class=\"choice-container\">\n                    <div\n                      v-if=\"contest.type === 'Choice'\"\n                      class=\"flex items-center justify-center flex-wrap\"\n                    >\n                      <label\n                        v-for=\"choice in contest.choices\"\n                        :key=\"choice.choice\"\n                        :for=\"choice.choice\"\n                        class=\"choice-label\"\n                        :class=\"{ 'is-active': choice.choice === selectedChoice }\"\n                        :title=\"choice.choice\"\n                      >\n                        <input\n                          :id=\"choice.choice\"\n                          v-model=\"selectedChoice\"\n                          class=\"h-full w-full cursor-pointer\"\n                          name=\"contest\"\n                          type=\"radio\"\n                          :value=\"choice.choice\"\n                          required\n                        >\n\n                        <div\n                          class=\"choice-text\"\n                          v-text=\"choice.choice\"\n                        />\n                      </label>\n                    </div>\n                    <div\n                      v-else-if=\"contest.type === 'Text Input'\"\n                      class=\"w-full\"\n                    >\n                      <apo-textarea\n                        class=\"mt-4 w-full h-40\"\n                        :maxlength=\"-1\"\n                        name=\"contest\"\n                        :value=\"textInput\"\n                        required\n                        @input=\"onTextInputChange\"\n                      />\n                    </div>\n                    <div\n                      v-else-if=\"contest.type === 'Upload'\"\n                      class=\"flex flex-col items-center justify-center\"\n                    >\n                      <apo-icon\n                        class=\"w-16 h-16 mb-8\"\n                        src=\"upload\"\n                      />\n                      <apo-button\n                        class=\"button button--primary button--tiny shadow-hard relative\n                               cursor-pointer\"\n                      >\n                        <span\n                          class=\"cursor-pointer\"\n                          v-text=\"$t('raffle.chooseFile')\"\n                        />\n                        <input\n                          ref=\"fileUpload\"\n                          class=\"absolute left-0 top-0 opacity-0 w-full h-full cursor-pointer\"\n                          type=\"file\"\n                          name=\"contest\"\n                          required\n                          @change=\"onUploadFileChange\"\n                        >\n                      </apo-button>\n                      <div\n                        v-if=\"fileName\"\n                        class=\"my-6\"\n                      >\n                        <span>{{ fileName }}</span>\n                        <apo-icon\n                          class=\"delete w-3 h-3 ml-2 cursor-pointer\"\n                          src=\"close\"\n                          @click=\"resetFile\"\n                        />\n                      </div>\n                      <div\n                        v-if=\"uploadError\"\n                        class=\"container text-center\"\n                      >\n                        <p\n                          class=\"text-red-500\"\n                          v-text=\"$t('raffle.uploadFormat')\"\n                        />\n                      </div>\n                    </div>\n                    <div\n                      v-else\n                    >\n                      <input\n                        type=\"hidden\"\n                        name=\"contest\"\n                        value=\"\"\n                      >\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div\n                v-if=\"form.inputfields.length > 0 || form.checkboxes.length > 0\"\n                class=\"container py-10\"\n              >\n                <div class=\"w-full tablet:flex tablet:justify-between tablet:flex-wrap\">\n                  <div\n                    v-for=\"inputfield in form.inputfields\"\n                    :key=\"inputfield.name\"\n                    class=\"w-full tablet:w-5/12 mt-8\"\n                  >\n                    <apo-input-label v-text=\"$t('raffle.form.' + inputfield.name)\" />\n                    <apo-input\n                      :id=\"inputfield.name\"\n                      v-model=\"inputfield.value\"\n                      :name=\"inputfield.name\"\n                      class=\"mt-2\"\n                      :required=\"true\"\n                      @keydown.enter=\"$emit('submit')\"\n                    />\n                  </div>\n                </div>\n                <div\n                  v-for=\"checkbox in form.checkboxes\"\n                  :key=\"checkbox.name\"\n                  class=\"w-full mt-12 tablet:flex tablet:justify-start tablet:items-center\"\n                >\n                  <Input\n                    :id=\"checkbox.name\"\n                    v-model=\"checkbox.value\"\n                    :name=\"checkbox.name\"\n                    type=\"checkbox\"\n                    :required=\"checkbox.required\"\n                  />\n                  <label\n                    :for=\"checkbox.name\"\n                    class=\"inline ml-2 cursor-pointer href-decoration\"\n                    v-html=\"checkbox.name\"\n                  />\n                </div>\n                <div class=\"w-full mt-12 flex justify-center\">\n                  <apo-button\n                    class=\"button button--primary button--tiny shadow-hard relative cursor-pointer\"\n                    type=\"submit\"\n                    :disabled=\"isBusy\"\n                  >\n                    <apo-spinner\n                      v-if=\"isBusy\"\n                      class=\"mr-4\"\n                      size=\"small\"\n                    />\n                    <span\n                      class=\"cursor-pointer\"\n                      v-text=\"$t('raffle.participate')\"\n                    />\n                  </apo-button>\n                </div>\n              </div>\n            </form>\n            <div v-else>\n              <div\n                v-if=\"\n                  (hasParticipated && raffleDetail.configuration.participation === 'Once') ||\n                    (hasParticipated && (participationLimitReached || raffleExpired)) ||\n                    submitSuccessful\n                \"\n                class=\"container text-center\"\n              >\n                <h2 v-text=\"$t('raffle.congratulation')\" />\n                <div class=\"border-green-300 border-8 rounded-full p-8 my-8 inline-block\">\n                  <apo-icon\n                    class=\"w-16 h-16 text-green-300\"\n                    src=\"check\"\n                  />\n                </div>\n              </div>\n              <div v-else>\n                <div\n                  v-if=\"participationLimitReached\"\n                  class=\"container text-center\"\n                >\n                  <h2 v-text=\"$t('raffle.maxParticipants')\" />\n                  <div class=\"border-red-500 border-8 rounded-full p-8 my-8 inline-block\">\n                    <apo-icon\n                      class=\"w-16 h-16 text-red-500\"\n                      src=\"close\"\n                    />\n                  </div>\n                </div>\n                <div\n                  v-if=\"raffleExpired\"\n                  class=\"container text-center\"\n                >\n                  <h2 v-text=\"$t('raffle.expired')\" />\n                  <div class=\"border-red-500 border-8 rounded-full p-8 my-8 inline-block\">\n                    <apo-icon\n                      class=\"w-16 h-16 text-red-500\"\n                      src=\"close\"\n                    />\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <apo-not-found-page v-else />\n      </div>\n    </apo-wait>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex';\nimport NotFoundPage from '@/components/cms/NotFoundPage.vue';\nimport { RAFFLE_FETCH_ALL } from '@/store/types/action-types';\nimport RaffleService from '@/services/api/RaffleService';\nimport themeSettings from '@/mixins/theme-settings';\nimport LoadingOverlay from '@/components/ui/LoadingOverlay.vue';\nimport Stage from '@/components/template/Stage.vue';\nimport CmsContentRenderer from '@/components/cms/CmsContentRenderer.vue';\nimport Textarea from '@/components/form-renderer/Textarea.vue';\nimport Input from '@/components/form/Input.vue';\nimport InputLabel from '@/components/form-renderer/InputLabel.vue';\nimport Checkbox from '@/components/form/Checkbox.vue';\n\nexport default {\n  components: {\n    'apo-loading-overlay': LoadingOverlay,\n    'apo-not-found-page': NotFoundPage,\n    'apo-stage': Stage,\n    'apo-cms-content-renderer': CmsContentRenderer,\n    'apo-textarea': Textarea,\n    'apo-input': Input,\n    'apo-input-label': InputLabel,\n    'apo-checkbox': Checkbox,\n  },\n\n  mixins: [themeSettings('raffle')],\n\n  data() {\n    return {\n      isOverview: true,\n      hasParticipated: false,\n      raffleExpired: false,\n      participationLimitReached: false,\n      participationCheck: false,\n      selectedChoice: null,\n      textInput: '',\n      fileName: '',\n      fileUpload: '',\n      form: {\n        inputfields: [],\n        checkboxes: [],\n      },\n      isBusy: false,\n      submitSuccessful: false,\n      uploadError: false,\n    };\n  },\n\n  computed: {\n    ...mapGetters(['isAuthenticated', 'language', 'raffle', 'user']),\n\n    raffleDetail() {\n      if (this.$route.params.slug && this.raffle.length) {\n        return this.raffle.find(object => String(object.slug) === String(this.$route.params.slug));\n      }\n      return null;\n    },\n\n    stage() {\n      return {\n        minimum_height: this.raffleDetail.stage.minimum_height,\n        slides: this.raffleDetail.stage.slides,\n      };\n    },\n\n    content() {\n      return { content: this.raffleDetail.content };\n    },\n\n    contest() {\n      return this.raffleDetail.contest;\n    },\n\n    formFields() {\n      return this.raffleDetail ? this.raffleDetail.form : null;\n    },\n  },\n\n  watch: {\n    $route: {\n      immediate: true,\n      handler(route) {\n        if (route.params.slug) {\n          this.isOverview = false;\n        } else {\n          this.isOverview = true;\n        }\n      },\n    },\n  },\n\n  methods: {\n    ...mapActions([RAFFLE_FETCH_ALL]),\n\n    raffleDetails(slug) {\n      this.$router.push({ name: 'raffles', params: { slug } });\n    },\n\n    checkParticipation(data) {\n      this.participations = data.data.filter(\n        participant => Number(participant.raffle_id) === Number(this.raffleDetail.id),\n      );\n      this.participationLimitReached = this.raffleDetail.configuration.participant_limitation\n        ? !(\n          this.participations.length\n            < Number(this.raffleDetail.configuration.participant_limitation)\n        )\n        : false;\n      this.raffleExpired = this.raffleDetail.configuration.expire_date\n        ? new Date(this.raffleDetail.configuration.expire_date) < new Date()\n        : false;\n      this.hasParticipated = this.participations.filter(\n        participant => Number(participant.user_id) === Number(this.user.id),\n      ).length > 0;\n      this.participationCheck = true;\n    },\n\n    onTextInputChange(event) {\n      this.textInput = event;\n    },\n\n    onUploadFileChange() {\n      this.handleUploadFile();\n    },\n\n    async handleUploadFile() {\n      if (!this.$refs.fileUpload.files || this.$refs.fileUpload.files.length === 0) {\n        return;\n      }\n\n      this.fileName = this.$refs.fileUpload.files[0].name;\n    },\n\n    resetFile() {\n      this.fileName = '';\n      this.fileUpload = '';\n    },\n\n    createFormData() {\n      if (!this.formFields) {\n        return;\n      }\n\n      this.form.inputfields = [\n        { name: 'firstName', value: this.user.firstName },\n        { name: 'lastName', value: this.user.lastName },\n        { name: 'pharmacyName', value: '' },\n        { name: 'pharmacyCountry', value: '' },\n        { name: 'pharmacyStreet', value: '' },\n        { name: 'pharmacyStreetNumber', value: '' },\n        { name: 'pharmacyZipCode', value: '' },\n        { name: 'pharmacyCity', value: '' },\n      ];\n      if (this.formFields.checkboxes.length > 0) {\n        this.form.checkboxes = this.formFields.checkboxes.map(checkbox => ({\n          ...checkbox,\n          value: 'off',\n        }));\n      }\n    },\n\n    submit() {\n      const formData = new FormData(this.$refs.submitForm);\n      formData.append('raffle_id', Number(this.raffleDetail.id));\n      if (this.contest.type === 'Upload') formData.append('contest', this.fileName);\n\n      this.isBusy = true;\n\n      RaffleService.store(formData)\n        .then(response => {\n          this.isBusy = false;\n          this.submitSuccessful = true;\n          const data = JSON.parse(response.data);\n          if (data.state === false) {\n            this.hasParticipated = false;\n            this.submitSuccessful = false;\n            this.uploadError = true;\n          }\n        })\n        .catch(() => {\n          this.isBusy = false;\n        });\n\n      /* UserService.updateUserProfile(this.user, data)\n        .then(() => {\n          this.$store.dispatch(AUTH_FETCH_CURRENT_USER);\n        })\n        .catch(({ response }) => {\n          this.errors.clear();\n\n          if (response.status === 400 && response.data.code === 'rest_invalid_param') {\n            this.errors.assign(response.data.data.params);\n          }\n        })\n        .finally(() => {\n          this.isBusy = false;\n        }); */\n    },\n  },\n\n  created() {\n    this[RAFFLE_FETCH_ALL]()\n      .then(() => {\n        this.createFormData();\n        RaffleService.getStored().then(data => {\n          this.checkParticipation(data);\n        });\n      })\n      .catch(error => {\n        console.log('error retrieving the posts', error);\n      });\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.choice-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  max-width: 700px;\n  margin: 0 auto;\n}\n\n.choice {\n  &-label {\n    @apply border-gray-700;\n    @apply block;\n    @apply border-4;\n    @apply cursor-pointer;\n    @apply h-16;\n    @apply overflow-hidden;\n    @apply relative;\n    @apply rounded-full;\n    width: 300px;\n    @apply m-2;\n\n    &:hover,\n    &.is-active {\n      @apply border-gray-900;\n    }\n  }\n\n  &-text {\n    @apply absolute;\n    @apply bg-white;\n    @apply border-5;\n    @apply border-white;\n    @apply flex;\n    @apply h-full;\n    @apply items-center;\n    @apply left-0;\n    @apply justify-center;\n    @apply rounded-full;\n    @apply text-gray-700;\n    @apply text-xl;\n    @apply top-0;\n    @apply w-full;\n  }\n\n  &-label:hover &-text,\n  &-label.is-active &-text {\n    @apply bg-gray-900;\n    @apply text-white;\n  }\n}\n\n.delete {\n  position: relative;\n  top: -10px;\n}\n\n.href-decoration {\n  /deep/ a {\n    text-decoration: underline !important;\n  }\n}\n\n</style>\n"]}]}