{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/src/components/content/selection/Selection.vue?vue&type=script&lang=js&","dependencies":[{"path":"/app/src/components/content/selection/Selection.vue","mtime":1683275992555},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgdHJhbnNmb3JtIGZyb20gJ2xvZGFzaC90cmFuc2Zvcm0nOwppbXBvcnQgU2VsZWN0aW9uQ29weVF1ZXN0aW9uIGZyb20gJ0AvY29tcG9uZW50cy9jb250ZW50L3NlbGVjdGlvbi9TZWxlY3Rpb25Db3B5UXVlc3Rpb24udnVlJzsKaW1wb3J0IFNlbGVjdGlvbkltYWdlUXVlc3Rpb24gZnJvbSAnQC9jb21wb25lbnRzL2NvbnRlbnQvc2VsZWN0aW9uL1NlbGVjdGlvbkltYWdlUXVlc3Rpb24udnVlJzsKaW1wb3J0IFNlbGVjdGlvblByb2dyZXNzIGZyb20gJ0AvY29tcG9uZW50cy9jb250ZW50L3NlbGVjdGlvbi9TZWxlY3Rpb25Qcm9ncmVzcy52dWUnOwppbXBvcnQgU2VsZWN0aW9uUmVzdWx0IGZyb20gJ0AvY29tcG9uZW50cy9jb250ZW50L3NlbGVjdGlvbi9TZWxlY3Rpb25SZXN1bHQudnVlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICAnYXBvLXNlbGVjdGlvbi1jb3B5LXF1ZXN0aW9uJzogU2VsZWN0aW9uQ29weVF1ZXN0aW9uLAogICAgJ2Fwby1zZWxlY3Rpb24taW1hZ2UtcXVlc3Rpb24nOiBTZWxlY3Rpb25JbWFnZVF1ZXN0aW9uLAogICAgJ2Fwby1zZWxlY3Rpb24tcHJvZ3Jlc3MnOiBTZWxlY3Rpb25Qcm9ncmVzcywKICAgICdhcG8tc2VsZWN0aW9uLXJlc3VsdCc6IFNlbGVjdGlvblJlc3VsdCwKICB9LAoKICBwcm9wczogewogICAgc2VsZWN0aW9uX2l0ZW1zOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0OiAoKSA9PiBbXSwKICAgIH0sCgogICAgcmVzdWx0X3BhZ2U6IHsKICAgICAgdHlwZTogW0FycmF5LCBCb29sZWFuXSwKICAgICAgZGVmYXVsdDogKCkgPT4gW10sCiAgICB9LAogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50UXVlc3Rpb25JbmRleDogMCwKICAgICAgcmVzdWx0OiB7fSwKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHF1ZXN0aW9ucygpIHsKICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uX2l0ZW1zOwogICAgfSwKCiAgICByZXN1bHRQYWdlQ29udGVudCgpIHsKICAgICAgcmV0dXJuIHRoaXMucmVzdWx0X3BhZ2UgfHwgW107CiAgICB9LAoKICAgIGN1cnJlbnRRdWVzdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25zW3RoaXMuY3VycmVudFF1ZXN0aW9uSW5kZXhdOwogICAgfSwKCiAgICBpc0N1cnJlbnRRdWVzdGlvbkFuc3dlcmVkKCkgewogICAgICByZXR1cm4gdGhpcy5yZXN1bHRbdGhpcy5jdXJyZW50UXVlc3Rpb25JbmRleF0KICAgICAgICAmJiB0aGlzLnJlc3VsdFt0aGlzLmN1cnJlbnRRdWVzdGlvbkluZGV4XS5hbnN3ZXIKICAgICAgICAmJiBPYmplY3Qua2V5cyh0aGlzLnJlc3VsdFt0aGlzLmN1cnJlbnRRdWVzdGlvbkluZGV4XS5hbnN3ZXIpLmxlbmd0aCA+IDA7CiAgICB9LAoKICAgIGhhc011bHRpcGxlUXVlc3Rpb25zKCkgewogICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbnMubGVuZ3RoID4gMTsKICAgIH0sCiAgfSwKCiAgd2F0Y2g6IHsKICAgIHNlbGVjdGlvbl9pdGVtczogewogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXIoKSB7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gdGhpcy5jcmVhdGVSZXN1bHQoKSk7CiAgICAgIH0sCiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKICAgIHJlc29sdmVRdWVzdGlvbkNvbXBvbmVudE5hbWUocXVlc3Rpb24pIHsKICAgICAgcmV0dXJuIGBhcG8tc2VsZWN0aW9uLSR7cXVlc3Rpb24uYWNmX2ZjX2xheW91dC5yZXBsYWNlKC9fKy9nLCAnLScpfWA7CiAgICB9LAoKICAgIGNyZWF0ZVJlc3VsdCgpIHsKICAgICAgdGhpcy5yZXN1bHQgPSB0cmFuc2Zvcm0odGhpcy5xdWVzdGlvbnMsIChyZXN1bHQsIHF1ZXN0aW9uLCBpbmRleCkgPT4gewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnbgogICAgICAgIHJlc3VsdFtpbmRleF0gPSB7CiAgICAgICAgICBxdWVzdGlvbjogcXVlc3Rpb24ucXVlc3Rpb24sCiAgICAgICAgICBhbnN3ZXI6IHt9LAogICAgICAgIH07CiAgICAgIH0sIHt9KTsKICAgIH0sCgogICAgb25CYWNrKCkgewogICAgICBpZiAodGhpcy5jdXJyZW50UXVlc3Rpb25JbmRleCA+IDApIHsKICAgICAgICB0aGlzLmN1cnJlbnRRdWVzdGlvbkluZGV4IC09IDE7CiAgICAgIH0KICAgIH0sCgogICAgb25OZXh0KCkgewogICAgICBpZiAodGhpcy5uZXh0VGltZXIpIHsKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5uZXh0VGltZXIpOwogICAgICAgIHRoaXMubmV4dFRpbWVyID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLnJlc3VsdFt0aGlzLmN1cnJlbnRRdWVzdGlvbkluZGV4XS5hbnN3ZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFF1ZXN0aW9uSW5kZXggKz0gMTsKICAgIH0sCgogICAgb25BbnN3ZXJlZCgpIHsKICAgICAgdGhpcy5uZXh0VGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0aGlzLm9uTmV4dCgpOwogICAgICB9LCAzMDAwKTsKICAgIH0sCgogICAgb25SZXN0YXJ0KCkgewogICAgICB0aGlzLmNyZWF0ZVJlc3VsdCgpOwogICAgICB0aGlzLmN1cnJlbnRRdWVzdGlvbkluZGV4ID0gMDsKICAgIH0sCiAgfSwKfTsKCg=="},{"version":3,"sources":["Selection.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Selection.vue","sourceRoot":"src/components/content/selection","sourcesContent":["<template>\n  <div class=\"selection\">\n    <template v-if=\"currentQuestionIndex <= questions.length - 1\">\n      <transition\n        name=\"fade\"\n        mode=\"out-in\"\n      >\n        <component\n          :is=\"resolveQuestionComponentName(currentQuestion)\"\n          v-if=\"Object.keys(result).length > 0\"\n          :key=\"`question-${currentQuestionIndex}`\"\n          v-model=\"result[currentQuestionIndex]\"\n          :answer-a=\"currentQuestion.answer_a\"\n          :answer-b=\"currentQuestion.answer_b\"\n          class=\"container\"\n          :is-disabled=\"isCurrentQuestionAnswered\"\n          :question=\"currentQuestion.question\"\n          @answered=\"onAnswered\"\n        />\n      </transition>\n\n      <apo-selection-progress\n        v-if=\"hasMultipleQuestions\"\n        class=\"mt-10 desktop:mt-13\"\n        :current=\"currentQuestionIndex + 1\"\n        :is-current-question-answered=\"isCurrentQuestionAnswered\"\n        :total=\"questions.length\"\n        @back=\"onBack\"\n        @next=\"onNext\"\n      />\n    </template>\n    <apo-selection-result\n      v-else\n      :result=\"result\"\n      :content=\"resultPageContent\"\n      @restart=\"onRestart\"\n    />\n  </div>\n</template>\n\n<script>\n\nimport transform from 'lodash/transform';\nimport SelectionCopyQuestion from '@/components/content/selection/SelectionCopyQuestion.vue';\nimport SelectionImageQuestion from '@/components/content/selection/SelectionImageQuestion.vue';\nimport SelectionProgress from '@/components/content/selection/SelectionProgress.vue';\nimport SelectionResult from '@/components/content/selection/SelectionResult.vue';\n\nexport default {\n  components: {\n    'apo-selection-copy-question': SelectionCopyQuestion,\n    'apo-selection-image-question': SelectionImageQuestion,\n    'apo-selection-progress': SelectionProgress,\n    'apo-selection-result': SelectionResult,\n  },\n\n  props: {\n    selection_items: {\n      type: Array,\n      default: () => [],\n    },\n\n    result_page: {\n      type: [Array, Boolean],\n      default: () => [],\n    },\n  },\n\n  data() {\n    return {\n      currentQuestionIndex: 0,\n      result: {},\n    };\n  },\n\n  computed: {\n    questions() {\n      return this.selection_items;\n    },\n\n    resultPageContent() {\n      return this.result_page || [];\n    },\n\n    currentQuestion() {\n      return this.questions[this.currentQuestionIndex];\n    },\n\n    isCurrentQuestionAnswered() {\n      return this.result[this.currentQuestionIndex]\n        && this.result[this.currentQuestionIndex].answer\n        && Object.keys(this.result[this.currentQuestionIndex].answer).length > 0;\n    },\n\n    hasMultipleQuestions() {\n      return this.questions.length > 1;\n    },\n  },\n\n  watch: {\n    selection_items: {\n      immediate: true,\n      handler() {\n        this.$nextTick(() => this.createResult());\n      },\n    },\n  },\n\n  methods: {\n    resolveQuestionComponentName(question) {\n      return `apo-selection-${question.acf_fc_layout.replace(/_+/g, '-')}`;\n    },\n\n    createResult() {\n      this.result = transform(this.questions, (result, question, index) => {\n        // eslint-disable-next-line no-param-reassign\n        result[index] = {\n          question: question.question,\n          answer: {},\n        };\n      }, {});\n    },\n\n    onBack() {\n      if (this.currentQuestionIndex > 0) {\n        this.currentQuestionIndex -= 1;\n      }\n    },\n\n    onNext() {\n      if (this.nextTimer) {\n        clearTimeout(this.nextTimer);\n        this.nextTimer = null;\n      }\n\n      if (!this.result[this.currentQuestionIndex].answer) {\n        return;\n      }\n\n      this.currentQuestionIndex += 1;\n    },\n\n    onAnswered() {\n      this.nextTimer = setTimeout(() => {\n        this.onNext();\n      }, 3000);\n    },\n\n    onRestart() {\n      this.createResult();\n      this.currentQuestionIndex = 0;\n    },\n  },\n};\n\n</script>\n\n<style lang=\"scss\" scoped>\n\n.fade {\n  &-enter-active,\n  &-leave-active {\n    transition: opacity 0.3s ease;\n  }\n\n  &-enter,\n  &-leave-to {\n    opacity: 0;\n  }\n}\n\n</style>\n"]}]}