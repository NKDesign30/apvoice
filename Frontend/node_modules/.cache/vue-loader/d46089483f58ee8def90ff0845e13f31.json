{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/src/components/survey/Survey.vue?vue&type=script&lang=js&","dependencies":[{"path":"/app/src/components/survey/Survey.vue","mtime":1683275992563},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgZm9yRWFjaCBmcm9tICdsb2Rhc2gvZm9yRWFjaCc7CmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgU1VSVkVZU19TVE9SRV9SRVNVTFQgfSBmcm9tICdAL3N0b3JlL3R5cGVzL2FjdGlvbi10eXBlcyc7CmltcG9ydCBQcm9ncmVzcyBmcm9tICdAL2NvbXBvbmVudHMvdWkvUHJvZ3Jlc3MudnVlJzsKaW1wb3J0IFN1cnZleUFuc3dlck11bHRpTGluZVF1ZXN0aW9uIGZyb20gJ0AvY29tcG9uZW50cy9zdXJ2ZXkvU3VydmV5QW5zd2VyTXVsdGlMaW5lUXVlc3Rpb24udnVlJzsKaW1wb3J0IFN1cnZleUFuc3dlclNpbmdsZUxpbmVRdWVzdGlvbiBmcm9tICdAL2NvbXBvbmVudHMvc3VydmV5L1N1cnZleUFuc3dlclNpbmdsZUxpbmVRdWVzdGlvbi52dWUnOwppbXBvcnQgU3VydmV5UmF0aW5nUXVlc3Rpb24gZnJvbSAnQC9jb21wb25lbnRzL3N1cnZleS9TdXJ2ZXlSYXRpbmdRdWVzdGlvbi52dWUnOwppbXBvcnQgU3VydmV5UmF0aW5nSWNvbnNRdWVzdGlvbiBmcm9tICdAL2NvbXBvbmVudHMvc3VydmV5L1N1cnZleVJhdGluZ0ljb25zUXVlc3Rpb24udnVlJzsKaW1wb3J0IFN1cnZleVByb21vdGVyU2NvcmVRdWVzdGlvbiBmcm9tICdAL2NvbXBvbmVudHMvc3VydmV5L1N1cnZleVByb21vdGVyU2NvcmVRdWVzdGlvbi52dWUnOwppbXBvcnQgU3VydmV5Q2hvaWNlUXVlc3Rpb24gZnJvbSAnQC9jb21wb25lbnRzL3N1cnZleS9TdXJ2ZXlDaG9pY2VRdWVzdGlvbi52dWUnOwppbXBvcnQgU3VydmV5TWF0cml4UXVlc3Rpb24gZnJvbSAnQC9jb21wb25lbnRzL3N1cnZleS9TdXJ2ZXlNYXRyaXhRdWVzdGlvbi52dWUnOwppbXBvcnQgU3VydmV5RXhpdFBhZ2UgZnJvbSAnQC9jb21wb25lbnRzL3N1cnZleS9TdXJ2ZXlFeGl0UGFnZS52dWUnOwppbXBvcnQgU3VydmV5Q2hvaWNlTXVsdGlRdWVzdGlvbiBmcm9tICdAL2NvbXBvbmVudHMvc3VydmV5L1N1cnZleUNob2ljZU11bHRpUXVlc3Rpb24udnVlJzsKaW1wb3J0IFN1cnZleVRleHRQYXJhZ3JhcGhRdWVzdGlvbiBmcm9tICcuL1N1cnZleVRleHRQYXJhZ3JhcGhRdWVzdGlvbi52dWUnOwppbXBvcnQgU3VydmV5TWFwcGVyIGZyb20gJ0Avc2VydmljZXMvbWFwcGVyL1N1cnZleU1hcHBlcic7CmltcG9ydCBTdXJ2ZXlWYWxpZGF0aW9uIGZyb20gJ0Avc2VydmljZXMvc3VydmV5L1N1cnZleVZhbGlkYXRpb24nOwppbXBvcnQgU3VydmV5Q2hhcHRlclZhbGlkYXRpb24gZnJvbSAnQC9zZXJ2aWNlcy9zdXJ2ZXkvU3VydmV5Q2hhcHRlclZhbGlkYXRpb24nOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgICdhcG8tcHJvZ3Jlc3MnOiBQcm9ncmVzcywKICAgICdhcG8tc3VydmV5LWFuc3dlci1tdWx0aS1saW5lLXF1ZXN0aW9uJzogU3VydmV5QW5zd2VyTXVsdGlMaW5lUXVlc3Rpb24sCiAgICAnYXBvLXN1cnZleS1hbnN3ZXItc2luZ2xlLWxpbmUtcXVlc3Rpb24nOiBTdXJ2ZXlBbnN3ZXJTaW5nbGVMaW5lUXVlc3Rpb24sCiAgICAnYXBvLXN1cnZleS1jaG9pY2UtcXVlc3Rpb24nOiBTdXJ2ZXlDaG9pY2VRdWVzdGlvbiwKICAgICdhcG8tc3VydmV5LW1hdHJpeC1xdWVzdGlvbic6IFN1cnZleU1hdHJpeFF1ZXN0aW9uLAogICAgJ2Fwby1zdXJ2ZXktY2hvaWNlLW11bHRpLXF1ZXN0aW9uJzogU3VydmV5Q2hvaWNlTXVsdGlRdWVzdGlvbiwKICAgICdhcG8tc3VydmV5LXJhdGluZy1xdWVzdGlvbic6IFN1cnZleVJhdGluZ1F1ZXN0aW9uLAogICAgJ2Fwby1zdXJ2ZXktcmF0aW5nX2ljb25zLXF1ZXN0aW9uJzogU3VydmV5UmF0aW5nSWNvbnNRdWVzdGlvbiwKICAgICdhcG8tc3VydmV5LXByb21vdGVyX3Njb3JlLXF1ZXN0aW9uJzogU3VydmV5UHJvbW90ZXJTY29yZVF1ZXN0aW9uLAogICAgJ2Fwby1zdXJ2ZXktdGV4dC1wYXJhZ3JhcGgtcXVlc3Rpb24nOiBTdXJ2ZXlUZXh0UGFyYWdyYXBoUXVlc3Rpb24sCiAgICAnYXBvLXN1cnZleS1leGl0LXBhZ2UnOiBTdXJ2ZXlFeGl0UGFnZSwKICB9LAoKICBwcm9wczogewogICAgc3VydmV5OiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjaGFwdGVyOiAxLAogICAgICB2YWxpZGF0aW9uOiBuZXcgU3VydmV5VmFsaWRhdGlvbigpLAogICAgICBhbnN3ZXJlZFF1ZXN0aW9uczogW10sCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsndXNlcklkJywgJ3VzZXInXSksCgogICAgZHVyYXRpb24oKSB7CiAgICAgIGNvbnN0IHsgdHlwZSwgdGltZTogYW1vdW50IH0gPSB0aGlzLnN1cnZleS5kdXJhdGlvbjsKCiAgICAgIHJldHVybiB0aGlzLiR0YyhgZ2VuZXJhbC50aW1lLnNob3J0LiR7dHlwZX1gLCBhbW91bnQsIHsgYW1vdW50IH0pOwogICAgfSwKCiAgICBmdWxsRHVyYXRpb24oKSB7CiAgICAgIGNvbnN0IHsgdHlwZSwgdGltZTogYW1vdW50IH0gPSB0aGlzLnN1cnZleS5kdXJhdGlvbjsKCiAgICAgIHJldHVybiB0aGlzLiR0YyhgZ2VuZXJhbC50aW1lLmZ1bGwuJHt0eXBlfWAsIGFtb3VudCwgeyBhbW91bnQgfSk7CiAgICB9LAoKICAgIGN1cnJlbnRDaGFwdGVyKCkgewogICAgICByZXR1cm4gdGhpcy5zdXJ2ZXkuY2hhcHRlcnNbdGhpcy5jaGFwdGVyIC0gMV07CiAgICB9LAoKICAgIGlzRmlyc3RDaGFwdGVyKCkgewogICAgICByZXR1cm4gdGhpcy5jaGFwdGVyID09PSAxOwogICAgfSwKCiAgICBpc0xhc3RDaGFwdGVyKCkgewogICAgICByZXR1cm4gdGhpcy5jaGFwdGVyID09PSB0aGlzLnN1cnZleS5jaGFwdGVycy5sZW5ndGg7CiAgICB9LAoKICAgIGlzQ29tcGxldGUoKSB7CiAgICAgIHJldHVybiAodGhpcy51c2VyLnN1cnZleVJlc3VsdHNbdGhpcy5zdXJ2ZXkuaWRdICE9PSB1bmRlZmluZWQgJiYgdGhpcy51c2VyLnN1cnZleVJlc3VsdHNbdGhpcy5zdXJ2ZXkuaWRdLmlzX2NvbXBsZXRlKTsKICAgIH0sCgogICAgdG90YWxRdWVzdGlvbnMoKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDaGFwdGVyLnF1ZXN0aW9ucy5yZWR1Y2UoKGFjY3VtdWxhdG9yLCBxdWVzdGlvbikgPT4gewogICAgICAgIGlmIChxdWVzdGlvbi50eXBlID09PSAncmF0aW5nJykgewogICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yICsgcXVlc3Rpb24uaXRlbXMubGVuZ3RoOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYWNjdW11bGF0b3IgKyAxOwogICAgICB9LCAwKTsKICAgIH0sCiAgfSwKCiAgbWV0aG9kczogewogICAgLi4ubWFwQWN0aW9ucyhbU1VSVkVZU19TVE9SRV9SRVNVTFRdKSwKCiAgICBpbnRlcnBvbGF0ZSh0ZXh0KSB7CiAgICAgIGNvbnN0IHJlcGxhY2VtZW50cyA9IHsKICAgICAgICBzdXJ2ZXlfcG9pbnRzOiB0aGlzLnN1cnZleS5wb2ludHMsCiAgICAgIH07CgogICAgICBmb3JFYWNoKHJlcGxhY2VtZW50cywgKHZhbHVlLCBrZXkpID0+IHsKICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYHske2tleX19YCwgJ2cnKTsKCiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduCiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZShyZWdleCwgdmFsdWUpOwogICAgICB9KTsKCiAgICAgIHJldHVybiB0ZXh0OwogICAgfSwKCiAgICB2YWxpZGF0ZUN1cnJlbnRDaGFwdGVyKCkgewogICAgICB0aGlzLnZhbGlkYXRpb24ucmVzZXRDaGFwdGVyKHRoaXMuY2hhcHRlcik7CgogICAgICBjb25zdCBjaGFwdGVyVmFsaWRhdGlvbiA9IG5ldyBTdXJ2ZXlDaGFwdGVyVmFsaWRhdGlvbigpOwoKICAgICAgdGhpcy5jdXJyZW50Q2hhcHRlci5xdWVzdGlvbnMuZm9yRWFjaChxdWVzdGlvbiA9PiB7CiAgICAgICAgaWYgKHF1ZXN0aW9uLmlzT3B0aW9uYWwpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChxdWVzdGlvbi50eXBlID09PSAncXVlc3Rpb25fY2x1c3RlcicpIHsKICAgICAgICAgIHF1ZXN0aW9uLnF1ZXN0aW9ucy5mb3JFYWNoKGNsdXN0ZXJRdWVzdGlvbiA9PiB7CiAgICAgICAgICAgIGlmIChjbHVzdGVyUXVlc3Rpb24uaXNPcHRpb25hbCkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnZhbGlkYXRlUXVlc3Rpb24oY2x1c3RlclF1ZXN0aW9uLCBjaGFwdGVyVmFsaWRhdGlvbik7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgdGhpcy52YWxpZGF0ZVF1ZXN0aW9uKHF1ZXN0aW9uLCBjaGFwdGVyVmFsaWRhdGlvbik7CgogICAgICAgIGlmIChxdWVzdGlvbi5pc05lc3RlZCkgewogICAgICAgICAgcXVlc3Rpb24ubmVzdGVkUXVlc3Rpb24uZm9yRWFjaChuZXN0ZWRRdWVzdGlvbiA9PiB7CiAgICAgICAgICAgIGlmIChuZXN0ZWRRdWVzdGlvbi5pc09wdGlvbmFsIHx8ICF0aGlzLnNob3dOZXN0ZWRRdWVzdGlvbihuZXN0ZWRRdWVzdGlvbiwgcXVlc3Rpb24pKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLnZhbGlkYXRlUXVlc3Rpb24obmVzdGVkUXVlc3Rpb24sIGNoYXB0ZXJWYWxpZGF0aW9uKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICB0aGlzLnZhbGlkYXRpb24uc2V0Q2hhcHRlcih0aGlzLmNoYXB0ZXIsIGNoYXB0ZXJWYWxpZGF0aW9uKTsKICAgIH0sCgogICAgdmFsaWRhdGVRdWVzdGlvbihxdWVzdGlvbiwgY2hhcHRlclZhbGlkYXRpb24pIHsKICAgICAgbGV0IGlzVmFsaWQgPSB0cnVlOwoKICAgICAgc3dpdGNoIChxdWVzdGlvbi50eXBlKSB7CiAgICAgICAgY2FzZSAnY2hvaWNlLW11bHRpJzoKICAgICAgICAgIGlzVmFsaWQgPSBxdWVzdGlvbi52YWx1ZS5sZW5ndGggPiAwOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3JhdGluZyc6CiAgICAgICAgICBpc1ZhbGlkID0gcXVlc3Rpb24udmFsdWUubGVuZ3RoID09PSBxdWVzdGlvbi5pdGVtcy5sZW5ndGg7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnbWF0cml4JzoKICAgICAgICAgIGlzVmFsaWQgPSBPYmplY3Qua2V5cyhxdWVzdGlvbi52YWx1ZSkubGVuZ3RoID09PSBxdWVzdGlvbi5zZWN0aW9ucy5sZW5ndGg7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGlzVmFsaWQgPSBxdWVzdGlvbi52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHF1ZXN0aW9uLnZhbHVlICE9PSAnJzsKICAgICAgfQoKICAgICAgaWYgKCFpc1ZhbGlkKSB7CiAgICAgICAgY2hhcHRlclZhbGlkYXRpb24uYWRkKHF1ZXN0aW9uLmlkLCB0aGlzLiR0KCdzdXJ2ZXlzLm1lc3NhZ2VzLnF1ZXN0aW9uSXNSZXF1aXJlZCcpKTsKICAgICAgfQogICAgfSwKCiAgICBnZXRFcnJvcih7IGlkIH0pIHsKICAgICAgaWYgKCF0aGlzLnZhbGlkYXRpb24uaGFzQ2hhcHRlcih0aGlzLmNoYXB0ZXIpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIXRoaXMudmFsaWRhdGlvbi5nZXRDaGFwdGVyKHRoaXMuY2hhcHRlcikuaGFzKGlkKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZXJyb3InKVswXS5wYXJlbnRFbGVtZW50Lm9mZnNldFRvcCAtIDYwLCBiZWhhdmlvcjogJ3Ntb290aCcgfSk7CiAgICAgIH0sIDUwMCk7CiAgICAgIHJldHVybiB0aGlzLnZhbGlkYXRpb24uZ2V0Q2hhcHRlcih0aGlzLmNoYXB0ZXIpLmdldChpZCk7CiAgICB9LAoKICAgIHJlc2V0RXJyb3IoeyBpZCB9KSB7CiAgICAgIGlmICghdGhpcy52YWxpZGF0aW9uLmhhc0NoYXB0ZXIodGhpcy5jaGFwdGVyKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGlvbi5nZXRDaGFwdGVyKHRoaXMuY2hhcHRlcikucmVtb3ZlKGlkKTsKICAgIH0sCgogICAgZ2V0U3VydmV5Q29tcG9uZW50KHsgdHlwZSB9KSB7CiAgICAgIHJldHVybiBgYXBvLXN1cnZleS0ke3R5cGV9LXF1ZXN0aW9uYDsKICAgIH0sCgogICAgb25RdWVzdGlvbklucHV0KGV2ZW50LCBxdWVzdGlvbikgewogICAgICBpZiAocXVlc3Rpb24udHlwZSA9PT0gJ3JhdGluZycpIHsKICAgICAgICBpZiAocXVlc3Rpb24udmFsdWUuc29tZSh2YWx1ZSA9PiB2YWx1ZS5yYXRpbmdJZCA9PT0gZXZlbnQuaXRlbS5pZCkpIHsKICAgICAgICAgIGNvbnN0IGluZGV4ID0gcXVlc3Rpb24udmFsdWUuZmluZEluZGV4KHZhbHVlID0+IHZhbHVlLnJhdGluZ0lkID09PSBldmVudC5pdGVtLmlkKTsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnbgogICAgICAgICAgcXVlc3Rpb24udmFsdWVbaW5kZXhdLnZhbHVlID0gZXZlbnQudmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHF1ZXN0aW9uLnZhbHVlLnB1c2goeyByYXRpbmdJZDogZXZlbnQuaXRlbS5pZCwgdmFsdWU6IGV2ZW50LnZhbHVlIH0pOwogICAgICAgIH0KICAgICAgICB0aGlzLmFuc3dlcmVkUXVlc3Rpb25zLnB1c2goZXZlbnQuaXRlbS5pZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuYW5zd2VyZWRRdWVzdGlvbnMuaW5kZXhPZihxdWVzdGlvbi5pZCkgPT09IC0xKSB7CiAgICAgICAgICB0aGlzLmFuc3dlcmVkUXVlc3Rpb25zLnB1c2gocXVlc3Rpb24uaWQpOwogICAgICAgIH0gZWxzZSBpZiAoIWV2ZW50KSB7CiAgICAgICAgICB0aGlzLmFuc3dlcmVkUXVlc3Rpb25zID0gdGhpcy5hbnN3ZXJlZFF1ZXN0aW9ucy5maWx0ZXIoaWQgPT4gaWQgIT09IHF1ZXN0aW9uLmlkKTsKICAgICAgICB9CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduCiAgICAgICAgcXVlc3Rpb24udmFsdWUgPSBldmVudDsKICAgICAgfQogICAgICBpZiAodGhpcy52YWxpZGF0aW9uLmhhc0NoYXB0ZXIodGhpcy5jaGFwdGVyKSkgewogICAgICAgIHRoaXMudmFsaWRhdGVDdXJyZW50Q2hhcHRlcigpOwogICAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCk7CiAgICAgIH0KICAgIH0sCgogICAgc2hvd05lc3RlZFF1ZXN0aW9uKG5lc3RlZFF1ZXN0aW9uLCBxdWVzdGlvbikgewogICAgICByZXR1cm4gbmVzdGVkUXVlc3Rpb24ucGFyZW50VmFsdWUuc3BsaXQoJywnKS5maW5kKGUgPT4gZSA9PT0gcXVlc3Rpb24udmFsdWUgfHwgKHR5cGVvZiBxdWVzdGlvbi52YWx1ZSA9PT0gJ29iamVjdCcgJiYgcXVlc3Rpb24udmFsdWUuc29tZSh2YWwgPT4gdmFsLnZhbHVlID09PSBlIHx8IHZhbCA9PT0gZSkpKTsKICAgIH0sCgogICAgb25QcmV2aW91c0J1dHRvbkNsaWNrKCkgewogICAgICBpZiAoIXRoaXMuaXNGaXJzdENoYXB0ZXIpIHsKICAgICAgICB0aGlzLmNoYXB0ZXIgPSB0aGlzLmNoYXB0ZXIgLSAxOwogICAgICB9CiAgICB9LAoKICAgIG9uTmV4dEJ1dHRvbkNsaWNrKCkgewogICAgICB0aGlzLnZhbGlkYXRlQ3VycmVudENoYXB0ZXIoKTsKCiAgICAgIGlmICh0aGlzLnZhbGlkYXRpb24uaGFzQ2hhcHRlcih0aGlzLmNoYXB0ZXIpCiAgICAgICAgJiYgIXRoaXMudmFsaWRhdGlvbi5nZXRDaGFwdGVyKHRoaXMuY2hhcHRlcikuaXNWYWxpZCkgewogICAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNMYXN0Q2hhcHRlcikgewogICAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICAgIHVzZXJfaWQ6IFN0cmluZyh0aGlzLnVzZXJJZCksCiAgICAgICAgICBzdXJ2ZXlfaWQ6IFN0cmluZyh0aGlzLnN1cnZleS5pZCksCiAgICAgICAgfTsKCiAgICAgICAgdGhpc1tTVVJWRVlTX1NUT1JFX1JFU1VMVF0oU3VydmV5TWFwcGVyLmNyZWF0ZVN1cnZleVBheWxvYWQodGhpcy5zdXJ2ZXksIHBhcmFtcykpCiAgICAgICAgICAudGhlbihzdXJ2ZXkgPT4gewogICAgICAgICAgICB0aGlzLnVzZXIuc3VydmV5UmVzdWx0c1tzdXJ2ZXkuaWRdID0geyBpc19jb21wbGV0ZTogc3VydmV5LmlzX2NvbXBsZXRlLCByZXN1bHQ6IHN1cnZleS5yZXN1bHQgfTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Igc3RvcmluZyByZXN1bHQnLCBlcnJvcik7CiAgICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmNoYXB0ZXIgPSB0aGlzLmNoYXB0ZXIgKyAxOwogICAgfSwKICB9LAp9OwoK"},{"version":3,"sources":["Survey.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA","file":"Survey.vue","sourceRoot":"src/components/survey","sourcesContent":["<template>\n  <div class=\"pb-16 survey\">\n    <div class=\"px-6 py-6 bg-yellow-200 survey-header tablet:px-0\">\n      <div class=\"container flex flex-wrap items-center tablet:justify-start justify-center\">\n        <!-- eslint-disable max-len -->\n        <div class=\"flex items-center justify-center text-xl font-bold text-yellow-500\">\n          <apo-icon\n            src=\"time\"\n            class=\"w-12 h-12\"\n          />\n          <span\n            class=\"mt-1 -ml-6 whitespace-no-wrap\"\n            v-text=\"duration\"\n          />\n        </div>\n        <!-- eslint-enable max-len -->\n\n        <div class=\"tablet:ml-8 text-gray-900\">\n          <h4\n            class=\"font-bold\"\n            v-html=\"$options.filters.formatContent(survey.title)\"\n          />\n          <p :inner-html=\"interpolate(survey.description) | formatContent\" />\n        </div>\n      </div>\n    </div>\n\n    <apo-survey-exit-page\n      v-if=\"isComplete\"\n      :survey=\"survey\"\n    />\n    <div\n      v-else\n      class=\"survey-body\"\n    >\n      <div class=\"container mt-16 tablet:mt-24\">\n        <h3\n          class=\"text-5xl text-center text-gray-900 font-display\"\n          v-text=\"$t('general.expertPoints', [survey.points])\"\n        />\n        <span\n          class=\"block text-3xl text-center text-gray-900 font-display\"\n          v-text=\"fullDuration\"\n        />\n      </div>\n\n      <apo-progress\n        class=\"mt-8 px-4 tablet:px-0\"\n        :chapter=\"chapter\"\n        :total-chapters=\"survey.chapters.length\"\n        :total-questions=\"totalQuestions\"\n        :answered-questions=\"answeredQuestions.length\"\n        sticky\n        @update-chapter=\"chapter = $event\"\n      />\n\n      <div class=\"container mx-auto mt-20 overflow-hidden chapter\">\n        <div class=\"flex flex-wrap justify-center\">\n          <div\n            v-for=\"(question) in currentChapter.questions\"\n            :key=\"question.id\"\n            class=\"flex flex-wrap items-end justify-center w-full px-4 mb-16 tablet:px-8\"\n          >\n            <component\n              :is=\"getSurveyComponent(question)\"\n              v-if=\"question.type !== 'question_cluster'\"\n              class=\"mx-6 text-center my-12\"\n              v-bind=\"question\"\n              :value=\"question.value\"\n              @input=\"onQuestionInput($event, question)\"\n            />\n\n            <small\n              v-if=\"getError(question) !== false\"\n              class=\"error mt-1 text-xs font-bold text-red-500 pin-l w-full text-center\"\n              v-text=\"getError(question)\"\n            />\n\n            <div\n              v-if=\"question.type === 'question_cluster'\"\n              class=\"survey-cluster-question w-full my-12\"\n            >\n              <div class=\"text-center survey-cluster-question__headlines mb-6\">\n                <h4\n                  class=\"text-3xl text-gray-900\"\n                  v-text=\"question.question\"\n                />\n                <p\n                  v-if=\"question.subheadline\"\n                  class=\"mt-2 italic text-gray-700 text-lg\"\n                  v-html=\"$options.filters.formatContent(question.subheadline)\"\n                />\n              </div>\n              <div class=\"flex flex-wrap justify-center\">\n                <div\n                  v-for=\"(clusterQuestion) in question.questions\"\n                  :key=\"clusterQuestion.id\"\n                  class=\"flex flex-wrap items-end justify-center\"\n                  :class=\"clusterQuestion.type === 'choice' || clusterQuestion.type === 'choice-multi' ? 'w-full' : 'w-auto'\"\n                >\n                  <div class=\"mx-6 mb-6 tablet:mb-12 w-full\">\n                    <component\n                      :is=\"getSurveyComponent(clusterQuestion)\"\n                      class=\"text-center\"\n                      is-cluster=\"true\"\n                      v-bind=\"clusterQuestion\"\n                      :value=\"clusterQuestion.value\"\n                      @input=\"onQuestionInput($event, clusterQuestion)\"\n                    />\n\n                    <small\n                      v-if=\"getError(clusterQuestion) !== false\"\n                      class=\"error mt-4 text-xs font-bold text-red-500 pin-l block text-center\"\n                      v-text=\"getError(clusterQuestion)\"\n                    />\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div\n              v-if=\"question.isNested\"\n              class=\"w-full\"\n            >\n              <div\n                v-for=\"(nestedQuestion) in question.nestedQuestion\"\n                :key=\"nestedQuestion.id\"\n                class=\"flex flex-wrap items-end justify-center w-full \"\n              >\n                <div\n                  v-if=\"showNestedQuestion(nestedQuestion, question)\"\n                  class=\"w-full px-6 flex justify-center flex-wrap mt-16\"\n                >\n                  <component\n                    :is=\"getSurveyComponent(nestedQuestion)\"\n                    class=\"text-center my-12 w-full\"\n                    v-bind=\"nestedQuestion\"\n                    :value=\"nestedQuestion.value\"\n                    @input=\"onQuestionInput($event, nestedQuestion)\"\n                  />\n\n                  <small\n                    v-if=\"getError(nestedQuestion) !== false\"\n                    class=\"error mt-1 text-xs font-bold text-red-500 pin-l\"\n                    v-text=\"getError(nestedQuestion)\"\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex flex-wrap justify-center pb-4\">\n          <apo-button\n            v-if=\"!isFirstChapter\"\n            class=\"mr-6 text-gray-900 button button--naked shadow-hard\"\n            @click.native=\"onPreviousButtonClick\"\n            v-text=\"$t('general.back')\"\n          />\n\n          <apo-button\n            class=\"text-white button button--primary shadow-hard-dark\"\n            @click.native=\"onNextButtonClick\"\n            v-text=\"$t(`general.${isLastChapter ? 'submit' : 'continue'}`)\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport forEach from 'lodash/forEach';\nimport { mapGetters, mapActions } from 'vuex';\nimport { SURVEYS_STORE_RESULT } from '@/store/types/action-types';\nimport Progress from '@/components/ui/Progress.vue';\nimport SurveyAnswerMultiLineQuestion from '@/components/survey/SurveyAnswerMultiLineQuestion.vue';\nimport SurveyAnswerSingleLineQuestion from '@/components/survey/SurveyAnswerSingleLineQuestion.vue';\nimport SurveyRatingQuestion from '@/components/survey/SurveyRatingQuestion.vue';\nimport SurveyRatingIconsQuestion from '@/components/survey/SurveyRatingIconsQuestion.vue';\nimport SurveyPromoterScoreQuestion from '@/components/survey/SurveyPromoterScoreQuestion.vue';\nimport SurveyChoiceQuestion from '@/components/survey/SurveyChoiceQuestion.vue';\nimport SurveyMatrixQuestion from '@/components/survey/SurveyMatrixQuestion.vue';\nimport SurveyExitPage from '@/components/survey/SurveyExitPage.vue';\nimport SurveyChoiceMultiQuestion from '@/components/survey/SurveyChoiceMultiQuestion.vue';\nimport SurveyTextParagraphQuestion from './SurveyTextParagraphQuestion.vue';\nimport SurveyMapper from '@/services/mapper/SurveyMapper';\nimport SurveyValidation from '@/services/survey/SurveyValidation';\nimport SurveyChapterValidation from '@/services/survey/SurveyChapterValidation';\n\nexport default {\n  components: {\n    'apo-progress': Progress,\n    'apo-survey-answer-multi-line-question': SurveyAnswerMultiLineQuestion,\n    'apo-survey-answer-single-line-question': SurveyAnswerSingleLineQuestion,\n    'apo-survey-choice-question': SurveyChoiceQuestion,\n    'apo-survey-matrix-question': SurveyMatrixQuestion,\n    'apo-survey-choice-multi-question': SurveyChoiceMultiQuestion,\n    'apo-survey-rating-question': SurveyRatingQuestion,\n    'apo-survey-rating_icons-question': SurveyRatingIconsQuestion,\n    'apo-survey-promoter_score-question': SurveyPromoterScoreQuestion,\n    'apo-survey-text-paragraph-question': SurveyTextParagraphQuestion,\n    'apo-survey-exit-page': SurveyExitPage,\n  },\n\n  props: {\n    survey: {\n      type: Object,\n      required: true,\n    },\n  },\n\n  data() {\n    return {\n      chapter: 1,\n      validation: new SurveyValidation(),\n      answeredQuestions: [],\n    };\n  },\n\n  computed: {\n    ...mapGetters(['userId', 'user']),\n\n    duration() {\n      const { type, time: amount } = this.survey.duration;\n\n      return this.$tc(`general.time.short.${type}`, amount, { amount });\n    },\n\n    fullDuration() {\n      const { type, time: amount } = this.survey.duration;\n\n      return this.$tc(`general.time.full.${type}`, amount, { amount });\n    },\n\n    currentChapter() {\n      return this.survey.chapters[this.chapter - 1];\n    },\n\n    isFirstChapter() {\n      return this.chapter === 1;\n    },\n\n    isLastChapter() {\n      return this.chapter === this.survey.chapters.length;\n    },\n\n    isComplete() {\n      return (this.user.surveyResults[this.survey.id] !== undefined && this.user.surveyResults[this.survey.id].is_complete);\n    },\n\n    totalQuestions() {\n      return this.currentChapter.questions.reduce((accumulator, question) => {\n        if (question.type === 'rating') {\n          return accumulator + question.items.length;\n        }\n        return accumulator + 1;\n      }, 0);\n    },\n  },\n\n  methods: {\n    ...mapActions([SURVEYS_STORE_RESULT]),\n\n    interpolate(text) {\n      const replacements = {\n        survey_points: this.survey.points,\n      };\n\n      forEach(replacements, (value, key) => {\n        const regex = new RegExp(`{${key}}`, 'g');\n\n        // eslint-disable-next-line no-param-reassign\n        text = text.replace(regex, value);\n      });\n\n      return text;\n    },\n\n    validateCurrentChapter() {\n      this.validation.resetChapter(this.chapter);\n\n      const chapterValidation = new SurveyChapterValidation();\n\n      this.currentChapter.questions.forEach(question => {\n        if (question.isOptional) {\n          return;\n        }\n\n        if (question.type === 'question_cluster') {\n          question.questions.forEach(clusterQuestion => {\n            if (clusterQuestion.isOptional) {\n              return;\n            }\n            this.validateQuestion(clusterQuestion, chapterValidation);\n          });\n        } else this.validateQuestion(question, chapterValidation);\n\n        if (question.isNested) {\n          question.nestedQuestion.forEach(nestedQuestion => {\n            if (nestedQuestion.isOptional || !this.showNestedQuestion(nestedQuestion, question)) {\n              return;\n            }\n\n            this.validateQuestion(nestedQuestion, chapterValidation);\n          });\n        }\n      });\n\n      this.validation.setChapter(this.chapter, chapterValidation);\n    },\n\n    validateQuestion(question, chapterValidation) {\n      let isValid = true;\n\n      switch (question.type) {\n        case 'choice-multi':\n          isValid = question.value.length > 0;\n          break;\n\n        case 'rating':\n          isValid = question.value.length === question.items.length;\n          break;\n\n        case 'matrix':\n          isValid = Object.keys(question.value).length === question.sections.length;\n          break;\n\n        default:\n          isValid = question.value !== undefined && question.value !== '';\n      }\n\n      if (!isValid) {\n        chapterValidation.add(question.id, this.$t('surveys.messages.questionIsRequired'));\n      }\n    },\n\n    getError({ id }) {\n      if (!this.validation.hasChapter(this.chapter)) {\n        return false;\n      }\n\n      if (!this.validation.getChapter(this.chapter).has(id)) {\n        return false;\n      }\n\n      window.setTimeout(() => {\n        window.scrollTo({ top: document.getElementsByClassName('error')[0].parentElement.offsetTop - 60, behavior: 'smooth' });\n      }, 500);\n      return this.validation.getChapter(this.chapter).get(id);\n    },\n\n    resetError({ id }) {\n      if (!this.validation.hasChapter(this.chapter)) {\n        return false;\n      }\n\n      return this.validation.getChapter(this.chapter).remove(id);\n    },\n\n    getSurveyComponent({ type }) {\n      return `apo-survey-${type}-question`;\n    },\n\n    onQuestionInput(event, question) {\n      if (question.type === 'rating') {\n        if (question.value.some(value => value.ratingId === event.item.id)) {\n          const index = question.value.findIndex(value => value.ratingId === event.item.id);\n          // eslint-disable-next-line no-param-reassign\n          question.value[index].value = event.value;\n        } else {\n          question.value.push({ ratingId: event.item.id, value: event.value });\n        }\n        this.answeredQuestions.push(event.item.id);\n      } else {\n        if (this.answeredQuestions.indexOf(question.id) === -1) {\n          this.answeredQuestions.push(question.id);\n        } else if (!event) {\n          this.answeredQuestions = this.answeredQuestions.filter(id => id !== question.id);\n        }\n        // eslint-disable-next-line no-param-reassign\n        question.value = event;\n      }\n      if (this.validation.hasChapter(this.chapter)) {\n        this.validateCurrentChapter();\n        this.$forceUpdate();\n      }\n    },\n\n    showNestedQuestion(nestedQuestion, question) {\n      return nestedQuestion.parentValue.split(',').find(e => e === question.value || (typeof question.value === 'object' && question.value.some(val => val.value === e || val === e)));\n    },\n\n    onPreviousButtonClick() {\n      if (!this.isFirstChapter) {\n        this.chapter = this.chapter - 1;\n      }\n    },\n\n    onNextButtonClick() {\n      this.validateCurrentChapter();\n\n      if (this.validation.hasChapter(this.chapter)\n        && !this.validation.getChapter(this.chapter).isValid) {\n        this.$forceUpdate();\n\n        return;\n      }\n\n      if (this.isLastChapter) {\n        const params = {\n          user_id: String(this.userId),\n          survey_id: String(this.survey.id),\n        };\n\n        this[SURVEYS_STORE_RESULT](SurveyMapper.createSurveyPayload(this.survey, params))\n          .then(survey => {\n            this.user.surveyResults[survey.id] = { is_complete: survey.is_complete, result: survey.result };\n          })\n          .catch(error => {\n            console.log('error storing result', error);\n          });\n\n        return;\n      }\n\n      this.chapter = this.chapter + 1;\n    },\n  },\n};\n\n</script>\n\n<style lang=\"scss\" scoped>\n\n.survey__duration--position {\n  top: 23%;\n  left: 30%;\n}\n\n</style>\n"]}]}