{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/src/components/training/quiz/TrainingQuiz.vue?vue&type=script&lang=js&","dependencies":[{"path":"/app/src/components/training/quiz/TrainingQuiz.vue","mtime":1683275992567},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcE11dGF0aW9ucyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgewogIEFVVEhfVVBEQVRFX1VTRVIsCiAgVFJBSU5JTkdTX1VQREFURV9PTkVfVFJBSU5JTkdfU0VSSUVTLAp9IGZyb20gJ0Avc3RvcmUvdHlwZXMvbXV0YXRpb24tdHlwZXMnOwppbXBvcnQgeyBBVVRIX0ZFVENIX0NVUlJFTlRfVVNFUiwgQVVUSF9GRVRDSF9VU0VSX0xFVkVMX0RBVEEgfSBmcm9tICdAL3N0b3JlL3R5cGVzL2FjdGlvbi10eXBlcyc7CmltcG9ydCBUcmFpbmluZ1F1aXpJdGVtIGZyb20gJ0AvY29tcG9uZW50cy90cmFpbmluZy9xdWl6L1RyYWluaW5nUXVpekl0ZW0udnVlJzsKaW1wb3J0IFByb2dyZXNzIGZyb20gJ0AvY29tcG9uZW50cy91aS9Qcm9ncmVzcy52dWUnOwppbXBvcnQgVHJhaW5pbmdNYXBwZXIgZnJvbSAnQC9zZXJ2aWNlcy9tYXBwZXIvVHJhaW5pbmdNYXBwZXInOwppbXBvcnQgVHJhaW5pbmdTZXJ2aWNlIGZyb20gJ0Avc2VydmljZXMvYXBpL1RyYWluaW5nU2VydmljZSc7CmltcG9ydCBUcmFpbmluZ1Nlcmllc1NlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlcy9hcGkvVHJhaW5pbmdTZXJpZXNTZXJ2aWNlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBpbmplY3Q6IFsncGFnZUluZGljYXRvcnNTdGF0ZScsICd0cmFpbmluZ3NTdGF0ZSddLAoKICBjb21wb25lbnRzOiB7CiAgICAnYXBvLXRyYWluaW5nLXF1aXotaXRlbSc6IFRyYWluaW5nUXVpekl0ZW0sCiAgICAnYXBvLXByb2dyZXNzJzogUHJvZ3Jlc3MsCiAgfSwKICBwcm9wczogewogICAgdHJhaW5pbmdTZXJpZXNJZDogewogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgdmFsaWRhdG9yOiBwcm9wID0+IHR5cGVvZiBwcm9wID09PSAnbnVtYmVyJyB8fCBwcm9wID09PSBudWxsLAogICAgfSwKICAgIHRyYWluaW5nSWQ6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIHZhbGlkYXRvcjogcHJvcCA9PiB0eXBlb2YgcHJvcCA9PT0gJ251bWJlcicgfHwgcHJvcCA9PT0gbnVsbCwKICAgIH0sCiAgICBsZXNzb25faWQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCiAgICBoZWFkbGluZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgZGVmYXVsdDogJycsCiAgICB9LAogICAgc3ViaGVhZGxpbmU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6ICcnLAogICAgfSwKICAgIGNoYXB0ZXJzOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2hhcHRlcjogMSwKICAgICAgYW5zd2VyczogW10sCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoWyd1c2VySWQnLCAndXNlciddKSwKCiAgICBjdXJyZW50Q2hhcHRlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuY2hhcHRlcnNbdGhpcy5jaGFwdGVyIC0gMV07CiAgICB9LAoKICAgIGlzRmlyc3RDaGFwdGVyKCkgewogICAgICByZXR1cm4gdGhpcy5jaGFwdGVyID09PSAxOwogICAgfSwKCiAgICBpc0xhc3RDaGFwdGVyKCkgewogICAgICByZXR1cm4gdGhpcy5jaGFwdGVyID09PSB0aGlzLmNoYXB0ZXJzLmxlbmd0aDsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBNdXRhdGlvbnMoW0FVVEhfVVBEQVRFX1VTRVIsIFRSQUlOSU5HU19VUERBVEVfT05FX1RSQUlOSU5HX1NFUklFU10pLAoKICAgIHByb2Nlc3NBbnN3ZXIoYW5zd2VyKSB7CiAgICAgIGNvbnN0IGN1cnJlbnRBbnN3ZXIgPSB7CiAgICAgICAgLi4uYW5zd2VyLAogICAgICAgIGNoYXB0ZXI6IHsKICAgICAgICAgIGlkOiB0aGlzLmN1cnJlbnRDaGFwdGVyLmlkLAogICAgICAgICAgY2hhcHRlcjogdGhpcy5jaGFwdGVyLAogICAgICAgIH0sCiAgICAgIH07CiAgICAgIHRoaXMuYW5zd2Vycy5wdXNoKGN1cnJlbnRBbnN3ZXIpOwogICAgfSwKICAgIHVwZGF0ZUNoYXB0ZXIoKSB7CiAgICAgIGlmICh0aGlzLmlzTGFzdENoYXB0ZXIpIHsKICAgICAgICB0aGlzLmNoZWNrUmVxdWlyZW1lbnRzKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuY2hhcHRlciArPSAxOwogICAgfSwKICAgIGNoZWNrUmVxdWlyZW1lbnRzKCkgewogICAgICBpZiAodGhpcy5oYXNSZXF1aXJlZEVsZW1lbnRzRmlsbGVkKCkpIHsKICAgICAgICB0aGlzLnN0b3JlQW5zd2VycygpOwogICAgICB9CiAgICB9LAogICAgaGFzUmVxdWlyZWRFbGVtZW50c0ZpbGxlZCgpIHsKICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMudHJhaW5pbmdzU3RhdGUucmVxdWlyZWRFbGVtZW50cy5maW5kKAogICAgICAgIHN0YXRlID0+ICFzdGF0ZS5oYXNTdWJtaXR0ZWQsCiAgICAgICk7CiAgICAgIGlmIChlbGVtZW50KSB7CiAgICAgICAgdGhpcy5wYWdlSW5kaWNhdG9yc1N0YXRlLmFjdGl2ZVBhZ2VJbmRpY2F0b3IgPSBlbGVtZW50LnBhZ2VJbmRpY2F0b3JJZDsKICAgICAgICB0aGlzLnRyYWluaW5nc1N0YXRlLmN1cnJlbnRNaXNzaW5nRWxlbWVudCA9IGVsZW1lbnQucXVlc3Rpb25faWQ7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgIHN0b3JlQW5zd2VycygpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZQogICAgICBjb25zdCB7IGlkLCBsZXNzb25faWQgfSA9IHRoaXMuJHJvdXRlLnBhcmFtczsKICAgICAgY29uc3QgcGFyYW1zID0gewogICAgICAgIHVzZXJfaWQ6IHRoaXMudXNlcklkLAogICAgICAgIHRyYWluaW5nX2lkOiB0aGlzLnRyYWluaW5nSWQsCiAgICAgICAgbGVzc29uX2lkLAogICAgICAgIHRyYWluaW5nX3Nlcmllc19pZDogdGhpcy50cmFpbmluZ1Nlcmllc0lkLAogICAgICB9OwogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnd2FpdC9zdGFydCcsICdzdWJtaXRUcmFpbmluZ1F1aXonLCB7IHJvb3Q6IHRydWUgfSk7CiAgICAgIFRyYWluaW5nU2VydmljZS5zdG9yZUxlc3NvblJlc3VsdHMoCiAgICAgICAgVHJhaW5pbmdNYXBwZXIuY3JlYXRlUGF5bG9hZCh0aGlzLmFuc3dlcnMsIHBhcmFtcyksCiAgICAgICkKICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBjb25zdCBjb3BpZWRVc2VyID0gdGhpcy51c2VyOwogICAgICAgICAgY29uc3QgY29tcGxldGVkTGVzc29ucyA9IHt9OwogICAgICAgICAgcmVzcG9uc2UucmVzdWx0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgIGNvbXBsZXRlZExlc3NvbnNbaXRlbS5sZXNzb25faWRdID0gaXRlbS5sZXNzb25faWQ7CiAgICAgICAgICB9KTsKICAgICAgICAgIGNvcGllZFVzZXIudHJhaW5pbmdSZXN1bHRzW3Jlc3BvbnNlLnRyYWluaW5nX2lkXSA9IHsKICAgICAgICAgICAgaXNfY29tcGxldGU6IHJlc3BvbnNlLmlzX2NvbXBsZXRlLAogICAgICAgICAgICBjb21wbGV0ZWRfbGVzc29uczogY29tcGxldGVkTGVzc29ucywKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzW0FVVEhfVVBEQVRFX1VTRVJdKGNvcGllZFVzZXIpOwogICAgICAgICAgLy90aGlzW0FVVEhfRkVUQ0hfVVNFUl9MRVZFTF9EQVRBXSgpOyAvLyB1cGRhdGUgdXNlcidzIHBvaW50cyBlYXJuZWQgLSBBcG9Vc2VyTGV2ZWxzIHBsdWdpbgogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goQVVUSF9GRVRDSF9DVVJSRU5UX1VTRVIpOwoKICAgICAgICAgIFRyYWluaW5nU2VyaWVzU2VydmljZS5mZXRjaCh0aGlzLnRyYWluaW5nU2VyaWVzSWQpLnRoZW4oCiAgICAgICAgICAgIHRyYWluaW5nU2VyaWVzID0+IHsKICAgICAgICAgICAgICB0aGlzW1RSQUlOSU5HU19VUERBVEVfT05FX1RSQUlOSU5HX1NFUklFU10odHJhaW5pbmdTZXJpZXMpOwogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd3YWl0L2VuZCcsICdzdWJtaXRUcmFpbmluZ1F1aXonLCB7IHJvb3Q6IHRydWUgfSk7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goQVVUSF9GRVRDSF9VU0VSX0xFVkVMX0RBVEEsIHt9KQogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICd0cmFpbmluZy1zdWNjZXNzLXBhZ2UnLAogICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgIHNsdWc6IHRyYWluaW5nU2VyaWVzLnNsdWcsCiAgICAgICAgICAgICAgICAgIHNlcmllc19pZDogdGhpcy50cmFpbmluZ1Nlcmllc0lkLAogICAgICAgICAgICAgICAgICBpZCwKICAgICAgICAgICAgICAgICAgbGVzc29uX2lkLAogICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuJHJvdXRlLm5hbWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICApOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd3YWl0L2VuZCcsICdzdWJtaXRUcmFpbmluZ1F1aXonLCB7IHJvb3Q6IHRydWUgfSk7CiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Igc3RvcmluZyB0cmFpbmluZyBsZXNzb24gcmVzdWx0JywgZXJyb3IpOwogICAgICAgIH0pOwogICAgfSwKICB9LAogIGRlc3Ryb3llZCgpIHsKICAgIHRoaXMuYW5zd2VycyA9IFtdOwogICAgdGhpcy5jaGFwdGVyID0gMTsKICB9LAp9Owo="},{"version":3,"sources":["TrainingQuiz.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TrainingQuiz.vue","sourceRoot":"src/components/training/quiz","sourcesContent":["<template>\n  <div class=\"p-12 mt-24 training-quiz force-full-width background-class\">\n    <div\n      v-if=\"headline || subheadline\"\n      class=\"container text-gray-900 training-quiz__headlines mb-7\"\n    >\n      <h2\n        class=\"text-center\"\n        v-html=\"$options.filters.formatContent(headline)\"\n      />\n\n      <h3\n        v-if=\"subheadline\"\n        class=\"mt-6 text-center\"\n        v-html=\"$options.filters.formatContent(subheadline)\"\n      />\n    </div>\n    <div class=\"container training-quiz__body\">\n      <apo-training-quiz-item\n        :quiz=\"currentChapter\"\n        :is-last-chapter=\"isLastChapter\"\n        @submit-answer=\"processAnswer\"\n        @update-chapter=\"updateChapter\"\n      >\n        <apo-progress\n          class=\"mt-4\"\n          :chapter=\"chapter\"\n          :total-chapters=\"chapters.length\"\n          :interactive=\"false\"\n        />\n      </apo-training-quiz-item>\n      <apo-references\n        class=\"mt-8\"\n        :references=\"currentChapter.references\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapMutations } from 'vuex';\nimport {\n  AUTH_UPDATE_USER,\n  TRAININGS_UPDATE_ONE_TRAINING_SERIES,\n} from '@/store/types/mutation-types';\nimport { AUTH_FETCH_CURRENT_USER, AUTH_FETCH_USER_LEVEL_DATA } from '@/store/types/action-types';\nimport TrainingQuizItem from '@/components/training/quiz/TrainingQuizItem.vue';\nimport Progress from '@/components/ui/Progress.vue';\nimport TrainingMapper from '@/services/mapper/TrainingMapper';\nimport TrainingService from '@/services/api/TrainingService';\nimport TrainingSeriesService from '@/services/api/TrainingSeriesService';\n\nexport default {\n  inject: ['pageIndicatorsState', 'trainingsState'],\n\n  components: {\n    'apo-training-quiz-item': TrainingQuizItem,\n    'apo-progress': Progress,\n  },\n  props: {\n    trainingSeriesId: {\n      required: true,\n      validator: prop => typeof prop === 'number' || prop === null,\n    },\n    trainingId: {\n      required: true,\n      validator: prop => typeof prop === 'number' || prop === null,\n    },\n    lesson_id: {\n      type: String,\n      required: true,\n    },\n    headline: {\n      type: String,\n      required: false,\n      default: '',\n    },\n    subheadline: {\n      type: String,\n      required: false,\n      default: '',\n    },\n    chapters: {\n      type: Array,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      chapter: 1,\n      answers: [],\n    };\n  },\n  computed: {\n    ...mapGetters(['userId', 'user']),\n\n    currentChapter() {\n      return this.chapters[this.chapter - 1];\n    },\n\n    isFirstChapter() {\n      return this.chapter === 1;\n    },\n\n    isLastChapter() {\n      return this.chapter === this.chapters.length;\n    },\n  },\n  methods: {\n    ...mapMutations([AUTH_UPDATE_USER, TRAININGS_UPDATE_ONE_TRAINING_SERIES]),\n\n    processAnswer(answer) {\n      const currentAnswer = {\n        ...answer,\n        chapter: {\n          id: this.currentChapter.id,\n          chapter: this.chapter,\n        },\n      };\n      this.answers.push(currentAnswer);\n    },\n    updateChapter() {\n      if (this.isLastChapter) {\n        this.checkRequirements();\n        return;\n      }\n      this.chapter += 1;\n    },\n    checkRequirements() {\n      if (this.hasRequiredElementsFilled()) {\n        this.storeAnswers();\n      }\n    },\n    hasRequiredElementsFilled() {\n      const element = this.trainingsState.requiredElements.find(\n        state => !state.hasSubmitted,\n      );\n      if (element) {\n        this.pageIndicatorsState.activePageIndicator = element.pageIndicatorId;\n        this.trainingsState.currentMissingElement = element.question_id;\n        return false;\n      }\n      return true;\n    },\n    storeAnswers() {\n      // eslint-disable-next-line camelcase\n      const { id, lesson_id } = this.$route.params;\n      const params = {\n        user_id: this.userId,\n        training_id: this.trainingId,\n        lesson_id,\n        training_series_id: this.trainingSeriesId,\n      };\n      this.$store.dispatch('wait/start', 'submitTrainingQuiz', { root: true });\n      TrainingService.storeLessonResults(\n        TrainingMapper.createPayload(this.answers, params),\n      )\n        .then(response => {\n          const copiedUser = this.user;\n          const completedLessons = {};\n          response.result.forEach(item => {\n            completedLessons[item.lesson_id] = item.lesson_id;\n          });\n          copiedUser.trainingResults[response.training_id] = {\n            is_complete: response.is_complete,\n            completed_lessons: completedLessons,\n          };\n          this[AUTH_UPDATE_USER](copiedUser);\n          //this[AUTH_FETCH_USER_LEVEL_DATA](); // update user's points earned - ApoUserLevels plugin\n          this.$store.dispatch(AUTH_FETCH_CURRENT_USER);\n\n          TrainingSeriesService.fetch(this.trainingSeriesId).then(\n            trainingSeries => {\n              this[TRAININGS_UPDATE_ONE_TRAINING_SERIES](trainingSeries);\n              this.$store.dispatch('wait/end', 'submitTrainingQuiz', { root: true });\n              this.$store.dispatch(AUTH_FETCH_USER_LEVEL_DATA, {})\n              this.$router.push({\n                name: 'training-success-page',\n                params: {\n                  slug: trainingSeries.slug,\n                  series_id: this.trainingSeriesId,\n                  id,\n                  lesson_id,\n                  origin: this.$route.name\n                },\n              });\n            },\n          );\n        })\n        .catch(error => {\n          this.$store.dispatch('wait/end', 'submitTrainingQuiz', { root: true });\n          console.log('error storing training lesson result', error);\n        });\n    },\n  },\n  destroyed() {\n    this.answers = [];\n    this.chapter = 1;\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n  .force-full-width {\n    margin-left: calc(-50vw + 50%);\n    width: 100vw;\n  }\n\n  .theme-training {\n    .background-class {\n      @apply bg-training-50;\n    }\n  }\n  .theme-scientific {\n    .background-class {\n      @apply bg-scientific-50;\n    }\n  }\n</style>\n"]}]}