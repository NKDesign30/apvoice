{"remainingRequest":"/app/node_modules/babel-loader/lib/index.js!/app/node_modules/eslint-loader/index.js??ref--13-0!/app/src/mixins/page-permissions-check.js","dependencies":[{"path":"/app/src/mixins/page-permissions-check.js","mtime":1683275992573},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/app/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL2FwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUtY29yZWpzMy9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgUEFHRVNfVVBEQVRFX1BBR0VfUEVSTUlTU0lPTlMgfSBmcm9tICdAL3N0b3JlL3R5cGVzL211dGF0aW9uLXR5cGVzJzsKZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uICgpIHsKICByZXR1cm4gewogICAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBoYXNQYWdlUGVybWlzc2lvbnM6IGZhbHNlCiAgICAgIH07CiAgICB9LAogICAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoWyd1c2VyJywgJ3BhZ2VQZXJtaXNzaW9ucyddKSksCiAgICBtZXRob2RzOiB7CiAgICAgIGNoZWNrUGFnZVBlcm1pc3Npb25zOiBmdW5jdGlvbiBjaGVja1BhZ2VQZXJtaXNzaW9ucygpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICBpZiAodGhpcy4kcm91dGUubWV0YS5yZXF1aXJlUGFnZVBlcm1pc3NvbkNoZWNrIHx8IHRoaXMuJHJvdXRlLm1ldGEuaW5oZXJpdFBhZ2VQZXJtaXNzaW9uQ2hlY2tGcm9tKSB7CiAgICAgICAgICBpZiAodGhpcy5wYWdlUGVybWlzc2lvbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN1YnNjcmliZShmdW5jdGlvbiAobXV0YXRpb24pIHsKICAgICAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gUEFHRVNfVVBEQVRFX1BBR0VfUEVSTUlTU0lPTlMpIHsKICAgICAgICAgICAgICAgIF90aGlzLmFzc2lnblBhZ2VQZXJtaXNzaW9ucygpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmFzc2lnblBhZ2VQZXJtaXNzaW9ucygpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmhhc1BhZ2VQZXJtaXNzaW9ucyA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICBhc3NpZ25QYWdlUGVybWlzc2lvbnM6IGZ1bmN0aW9uIGFzc2lnblBhZ2VQZXJtaXNzaW9ucygpIHsKICAgICAgICB0aGlzLmhhc1BhZ2VQZXJtaXNzaW9ucyA9IHRoaXMudXNlci5yb2xlcy5pbmNsdWRlcygnYWRtaW5pc3RyYXRvcicpIHx8IHRoaXMudmFsaWRhdGVDdXJyZW50UGFnZVBlcm1pc3Npb25zKCk7CiAgICAgIH0sCiAgICAgIHZhbGlkYXRlQ3VycmVudFBhZ2VQZXJtaXNzaW9uczogZnVuY3Rpb24gdmFsaWRhdGVDdXJyZW50UGFnZVBlcm1pc3Npb25zKCkgewogICAgICAgIHZhciBjdXJyZW50UGFnZVBlcm1pc3Npb24gPSB0aGlzLmZpbmRDdXJyZW50UGFnZVBlcm1pc3Npb24oKTsKCiAgICAgICAgaWYgKGN1cnJlbnRQYWdlUGVybWlzc2lvbiAmJiBBcnJheS5pc0FycmF5KGN1cnJlbnRQYWdlUGVybWlzc2lvbi5wZXJtaXNzb25zKSkgewogICAgICAgICAgcmV0dXJuIHRoaXMudXNlci5yb2xlcy5zb21lKGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgICAgICAgIHJldHVybiBjdXJyZW50UGFnZVBlcm1pc3Npb24ucGVybWlzc29ucy5pbmRleE9mKHJvbGUpICE9PSAtMTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICFjdXJyZW50UGFnZVBlcm1pc3Npb24gfHwgY3VycmVudFBhZ2VQZXJtaXNzaW9uLnBlcm1pc3NvbnMgPT09ICdOT19SRVNUUklDVElPTicgfHwgY3VycmVudFBhZ2VQZXJtaXNzaW9uLnBlcm1pc3NvbnMgPT09IG51bGw7CiAgICAgIH0sCiAgICAgIGdldFRlbXBsYXRlU2x1Z0Zyb21Sb3V0ZTogZnVuY3Rpb24gZ2V0VGVtcGxhdGVTbHVnRnJvbVJvdXRlKCkgewogICAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5tZXRhLmluaGVyaXRQYWdlUGVybWlzc2lvbkNoZWNrRnJvbSA/IHRoaXMuJHJvdXRlLm1ldGEuaW5oZXJpdFBhZ2VQZXJtaXNzaW9uQ2hlY2tGcm9tIDogW3RoaXMuJHJvdXRlLm5hbWVdOwogICAgICB9LAogICAgICBmaW5kQ3VycmVudFBhZ2VQZXJtaXNzaW9uOiBmdW5jdGlvbiBmaW5kQ3VycmVudFBhZ2VQZXJtaXNzaW9uKCkgewogICAgICAgIHZhciB0ZW1wbGF0ZVNsdWdzID0gdGhpcy5nZXRUZW1wbGF0ZVNsdWdGcm9tUm91dGUoKTsKICAgICAgICByZXR1cm4gdGhpcy5wYWdlUGVybWlzc2lvbnMuZmluZChmdW5jdGlvbiAocGVybWlzc2lvbikgewogICAgICAgICAgcmV0dXJuIHRlbXBsYXRlU2x1Z3MuaW5jbHVkZXMocGVybWlzc2lvbi50ZW1wbGF0ZSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgICB0aGlzLmNoZWNrUGFnZVBlcm1pc3Npb25zKCk7CiAgICB9CiAgfTsKfSk7"},{"version":3,"sources":["/app/src/mixins/page-permissions-check.js"],"names":["mapGetters","PAGES_UPDATE_PAGE_PERMISSIONS","data","hasPagePermissions","computed","methods","checkPagePermissions","$route","meta","requirePagePermissonCheck","inheritPagePermissionCheckFrom","pagePermissions","length","$store","subscribe","mutation","type","assignPagePermissions","user","roles","includes","validateCurrentPagePermissions","currentPagePermission","findCurrentPagePermission","Array","isArray","permissons","some","role","indexOf","getTemplateSlugFromRoute","name","templateSlugs","find","permission","template","created"],"mappings":";;;;;;;;;;;;;;;AAAA,SAASA,UAAT,QAA2B,MAA3B;AACA,SAASC,6BAAT,QAA8C,8BAA9C;AAEA,gBAAe;AAAA,SAAO;AAEpBC,IAAAA,IAFoB,kBAEb;AACL,aAAO;AACLC,QAAAA,kBAAkB,EAAE;AADf,OAAP;AAGD,KANmB;AAQpBC,IAAAA,QAAQ,oBACHJ,UAAU,CAAC,CAAC,MAAD,EAAS,iBAAT,CAAD,CADP,CARY;AAYpBK,IAAAA,OAAO,EAAE;AACPC,MAAAA,oBADO,kCACgB;AAAA;;AACrB,YACE,KAAKC,MAAL,CAAYC,IAAZ,CAAiBC,yBAAjB,IACG,KAAKF,MAAL,CAAYC,IAAZ,CAAiBE,8BAFtB,EAGE;AACA,cAAI,KAAKC,eAAL,CAAqBC,MAArB,KAAgC,CAApC,EAAuC;AACrC,iBAAKC,MAAL,CAAYC,SAAZ,CAAsB,UAAAC,QAAQ,EAAI;AAChC,kBAAIA,QAAQ,CAACC,IAAT,KAAkBf,6BAAtB,EAAqD;AACnD,gBAAA,KAAI,CAACgB,qBAAL;AACD;AACF,aAJD;AAKD,WAND,MAMO;AACL,iBAAKA,qBAAL;AACD;AACF,SAbD,MAaO;AACL,eAAKd,kBAAL,GAA0B,IAA1B;AACD;AACF,OAlBM;AAoBPc,MAAAA,qBApBO,mCAoBiB;AACtB,aAAKd,kBAAL,GAA0B,KAAKe,IAAL,CAAUC,KAAV,CAAgBC,QAAhB,CAAyB,eAAzB,KAA6C,KAAKC,8BAAL,EAAvE;AACD,OAtBM;AAwBPA,MAAAA,8BAxBO,4CAwB0B;AAC/B,YAAMC,qBAAqB,GAAG,KAAKC,yBAAL,EAA9B;;AAEA,YAAID,qBAAqB,IAAIE,KAAK,CAACC,OAAN,CAAcH,qBAAqB,CAACI,UAApC,CAA7B,EAA8E;AAC5E,iBAAO,KAAKR,IAAL,CAAUC,KAAV,CAAgBQ,IAAhB,CAAqB,UAAAC,IAAI;AAAA,mBAAIN,qBAAqB,CAACI,UAAtB,CAAiCG,OAAjC,CAAyCD,IAAzC,MAAmD,CAAC,CAAxD;AAAA,WAAzB,CAAP;AACD;;AACD,eAAO,CAACN,qBAAD,IACJA,qBAAqB,CAACI,UAAtB,KAAqC,gBADjC,IAEJJ,qBAAqB,CAACI,UAAtB,KAAqC,IAFxC;AAGD,OAjCM;AAmCPI,MAAAA,wBAnCO,sCAmCoB;AACzB,eAAO,KAAKvB,MAAL,CAAYC,IAAZ,CAAiBE,8BAAjB,GACH,KAAKH,MAAL,CAAYC,IAAZ,CAAiBE,8BADd,GAC+C,CAAC,KAAKH,MAAL,CAAYwB,IAAb,CADtD;AAED,OAtCM;AAwCPR,MAAAA,yBAxCO,uCAwCqB;AAC1B,YAAMS,aAAa,GAAG,KAAKF,wBAAL,EAAtB;AAEA,eAAO,KAAKnB,eAAL,CACJsB,IADI,CACC,UAAAC,UAAU;AAAA,iBAAIF,aAAa,CAACZ,QAAd,CAAuBc,UAAU,CAACC,QAAlC,CAAJ;AAAA,SADX,CAAP;AAED;AA7CM,KAZW;AA6DpBC,IAAAA,OA7DoB,qBA6DV;AACR,WAAK9B,oBAAL;AACD;AA/DmB,GAAP;AAAA,CAAf","sourcesContent":["import { mapGetters } from 'vuex';\nimport { PAGES_UPDATE_PAGE_PERMISSIONS } from '@/store/types/mutation-types';\n\nexport default () => ({\n\n  data() {\n    return {\n      hasPagePermissions: false,\n    };\n  },\n\n  computed: {\n    ...mapGetters(['user', 'pagePermissions']),\n  },\n\n  methods: {\n    checkPagePermissions() {\n      if (\n        this.$route.meta.requirePagePermissonCheck\n        || this.$route.meta.inheritPagePermissionCheckFrom\n      ) {\n        if (this.pagePermissions.length === 0) {\n          this.$store.subscribe(mutation => {\n            if (mutation.type === PAGES_UPDATE_PAGE_PERMISSIONS) {\n              this.assignPagePermissions();\n            }\n          });\n        } else {\n          this.assignPagePermissions();\n        }\n      } else {\n        this.hasPagePermissions = true;\n      }\n    },\n\n    assignPagePermissions() {\n      this.hasPagePermissions = this.user.roles.includes('administrator') || this.validateCurrentPagePermissions();\n    },\n\n    validateCurrentPagePermissions() {\n      const currentPagePermission = this.findCurrentPagePermission();\n\n      if (currentPagePermission && Array.isArray(currentPagePermission.permissons)) {\n        return this.user.roles.some(role => currentPagePermission.permissons.indexOf(role) !== -1);\n      }\n      return !currentPagePermission\n      || currentPagePermission.permissons === 'NO_RESTRICTION'\n      || currentPagePermission.permissons === null;\n    },\n\n    getTemplateSlugFromRoute() {\n      return this.$route.meta.inheritPagePermissionCheckFrom\n        ? this.$route.meta.inheritPagePermissionCheckFrom : [this.$route.name];\n    },\n\n    findCurrentPagePermission() {\n      const templateSlugs = this.getTemplateSlugFromRoute();\n\n      return this.pagePermissions\n        .find(permission => templateSlugs.includes(permission.template));\n    },\n\n  },\n\n  created() {\n    this.checkPagePermissions();\n  },\n});\n"]}]}