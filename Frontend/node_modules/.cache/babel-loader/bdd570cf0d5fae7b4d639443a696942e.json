{"remainingRequest":"/app/node_modules/babel-loader/lib/index.js!/app/node_modules/eslint-loader/index.js??ref--13-0!/app/src/store/modules/vouchers.js","dependencies":[{"path":"/app/src/store/modules/vouchers.js","mtime":1689925550425},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/app/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIi9hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lLWNvcmVqczMvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwoKdmFyIF9tdXRhdGlvbnMsIF9hY3Rpb25zOwoKaW1wb3J0IFZvdWNoZXJTZXJ2aWNlIGZyb20gJ0Avc2VydmljZXMvYXBpL1ZvdWNoZXJTZXJ2aWNlJzsKaW1wb3J0IHsgVk9VQ0hFUlNfRkVUQ0hfQUxMLCBWT1VDSEVSU19FWENIQU5HRV9QT0lOVFMsIFZPVUNIRVJTX1JFREVFTV9WT1VDSEVSLCBBVVRIX0ZFVENIX0NVUlJFTlRfVVNFUiB9IGZyb20gJ0Avc3RvcmUvdHlwZXMvYWN0aW9uLXR5cGVzJzsKaW1wb3J0IHsgVk9VQ0hFUlNfVVBEQVRFX0FMTCwgVk9VQ0hFUlNfVVBEQVRFX05PVElGSUNBVElPTiwgVk9VQ0hFUlNfQ0xFQVJfTk9USUZJQ0FUSU9OIH0gZnJvbSAnQC9zdG9yZS90eXBlcy9tdXRhdGlvbi10eXBlcyc7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tY3ljbGUKCmltcG9ydCBpMThuIGZyb20gJ0AvaTE4bic7CmV4cG9ydCBkZWZhdWx0IHsKICBzdGF0ZTogewogICAgdm91Y2hlcnM6IFtdLAogICAgdm91Y2hlck5vdGlmaWNhdGlvbjogewogICAgICBzaG93OiBmYWxzZSwKICAgICAgbWVzc2FnZTogbnVsbAogICAgfQogIH0sCiAgbXV0YXRpb25zOiAoX211dGF0aW9ucyA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgVk9VQ0hFUlNfVVBEQVRFX0FMTCwgZnVuY3Rpb24gKHN0YXRlLCB1cGRhdGVkVm91Y2hlcnMpIHsKICAgIHN0YXRlLnZvdWNoZXJzID0gdXBkYXRlZFZvdWNoZXJzOwogIH0pLCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgVk9VQ0hFUlNfVVBEQVRFX05PVElGSUNBVElPTiwgZnVuY3Rpb24gKHN0YXRlLCB1cGRhdGVkTm90aWZpY2F0aW9uKSB7CiAgICBzdGF0ZS52b3VjaGVyTm90aWZpY2F0aW9uID0gdXBkYXRlZE5vdGlmaWNhdGlvbjsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9tdXRhdGlvbnMsIFZPVUNIRVJTX0NMRUFSX05PVElGSUNBVElPTiwgZnVuY3Rpb24gKHN0YXRlKSB7CiAgICBzdGF0ZS52b3VjaGVyTm90aWZpY2F0aW9uID0gewogICAgICBzaG93OiBmYWxzZSwKICAgICAgbWVzc2FnZTogbnVsbAogICAgfTsKICB9KSwgX211dGF0aW9ucyksCiAgYWN0aW9uczogKF9hY3Rpb25zID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfYWN0aW9ucywgVk9VQ0hFUlNfRkVUQ0hfQUxMLCBmdW5jdGlvbiAoX3JlZikgewogICAgdmFyIGRpc3BhdGNoID0gX3JlZi5kaXNwYXRjaCwKICAgICAgICBjb21taXQgPSBfcmVmLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYuc3RhdGU7CgogICAgaWYgKHN0YXRlLnZvdWNoZXJzLmxlbmd0aCA9PT0gMCkgewogICAgICBkaXNwYXRjaCgnd2FpdC9zdGFydCcsICd2b3VjaGVycycsIHsKICAgICAgICByb290OiB0cnVlCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIFZvdWNoZXJTZXJ2aWNlLmZldGNoQWxsKCkudGhlbihmdW5jdGlvbiAodm91Y2hlcnMpIHsKICAgICAgICBjb21taXQoVk9VQ0hFUlNfVVBEQVRFX0FMTCwgdm91Y2hlcnMpOwogICAgICAgIGRpc3BhdGNoKCd3YWl0L2VuZCcsICd2b3VjaGVycycsIHsKICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICB9KTsKICAgICAgICByZXNvbHZlKHZvdWNoZXJzKTsKICAgICAgfSkuY2F0Y2gocmVqZWN0KTsKICAgIH0pOwogIH0pLCBfZGVmaW5lUHJvcGVydHkoX2FjdGlvbnMsIFZPVUNIRVJTX0VYQ0hBTkdFX1BPSU5UUywgZnVuY3Rpb24gKF9yZWYyKSB7CiAgICB2YXIgZGlzcGF0Y2ggPSBfcmVmMi5kaXNwYXRjaCwKICAgICAgICBjb21taXQgPSBfcmVmMi5jb21taXQ7CiAgICBjb21taXQoVk9VQ0hFUlNfQ0xFQVJfTk9USUZJQ0FUSU9OKTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIFZvdWNoZXJTZXJ2aWNlLmV4Y2hhbmdlKCkudGhlbihmdW5jdGlvbiAodm91Y2hlcikgewogICAgICAgIGRpc3BhdGNoKFZPVUNIRVJTX0ZFVENIX0FMTCk7CiAgICAgICAgZGlzcGF0Y2goQVVUSF9GRVRDSF9DVVJSRU5UX1VTRVIpOwogICAgICAgIGNvbW1pdChWT1VDSEVSU19VUERBVEVfTk9USUZJQ0FUSU9OLCB7CiAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogaTE4bi50KCdwYWdlcy5yZWRlZW0ubm90aWZpY2F0aW9ucy5zdWNjZXNzJywgewogICAgICAgICAgICBwb2ludHM6IDUwLAogICAgICAgICAgICB2b3VjaGVyQ29kZTogdm91Y2hlci52b3VjaGVyX2NvZGUKICAgICAgICAgIH0pCiAgICAgICAgfSk7CiAgICAgICAgcmVzb2x2ZSh2b3VjaGVyKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29tbWl0KFZPVUNIRVJTX1VQREFURV9OT1RJRklDQVRJT04sIHsKICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5yZXNwb25zZS5kYXRhLmNvZGUgPT09ICdleGNlZWRlZF92b3VjaGVyX2NhcHBpbmcnID8gZXJyb3IucmVzcG9uc2UuZGF0YS5tZXNzYWdlIDogaTE4bi50KCJwYWdlcy5yZWRlZW0uZXJyb3IudGV4dCIpCiAgICAgICAgfSk7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9hY3Rpb25zLCBWT1VDSEVSU19SRURFRU1fVk9VQ0hFUiwgZnVuY3Rpb24gKF9yZWYzLCBfcmVmNCkgewogICAgdmFyIGRpc3BhdGNoID0gX3JlZjMuZGlzcGF0Y2gsCiAgICAgICAgY29tbWl0ID0gX3JlZjMuY29tbWl0OwogICAgdmFyIHZvdWNoZXJfY29kZSA9IF9yZWY0LnZvdWNoZXJfY29kZTsKICAgIGNvbW1pdChWT1VDSEVSU19DTEVBUl9OT1RJRklDQVRJT04pOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgVm91Y2hlclNlcnZpY2UucmVkZWVtKHZvdWNoZXJfY29kZSkudGhlbihmdW5jdGlvbiAodm91Y2hlcikgewogICAgICAgIGRpc3BhdGNoKFZPVUNIRVJTX0ZFVENIX0FMTCk7CiAgICAgICAgcmVzb2x2ZSh2b3VjaGVyKTsKICAgICAgfSkuY2F0Y2gocmVqZWN0KTsKICAgIH0pOwogIH0pLCBfYWN0aW9ucyksCiAgZ2V0dGVyczogewogICAgdm91Y2hlcnM6IGZ1bmN0aW9uIHZvdWNoZXJzKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS52b3VjaGVyczsKICAgIH0sCiAgICBhc3NpZ25lZFZvdWNoZXJzOiBmdW5jdGlvbiBhc3NpZ25lZFZvdWNoZXJzKHN0YXRlKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXEKICAgICAgcmV0dXJuIHN0YXRlLnZvdWNoZXJzLmZpbHRlcihmdW5jdGlvbiAodm91Y2hlcikgewogICAgICAgIHJldHVybiB2b3VjaGVyLnJlZGVlbWVkID09IDA7CiAgICAgIH0pOwogICAgfSwKICAgIHJlZGVlbWVkVm91Y2hlcnM6IGZ1bmN0aW9uIHJlZGVlbWVkVm91Y2hlcnMoc3RhdGUpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGVxZXFlcQogICAgICByZXR1cm4gc3RhdGUudm91Y2hlcnMuZmlsdGVyKGZ1bmN0aW9uICh2b3VjaGVyKSB7CiAgICAgICAgcmV0dXJuIHZvdWNoZXIucmVkZWVtZWQgPT0gMTsKICAgICAgfSk7CiAgICB9LAogICAgdm91Y2hlck5vdGlmaWNhdGlvbjogZnVuY3Rpb24gdm91Y2hlck5vdGlmaWNhdGlvbihzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUudm91Y2hlck5vdGlmaWNhdGlvbjsKICAgIH0KICB9Cn07"},{"version":3,"sources":["/app/src/store/modules/vouchers.js"],"names":["VoucherService","VOUCHERS_FETCH_ALL","VOUCHERS_EXCHANGE_POINTS","VOUCHERS_REDEEM_VOUCHER","AUTH_FETCH_CURRENT_USER","VOUCHERS_UPDATE_ALL","VOUCHERS_UPDATE_NOTIFICATION","VOUCHERS_CLEAR_NOTIFICATION","i18n","state","vouchers","voucherNotification","show","message","mutations","updatedVouchers","updatedNotification","actions","dispatch","commit","length","root","Promise","resolve","reject","fetchAll","then","catch","exchange","voucher","t","points","voucherCode","voucher_code","error","response","data","code","redeem","getters","assignedVouchers","filter","redeemed","redeemedVouchers"],"mappings":"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","sourcesContent":["import VoucherService from '@/services/api/VoucherService';\nimport {\n  VOUCHERS_FETCH_ALL,\n  VOUCHERS_EXCHANGE_POINTS,\n  VOUCHERS_REDEEM_VOUCHER,\n  AUTH_FETCH_CURRENT_USER,\n} from '@/store/types/action-types';\nimport {\n  VOUCHERS_UPDATE_ALL,\n  VOUCHERS_UPDATE_NOTIFICATION,\n  VOUCHERS_CLEAR_NOTIFICATION,\n} from '@/store/types/mutation-types';\n// eslint-disable-next-line import/no-cycle\nimport i18n from '@/i18n';\n\nexport default {\n  state: {\n    vouchers: [],\n    voucherNotification: {\n      show: false,\n      message: null,\n    },\n  },\n\n  mutations: {\n    [VOUCHERS_UPDATE_ALL](state, updatedVouchers) {\n      state.vouchers = updatedVouchers;\n    },\n    [VOUCHERS_UPDATE_NOTIFICATION](state, updatedNotification) {\n      state.voucherNotification = updatedNotification;\n    },\n    [VOUCHERS_CLEAR_NOTIFICATION](state) {\n      state.voucherNotification = {\n        show: false,\n        message: null,\n      };\n    },\n  },\n\n  actions: {\n    [VOUCHERS_FETCH_ALL]({ dispatch, commit, state }) {\n      if (state.vouchers.length === 0) {\n        dispatch('wait/start', 'vouchers', { root: true });\n      }\n\n      return new Promise((resolve, reject) => {\n        VoucherService.fetchAll()\n          .then(vouchers => {\n            commit(VOUCHERS_UPDATE_ALL, vouchers);\n            dispatch('wait/end', 'vouchers', { root: true });\n            resolve(vouchers);\n          }).catch(reject);\n      });\n    },\n\n    [VOUCHERS_EXCHANGE_POINTS]({ dispatch, commit }) {\n      commit(VOUCHERS_CLEAR_NOTIFICATION);\n      return new Promise((resolve, reject) => {\n        VoucherService.exchange()\n          .then(voucher => {\n            dispatch(VOUCHERS_FETCH_ALL);\n            dispatch(AUTH_FETCH_CURRENT_USER);\n            commit(VOUCHERS_UPDATE_NOTIFICATION, {\n              show: true,\n              message: i18n.t('pages.redeem.notifications.success', {\n                points: 50,\n                voucherCode: voucher.voucher_code,\n              }),\n            });\n            resolve(voucher);\n          }).catch(error => {\n            commit(VOUCHERS_UPDATE_NOTIFICATION, {\n              show: true,\n              message: (error.response.data.code === 'exceeded_voucher_capping' ? error.response.data.message : i18n.t(`pages.redeem.error.text`)),\n            });\n            reject(error);\n          });\n      });\n    },\n\n    // eslint-disable-next-line camelcase\n    [VOUCHERS_REDEEM_VOUCHER]({ dispatch, commit }, { voucher_code }) {\n      commit(VOUCHERS_CLEAR_NOTIFICATION);\n      return new Promise((resolve, reject) => {\n        VoucherService.redeem(voucher_code)\n          .then(voucher => {\n            dispatch(VOUCHERS_FETCH_ALL);\n            resolve(voucher);\n          }).catch(reject);\n      });\n    },\n  },\n\n  getters: {\n    vouchers(state) {\n      return state.vouchers;\n    },\n    assignedVouchers(state) {\n      // eslint-disable-next-line eqeqeq\n      return state.vouchers.filter(voucher => voucher.redeemed == 0);\n    },\n    redeemedVouchers(state) {\n      // eslint-disable-next-line eqeqeq\n      return state.vouchers.filter(voucher => voucher.redeemed == 1);\n    },\n    voucherNotification(state) {\n      return state.voucherNotification;\n    },\n  },\n};\n"]}]}