{"remainingRequest":"/app/node_modules/babel-loader/lib/index.js!/app/node_modules/eslint-loader/index.js??ref--13-0!/app/src/store/modules/auth.js","dependencies":[{"path":"/app/src/store/modules/auth.js","mtime":1686744074515},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/app/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS1jb3JlanMzL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKCnZhciBfbXV0YXRpb25zLCBfYWN0aW9uczsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi8KaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nOwppbXBvcnQgZ2V0IGZyb20gJ2xvZGFzaC9nZXQnOwppbXBvcnQgaXNFbXB0eSBmcm9tICdsb2Rhc2gvaXNFbXB0eSc7CmltcG9ydCB7IGlzSnd0VmFsaWQgfSBmcm9tICdAL3NlcnZpY2VzL3V0aWxzJzsKaW1wb3J0IHsgQVVUSF9GRVRDSF9DVVJSRU5UX1VTRVIsIEFVVEhfTE9HSU4sIEFVVEhfTE9HT1VULCBBVVRIX1JFRlJFU0gsIEFVVEhfTE9HT1VUX1dJVEhPVVRfUkVESVJFQ1QsIEFVVEhfRkVUQ0hfVVNFUl9MRVZFTF9EQVRBIH0gZnJvbSAiLi4vdHlwZXMvYWN0aW9uLXR5cGVzIjsKaW1wb3J0IHsgTE9DQUxfU1RPUkFHRV9UT0tFTl9LRVksIExPQ0FMX1NUT1JBR0VfVVNFUl9LRVkgfSBmcm9tICIuL2NvbnN0YW50cyI7CmltcG9ydCB7IEFVVEhfVVBEQVRFX1RPS0VOLCBBVVRIX1VQREFURV9VU0VSLCBBVVRIX1VQREFURV9TSE9XX1VQREFURV9QSEFSTUFDWV9NT0RBTCwgQVVUSF9VUERBVEVfVVNFUl9MRVZFTF9EQVRBIH0gZnJvbSAiLi4vdHlwZXMvbXV0YXRpb24tdHlwZXMiOwppbXBvcnQgVXNlclNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlcy9hcGkvVXNlclNlcnZpY2UnOwppbXBvcnQgQXV0aFNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlcy9hcGkvQXV0aFNlcnZpY2UnOwp2YXIgUkFXX0lOSVRJQUxfVE9LRU5fU1RBVEUgPSB7CiAgaGVhZGVyOiB7CiAgICBhbGc6ICcnLAogICAgdHlwOiAnJwogIH0sCiAgcGF5bG9hZDogewogICAgZGF0YTogewogICAgICB1c2VyOiB7CiAgICAgICAgaWQ6ICcnCiAgICAgIH0KICAgIH0sCiAgICBleHA6ICcnLAogICAgaWF0OiAnJywKICAgIGlzczogJycsCiAgICBuYmY6ICcnLAogICAgc2lnbmF0dXJlOiAnJwogIH0sCiAgcmF3OiAnJwp9Owp2YXIgUkFXX0lOSVRJQUxfVVNFUl9TVEFURSA9IHsKICBpZDogLTEsCiAgZW1haWw6ICcnLAogIG5hbWU6ICcnLAogIGZpcnN0TmFtZTogJycsCiAgbGFzdE5hbWU6ICcnLAogIHByb2ZpbGVQaWN0dXJlOiB7fSwKICBkZXNjcmlwdGlvbjogJycsCiAgbGluazogJycsCiAgc2x1ZzogJycsCiAgcm9sZXM6IFtdLAogIHVybDogJycsCiAgbG9naW5BY3Rpdml0eTogMCwKICBleHBlcnRQb2ludHM6IDAsCiAgbmV3c2xldHRlclN0YXRlOiB0cnVlLAogIHB1bjogJycsCiAgbGV2ZWxEYXRhOiB7CiAgICBsZXZlbDogMCwKICAgIGNvbXBsZXRlZF90cmFpbmluZ3M6IDAKICB9Cn07Cgp2YXIgSU5JVElBTF9UT0tFTl9TVEFURSA9IF9vYmplY3RTcHJlYWQoe30sIFJBV19JTklUSUFMX1RPS0VOX1NUQVRFKTsKCnZhciBJTklUSUFMX1VTRVJfU1RBVEUgPSBfb2JqZWN0U3ByZWFkKHt9LCBSQVdfSU5JVElBTF9VU0VSX1NUQVRFKTsKCnZhciBpc1VzZXJWYWxpZCA9IGZhbHNlOwp2YXIgaXNUb2tlblZhbGlkID0gZmFsc2U7CnZhciBzdG9yZWRVc2VyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oTE9DQUxfU1RPUkFHRV9VU0VSX0tFWSk7CnZhciBzdG9yZWRUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKExPQ0FMX1NUT1JBR0VfVE9LRU5fS0VZKTsgLy8gUmVzdG9yZSB1c2VyIHN0YXRlCgppZiAoc3RvcmVkVXNlciAhPT0gbnVsbCkgewogIHRyeSB7CiAgICB2YXIgcGFyc2VkVXNlciA9IEpTT04ucGFyc2Uoc3RvcmVkVXNlcik7CiAgICBJTklUSUFMX1VTRVJfU1RBVEUgPSBfb2JqZWN0U3ByZWFkKHt9LCBJTklUSUFMX1VTRVJfU1RBVEUsIHt9LCBwYXJzZWRVc2VyKTsKICAgIGlzVXNlclZhbGlkID0gdHJ1ZTsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmxvZygnTG9jYWwgdXNlciBkYXRhIGlzIGludmFsaWQuJyk7CiAgfQp9IC8vIFJlc3RvcmUgdG9rZW4gc3RhdGUKCgppZiAoc3RvcmVkVG9rZW4gIT09IG51bGwpIHsKICB2YXIgZGVjb2RlZFRva2VuID0gand0LmRlY29kZShzdG9yZWRUb2tlbiwgewogICAgY29tcGxldGU6IHRydWUKICB9KTsKCiAgaWYgKGRlY29kZWRUb2tlbiAhPT0gbnVsbCAmJiBpc0p3dFZhbGlkKGRlY29kZWRUb2tlbikpIHsKICAgIHZhciB0b2tlblVzZXJJZCA9IGdldChkZWNvZGVkVG9rZW4sICdwYXlsb2FkLmRhdGEudXNlci5pZCcsICcnKTsKICAgIHZhciB1c2VySWQgPSBJTklUSUFMX1VTRVJfU1RBVEUuaWQ7IC8vIFZlcmlmeSB0aGF0IHN0b3JlZCB0b2tlbiBtYXRjaGVzIHN0b3JlZCB1c2VyCgogICAgaWYgKHRva2VuVXNlcklkID49IDAgJiYgdXNlcklkID49IDAgJiYgdG9rZW5Vc2VySWQgPT09IHVzZXJJZCkgewogICAgICBJTklUSUFMX1RPS0VOX1NUQVRFID0gX29iamVjdFNwcmVhZCh7fSwgSU5JVElBTF9UT0tFTl9TVEFURSwge30sIGRlY29kZWRUb2tlbiwgewogICAgICAgIHJhdzogc3RvcmVkVG9rZW4KICAgICAgfSk7CiAgICAgIGlzVG9rZW5WYWxpZCA9IHRydWU7CiAgICB9CiAgfQp9CgppZiAoIWlzVXNlclZhbGlkKSB7CiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTE9DQUxfU1RPUkFHRV9VU0VSX0tFWSk7Cn0KCmlmICghaXNUb2tlblZhbGlkKSB7CiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTE9DQUxfU1RPUkFHRV9UT0tFTl9LRVkpOwp9CgpleHBvcnQgZGVmYXVsdCB7CiAgc3RhdGU6IHsKICAgIHRva2VuOiBfb2JqZWN0U3ByZWFkKHt9LCBJTklUSUFMX1RPS0VOX1NUQVRFKSwKICAgIHVzZXI6IF9vYmplY3RTcHJlYWQoe30sIElOSVRJQUxfVVNFUl9TVEFURSksCiAgICBzaG93VXBkYXRlUGhhcm1hY3lNb2RhbDogZmFsc2UKICB9LAogIG11dGF0aW9uczogKF9tdXRhdGlvbnMgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9tdXRhdGlvbnMsIEFVVEhfVVBEQVRFX1RPS0VOLCBmdW5jdGlvbiAoc3RhdGUsIHVwZGF0ZWRUb2tlbikgewogICAgc3RhdGUudG9rZW4gPSB1cGRhdGVkVG9rZW47CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMT0NBTF9TVE9SQUdFX1RPS0VOX0tFWSwgdXBkYXRlZFRva2VuLnJhdyk7CiAgICB3aW5kb3cuZXZlbnRCdXMuJGVtaXQoJ3JlY2l2ZWRBY2Nlc3NUb2tlbicpOwogIH0pLCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgQVVUSF9VUERBVEVfVVNFUiwgZnVuY3Rpb24gKHN0YXRlLCB1cGRhdGVkVXNlcikgewogICAgc3RhdGUudXNlciA9IHVwZGF0ZWRVc2VyOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxfU1RPUkFHRV9VU0VSX0tFWSwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFVzZXIpKTsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9tdXRhdGlvbnMsIEFVVEhfVVBEQVRFX1NIT1dfVVBEQVRFX1BIQVJNQUNZX01PREFMLCBmdW5jdGlvbiAoc3RhdGUsIHN0YXR1cykgewogICAgc3RhdGUuc2hvd1VwZGF0ZVBoYXJtYWN5TW9kYWwgPSBzdGF0dXM7CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfbXV0YXRpb25zLCBBVVRIX1VQREFURV9VU0VSX0xFVkVMX0RBVEEsIGZ1bmN0aW9uIChzdGF0ZSwgbGV2ZWxEYXRhKSB7CiAgICBzdGF0ZS51c2VyLmxldmVsRGF0YSA9IGxldmVsRGF0YTsKICB9KSwgX211dGF0aW9ucyksCiAgYWN0aW9uczogKF9hY3Rpb25zID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfYWN0aW9ucywgQVVUSF9MT0dJTiwgZnVuY3Rpb24gKF9yZWYsIF9yZWYyKSB7CiAgICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLAogICAgICAgIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgdmFyIHRva2VuID0gX3JlZjIudG9rZW4sCiAgICAgICAgdXNlciA9IF9yZWYyLnVzZXI7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgdmFyIGRlY29kZWRUb2tlbiA9IGp3dC5kZWNvZGUodG9rZW4sIHsKICAgICAgICBjb21wbGV0ZTogdHJ1ZQogICAgICB9KTsgLy8gSW52YWxpZCB0b2tlbgoKICAgICAgaWYgKGRlY29kZWRUb2tlbiA9PT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29tbWl0KEFVVEhfVVBEQVRFX1RPS0VOLCBfb2JqZWN0U3ByZWFkKHt9LCBkZWNvZGVkVG9rZW4sIHsKICAgICAgICByYXc6IHRva2VuCiAgICAgIH0pKTsKICAgICAgY29tbWl0KEFVVEhfVVBEQVRFX1VTRVIsIF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLnVzZXIsIHsKICAgICAgICBpZDogZ2V0KGRlY29kZWRUb2tlbiwgJ3BheWxvYWQuZGF0YS51c2VyLmlkJywgJycpCiAgICAgIH0sIHVzZXIpKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfYWN0aW9ucywgQVVUSF9MT0dPVVQsIGZ1bmN0aW9uIChfcmVmMykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMT0NBTF9TVE9SQUdFX1VTRVJfS0VZKTsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTE9DQUxfU1RPUkFHRV9UT0tFTl9LRVkpOwogICAgICBjb21taXQoQVVUSF9VUERBVEVfVE9LRU4sIFJBV19JTklUSUFMX1RPS0VOX1NUQVRFKTsKICAgICAgY29tbWl0KEFVVEhfVVBEQVRFX1VTRVIsIFJBV19JTklUSUFMX1VTRVJfU1RBVEUpOwogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvJzsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfYWN0aW9ucywgQVVUSF9MT0dPVVRfV0lUSE9VVF9SRURJUkVDVCwgZnVuY3Rpb24gKF9yZWY0KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKExPQ0FMX1NUT1JBR0VfVVNFUl9LRVkpOwogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMT0NBTF9TVE9SQUdFX1RPS0VOX0tFWSk7CiAgICAgIGNvbW1pdChBVVRIX1VQREFURV9UT0tFTiwgUkFXX0lOSVRJQUxfVE9LRU5fU1RBVEUpOwogICAgICBjb21taXQoQVVUSF9VUERBVEVfVVNFUiwgUkFXX0lOSVRJQUxfVVNFUl9TVEFURSk7CiAgICAgIHJlc29sdmUoKTsKICAgIH0pOwogIH0pLCBfZGVmaW5lUHJvcGVydHkoX2FjdGlvbnMsIEFVVEhfRkVUQ0hfQ1VSUkVOVF9VU0VSLCBmdW5jdGlvbiAoX3JlZjUpIHsKICAgIHZhciBzdGF0ZSA9IF9yZWY1LnN0YXRlLAogICAgICAgIGRpc3BhdGNoID0gX3JlZjUuZGlzcGF0Y2gsCiAgICAgICAgY29tbWl0ID0gX3JlZjUuY29tbWl0OwogICAgZGlzcGF0Y2goJ3dhaXQvc3RhcnQnLCAnYXV0aC51c2VyJywgewogICAgICByb290OiB0cnVlCiAgICB9KTsKICAgIFVzZXJTZXJ2aWNlLmZldGNoQ3VycmVudFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgIGNvbW1pdChBVVRIX1VQREFURV9VU0VSLCBfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZS51c2VyLCB7fSwgdXNlcikpOwogICAgICBjb21taXQoQVVUSF9VUERBVEVfU0hPV19VUERBVEVfUEhBUk1BQ1lfTU9EQUwsICF1c2VyLmhhc1VwZGF0ZWRQaGFybWFjeUFkZHJlc3MpOwogICAgICBkaXNwYXRjaCgnd2FpdC9lbmQnLCAnYXV0aC51c2VyJywgewogICAgICAgIHJvb3Q6IHRydWUKICAgICAgfSk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgY29uc29sZS5sb2coJ0Vycm9yIGZldGNoaW5nIGN1cnJlbnQgdXNlcicsIGVycm9yKTsKICAgIH0pOwogIH0pLCBfZGVmaW5lUHJvcGVydHkoX2FjdGlvbnMsIEFVVEhfUkVGUkVTSCwgZnVuY3Rpb24gKF9yZWY2KSB7CiAgICB2YXIgZGlzcGF0Y2ggPSBfcmVmNi5kaXNwYXRjaCwKICAgICAgICBjb21taXQgPSBfcmVmNi5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBBdXRoU2VydmljZS5yZWZyZXNoKCkudGhlbihmdW5jdGlvbiAoX3JlZjcpIHsKICAgICAgICB2YXIgdG9rZW4gPSBfcmVmNy50b2tlbjsKICAgICAgICB2YXIgZGVjb2RlZFRva2VuID0gand0LmRlY29kZSh0b2tlbiwgewogICAgICAgICAgY29tcGxldGU6IHRydWUKICAgICAgICB9KTsgLy8gSW52YWxpZCB0b2tlbgoKICAgICAgICBpZiAoZGVjb2RlZFRva2VuID09PSBudWxsKSB7CiAgICAgICAgICBkaXNwYXRjaChBVVRIX0xPR09VVCk7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9CgogICAgICAgIGNvbW1pdChBVVRIX1VQREFURV9UT0tFTiwgX29iamVjdFNwcmVhZCh7fSwgZGVjb2RlZFRva2VuLCB7CiAgICAgICAgICByYXc6IHRva2VuCiAgICAgICAgfSkpOwogICAgICAgIHJlc29sdmUodG9rZW4pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBkaXNwYXRjaChBVVRIX0xPR09VVCk7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9hY3Rpb25zLCBBVVRIX0ZFVENIX1VTRVJfTEVWRUxfREFUQSwgZnVuY3Rpb24gKF9yZWY4KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjguY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgVXNlclNlcnZpY2UuZmV0Y2hVc2VyTGV2ZWxUcmFpbmluZ3NQb2ludHMoKS50aGVuKGZ1bmN0aW9uIChsZXZlbERhdGEpIHsKICAgICAgICBjb21taXQoQVVUSF9VUERBVEVfVVNFUl9MRVZFTF9EQVRBLCBsZXZlbERhdGEpOwogICAgICAgIHJlc29sdmUobGV2ZWxEYXRhKTsKICAgICAgfSkuY2F0Y2gocmVqZWN0KTsKICAgIH0pOwogIH0pLCBfYWN0aW9ucyksCiAgZ2V0dGVyczogewogICAgaXNBdXRoZW50aWNhdGVkOiBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoc3RhdGUpIHsKICAgICAgaWYgKHN0YXRlLnVzZXIuaWQgPT09ICcnKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIXN0YXRlLnRva2VuLnBheWxvYWQuZXhwIHx8ICFzdGF0ZS50b2tlbi5wYXlsb2FkLm5iZikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGlzSnd0VmFsaWQoc3RhdGUudG9rZW4pOwogICAgfSwKICAgIHVzZXI6IGZ1bmN0aW9uIHVzZXIoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnVzZXI7CiAgICB9LAogICAgdXNlcklkOiBmdW5jdGlvbiB1c2VySWQoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnVzZXIuaWQ7CiAgICB9LAogICAgZnVsbE5hbWU6IGZ1bmN0aW9uIGZ1bGxOYW1lKHN0YXRlKSB7CiAgICAgIGlmICghc3RhdGUudXNlci5maXJzdE5hbWUgJiYgIXN0YXRlLnVzZXIubGFzdE5hbWUpIHsKICAgICAgICByZXR1cm4gc3RhdGUudXNlci5uYW1lOwogICAgICB9CgogICAgICByZXR1cm4gIiIuY29uY2F0KHN0YXRlLnVzZXIuZmlyc3ROYW1lLCAiICIpLmNvbmNhdChzdGF0ZS51c2VyLmxhc3ROYW1lKTsKICAgIH0sCiAgICBleHBlcnRQb2ludHM6IGZ1bmN0aW9uIGV4cGVydFBvaW50cyhzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUudXNlci5leHBlcnRQb2ludHM7CiAgICB9LAogICAgbGV2ZWxEYXRhOiBmdW5jdGlvbiBsZXZlbERhdGEoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnVzZXIubGV2ZWxEYXRhOwogICAgfSwKICAgIHByb2ZpbGVQaWN0dXJlOiBmdW5jdGlvbiBwcm9maWxlUGljdHVyZShzdGF0ZSkgewogICAgICBpZiAoIWlzRW1wdHkoc3RhdGUudXNlci5wcm9maWxlUGljdHVyZSkpIHsKICAgICAgICByZXR1cm4gc3RhdGUudXNlci5wcm9maWxlUGljdHVyZVsyNTBdIHx8IHN0YXRlLnVzZXIucHJvZmlsZVBpY3R1cmUuZnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuICcvYXNzZXRzL2ltZy91c2VyL25vLXByb2ZpbGUtcGljdHVyZS5wbmcnOwogICAgfSwKICAgIGxvZ2luQWN0aXZpdHk6IGZ1bmN0aW9uIGxvZ2luQWN0aXZpdHkoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnVzZXIubG9naW5BY3Rpdml0eTsKICAgIH0sCiAgICBjYW5SZWRlZW06IGZ1bmN0aW9uIGNhblJlZGVlbShzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUudXNlci5leHBlcnRQb2ludHMgPj0gNTA7CiAgICB9LAogICAgc2hvd1VwZGF0ZVBoYXJtYWN5TW9kYWw6IGZ1bmN0aW9uIHNob3dVcGRhdGVQaGFybWFjeU1vZGFsKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS5zaG93VXBkYXRlUGhhcm1hY3lNb2RhbDsKICAgIH0KICB9Cn07"},{"version":3,"sources":["/app/src/store/modules/auth.js"],"names":["jwt","get","isEmpty","isJwtValid","AUTH_FETCH_CURRENT_USER","AUTH_LOGIN","AUTH_LOGOUT","AUTH_REFRESH","AUTH_LOGOUT_WITHOUT_REDIRECT","AUTH_FETCH_USER_LEVEL_DATA","LOCAL_STORAGE_TOKEN_KEY","LOCAL_STORAGE_USER_KEY","AUTH_UPDATE_TOKEN","AUTH_UPDATE_USER","AUTH_UPDATE_SHOW_UPDATE_PHARMACY_MODAL","AUTH_UPDATE_USER_LEVEL_DATA","UserService","AuthService","RAW_INITIAL_TOKEN_STATE","header","alg","typ","payload","data","user","id","exp","iat","iss","nbf","signature","raw","RAW_INITIAL_USER_STATE","email","name","firstName","lastName","profilePicture","description","link","slug","roles","url","loginActivity","expertPoints","newsletterState","pun","levelData","level","completed_trainings","INITIAL_TOKEN_STATE","INITIAL_USER_STATE","isUserValid","isTokenValid","storedUser","localStorage","getItem","storedToken","parsedUser","JSON","parse","e","console","log","decodedToken","decode","complete","tokenUserId","userId","removeItem","state","token","showUpdatePharmacyModal","mutations","updatedToken","setItem","window","eventBus","$emit","updatedUser","stringify","status","actions","commit","Promise","resolve","location","href","dispatch","root","fetchCurrentUser","then","hasUpdatedPharmacyAddress","catch","error","reject","refresh","fetchUserLevelTrainingsPoints","getters","isAuthenticated","fullName","full","canRedeem"],"mappings":"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","sourcesContent":["/* eslint-disable no-param-reassign */\n\nimport jwt from 'jsonwebtoken';\nimport get from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\nimport { isJwtValid } from '@/services/utils';\nimport {\n  AUTH_FETCH_CURRENT_USER,\n  AUTH_LOGIN,\n  AUTH_LOGOUT,\n  AUTH_REFRESH,\n  AUTH_LOGOUT_WITHOUT_REDIRECT,\n  AUTH_FETCH_USER_LEVEL_DATA,\n} from '../types/action-types';\nimport { LOCAL_STORAGE_TOKEN_KEY, LOCAL_STORAGE_USER_KEY } from './constants';\nimport {\n  AUTH_UPDATE_TOKEN,\n  AUTH_UPDATE_USER,\n  AUTH_UPDATE_SHOW_UPDATE_PHARMACY_MODAL,\n  AUTH_UPDATE_USER_LEVEL_DATA,\n} from '../types/mutation-types';\nimport UserService from '@/services/api/UserService';\nimport AuthService from '@/services/api/AuthService';\n\nconst RAW_INITIAL_TOKEN_STATE = {\n  header: {\n    alg: '',\n    typ: '',\n  },\n  payload: {\n    data: {\n      user: {\n        id: '',\n      },\n    },\n    exp: '',\n    iat: '',\n    iss: '',\n    nbf: '',\n    signature: '',\n  },\n  raw: '',\n};\n\nconst RAW_INITIAL_USER_STATE = {\n  id: -1,\n  email: '',\n  name: '',\n  firstName: '',\n  lastName: '',\n  profilePicture: {},\n  description: '',\n  link: '',\n  slug: '',\n  roles: [],\n  url: '',\n  loginActivity: 0,\n  expertPoints: 0,\n  newsletterState: true,\n  pun: '',\n  levelData: {\n    level: 0,\n    completed_trainings: 0,\n  },\n};\n\nlet INITIAL_TOKEN_STATE = { ...RAW_INITIAL_TOKEN_STATE };\nlet INITIAL_USER_STATE = { ...RAW_INITIAL_USER_STATE };\n\nlet isUserValid = false;\nlet isTokenValid = false;\nconst storedUser = localStorage.getItem(LOCAL_STORAGE_USER_KEY);\nconst storedToken = localStorage.getItem(LOCAL_STORAGE_TOKEN_KEY);\n\n// Restore user state\nif (storedUser !== null) {\n  try {\n    const parsedUser = JSON.parse(storedUser);\n\n    INITIAL_USER_STATE = {\n      ...INITIAL_USER_STATE,\n      ...parsedUser,\n    };\n\n    isUserValid = true;\n  } catch (e) {\n    console.log('Local user data is invalid.');\n  }\n}\n\n// Restore token state\nif (storedToken !== null) {\n  const decodedToken = jwt.decode(storedToken, { complete: true });\n\n  if (decodedToken !== null && isJwtValid(decodedToken)) {\n    const tokenUserId = get(decodedToken, 'payload.data.user.id', '');\n    const userId = INITIAL_USER_STATE.id;\n\n    // Verify that stored token matches stored user\n    if (tokenUserId >= 0 && userId >= 0 && tokenUserId === userId) {\n      INITIAL_TOKEN_STATE = {\n        ...INITIAL_TOKEN_STATE,\n        ...decodedToken,\n        raw: storedToken,\n      };\n\n      isTokenValid = true;\n    }\n  }\n}\n\nif (!isUserValid) {\n  localStorage.removeItem(LOCAL_STORAGE_USER_KEY);\n}\n\nif (!isTokenValid) {\n  localStorage.removeItem(LOCAL_STORAGE_TOKEN_KEY);\n}\n\nexport default {\n  state: {\n    token: {\n      ...INITIAL_TOKEN_STATE,\n    },\n    user: {\n      ...INITIAL_USER_STATE,\n    },\n    showUpdatePharmacyModal: false,\n  },\n\n  mutations: {\n    [AUTH_UPDATE_TOKEN](state, updatedToken) {\n      state.token = updatedToken;\n\n      localStorage.setItem(LOCAL_STORAGE_TOKEN_KEY, updatedToken.raw);\n      window.eventBus.$emit('recivedAccessToken');\n    },\n\n    [AUTH_UPDATE_USER](state, updatedUser) {\n      state.user = updatedUser;\n\n      localStorage.setItem(LOCAL_STORAGE_USER_KEY, JSON.stringify(updatedUser));\n    },\n\n    [AUTH_UPDATE_SHOW_UPDATE_PHARMACY_MODAL](state, status) {\n      state.showUpdatePharmacyModal = status;\n    },\n\n    [AUTH_UPDATE_USER_LEVEL_DATA](state, levelData) {\n      state.user.levelData = levelData;\n    },\n  },\n\n  actions: {\n    [AUTH_LOGIN]({ state, commit }, { token, user }) {\n      return new Promise(resolve => {\n        const decodedToken = jwt.decode(token, { complete: true });\n\n        // Invalid token\n        if (decodedToken === null) {\n          return;\n        }\n\n        commit(AUTH_UPDATE_TOKEN, {\n          ...decodedToken,\n          raw: token,\n        });\n\n        commit(AUTH_UPDATE_USER, {\n          ...state.user,\n          id: get(decodedToken, 'payload.data.user.id', ''),\n          ...user,\n        });\n\n        resolve();\n      });\n    },\n\n    [AUTH_LOGOUT]({ commit }) {\n      return new Promise(resolve => {\n        localStorage.removeItem(LOCAL_STORAGE_USER_KEY);\n        localStorage.removeItem(LOCAL_STORAGE_TOKEN_KEY);\n\n        commit(AUTH_UPDATE_TOKEN, RAW_INITIAL_TOKEN_STATE);\n        commit(AUTH_UPDATE_USER, RAW_INITIAL_USER_STATE);\n        window.location.href = '/';\n        resolve();\n      });\n    },\n\n    [AUTH_LOGOUT_WITHOUT_REDIRECT]({ commit }) {\n      return new Promise(resolve => {\n        localStorage.removeItem(LOCAL_STORAGE_USER_KEY);\n        localStorage.removeItem(LOCAL_STORAGE_TOKEN_KEY);\n\n        commit(AUTH_UPDATE_TOKEN, RAW_INITIAL_TOKEN_STATE);\n        commit(AUTH_UPDATE_USER, RAW_INITIAL_USER_STATE);\n        resolve();\n      });\n    },\n\n    [AUTH_FETCH_CURRENT_USER]({ state, dispatch, commit }) {\n      dispatch('wait/start', 'auth.user', { root: true });\n\n      UserService.fetchCurrentUser()\n        .then(user => {\n          commit(AUTH_UPDATE_USER, {\n            ...state.user,\n            ...user,\n          });\n\n          commit(AUTH_UPDATE_SHOW_UPDATE_PHARMACY_MODAL, !user.hasUpdatedPharmacyAddress);\n\n          dispatch('wait/end', 'auth.user', { root: true });\n        })\n        .catch(error => {\n          console.log('Error fetching current user', error);\n        });\n    },\n\n    [AUTH_REFRESH]({ dispatch, commit }) {\n      return new Promise((resolve, reject) => {\n        AuthService.refresh()\n          .then(({ token }) => {\n            const decodedToken = jwt.decode(token, { complete: true });\n\n            // Invalid token\n            if (decodedToken === null) {\n              dispatch(AUTH_LOGOUT);\n              reject();\n            }\n\n            commit(AUTH_UPDATE_TOKEN, {\n              ...decodedToken,\n              raw: token,\n            });\n\n            resolve(token);\n          })\n          .catch(error => {\n            dispatch(AUTH_LOGOUT);\n            reject(error);\n          });\n      });\n    },\n\n    [AUTH_FETCH_USER_LEVEL_DATA]({ commit }) {\n      return new Promise((resolve, reject) => {\n        UserService.fetchUserLevelTrainingsPoints()\n          .then(levelData => {\n            commit(AUTH_UPDATE_USER_LEVEL_DATA, levelData);\n            resolve(levelData);\n          })\n          .catch(reject);\n      });\n    },\n  },\n\n  getters: {\n    isAuthenticated(state) {\n      if (state.user.id === '') {\n        return false;\n      }\n\n      if (!state.token.payload.exp || !state.token.payload.nbf) {\n        return false;\n      }\n\n      return isJwtValid(state.token);\n    },\n\n    user(state) {\n      return state.user;\n    },\n\n    userId(state) {\n      return state.user.id;\n    },\n\n    fullName(state) {\n      if (!state.user.firstName && !state.user.lastName) {\n        return state.user.name;\n      }\n      return `${state.user.firstName} ${state.user.lastName}`;\n    },\n\n    expertPoints(state) {\n      return state.user.expertPoints;\n    },\n\n    levelData(state) {\n      return state.user.levelData;\n    },\n\n    profilePicture(state) {\n      if (!isEmpty(state.user.profilePicture)) {\n        return state.user.profilePicture[250] || state.user.profilePicture.full;\n      }\n      return '/assets/img/user/no-profile-picture.png';\n    },\n\n    loginActivity(state) {\n      return state.user.loginActivity;\n    },\n\n    canRedeem(state) {\n      return state.user.expertPoints >= 50;\n    },\n\n    showUpdatePharmacyModal(state) {\n      return state.showUpdatePharmacyModal;\n    },\n\n  },\n};\n"]}]}