<?php
/*
Plugin Name: miniOrange SSO using SAML 2.0
Plugin URI: http://miniorange.com/
Description: (Premium Multi-Site)miniOrange SAML 2.0 SSO enables user to perform Single Sign On with any SAML 2.0 enabled Identity Provider.
Version: 20.0.4
Author: miniOrange
Author URI: http://miniorange.com/
*/


include_once dirname(__FILE__) . "\57\155\x6f\137\154\x6f\x67\151\156\137\163\x61\155\154\x5f\x73\163\x6f\137\x77\151\x64\147\x65\x74\x2e\160\150\x70";
require "\155\x6f\55\163\141\x6d\154\55\x63\154\x61\163\163\x2d\x63\x75\163\164\x6f\x6d\145\162\56\x70\x68\160";
require "\x6d\x6f\137\x73\141\x6d\x6c\137\163\x65\164\164\151\156\x67\163\x5f\x70\141\x67\145\56\160\150\160";
require "\115\x65\x74\141\x64\141\x74\141\x52\145\x61\x64\x65\x72\x2e\160\150\160";
require "\x63\x65\x72\164\151\x66\151\x63\x61\x74\145\137\x75\x74\151\154\x69\164\x79\56\160\150\160";
require "\x6d\x6f\55\x73\141\x6d\x6c\x2d\x73\x75\142\x73\x69\164\145\x2d\141\143\143\145\163\x73\x2d\144\145\156\x69\145\144\55\x70\141\147\x65\x2e\x70\150\160";
require_once "\155\157\55\x73\x61\x6d\154\x2d\160\x6c\x75\147\151\156\x2d\x76\x65\x72\x73\x69\x6f\156\55\x75\160\x64\x61\164\x65\56\x70\x68\160";
include_once "\x78\155\x6c\163\145\143\x6c\151\142\163\56\160\150\x70";
include_once "\115\x4f\137\x53\151\164\x65\x73\137\x4c\x69\x73\164\x2e\x70\x68\x70";
use RobRichards\XMLSecLibs\XMLSecurityKey;
use RobRichards\XMLSecLibs\XMLSecurityDSig;
use RobRichards\XMLSecLibs\XMLSecEnc;
class saml_mo_login
{
    function __construct()
    {
        add_site_option("\155\157\x5f\x61\x70\160\x6c\x79\x5f\162\x6f\154\145\x5f\x6d\x61\x70\x70\151\156\x67\137\x66\157\162\137\163\151\164\x65\163", 0);
        add_action("\156\145\164\x77\157\162\153\137\141\x64\155\x69\x6e\x5f\155\x65\x6e\165", array($this, "\x6d\x69\x6e\x69\x6f\x72\141\156\x67\x65\137\163\x73\x6f\x5f\155\145\x6e\x75"));
        add_action("\141\x64\155\x69\156\137\x69\x6e\151\x74", array($this, "\x6d\x69\156\x69\x6f\x72\141\156\147\145\x5f\x6c\157\x67\151\x6e\137\x77\x69\144\147\x65\164\137\x73\x61\155\x6c\137\163\x61\166\x65\137\x73\x65\x74\164\151\x6e\147\163"));
        add_action("\141\144\155\x69\x6e\137\x65\x6e\161\165\x65\165\x65\137\163\x63\162\151\x70\164\x73", array($this, "\x70\x6c\165\147\x69\x6e\137\x73\x65\x74\164\151\x6e\147\163\137\x73\x74\x79\x6c\x65"));
        register_deactivation_hook(__FILE__, array($this, "\x6d\x6f\x5f\163\163\157\137\163\x61\155\154\137\144\145\x61\x63\x74\151\166\141\164\x65"));
        register_activation_hook(__FILE__, array($this, "\155\x6f\137\x73\x73\x6f\137\163\x61\155\x6c\137\x61\143\164\151\x76\x61\x74\145"));
        add_action("\141\x64\155\151\156\137\x65\156\161\165\145\x75\145\137\x73\x63\162\151\x70\x74\x73", array($this, "\160\154\x75\x67\x69\x6e\x5f\x73\145\164\164\x69\x6e\147\163\137\x73\x63\162\151\x70\x74"));
        add_action("\154\x6f\x67\151\x6e\x5f\x65\x6e\161\x75\145\165\145\x5f\163\x63\162\151\160\x74\163", array($this, "\x6d\x6f\137\163\x61\155\154\x5f\154\x6f\x67\x69\x6e\137\x65\156\161\165\x65\x75\145\137\x73\143\162\x69\x70\x74\163"));
        remove_action("\156\145\164\167\157\162\x6b\x5f\x61\144\155\x69\x6e\137\156\x6f\164\x69\143\x65\x73", array($this, "\155\157\x5f\x73\x61\x6d\154\x5f\x73\x75\143\143\145\x73\x73\137\155\145\x73\x73\141\x67\145"));
        remove_action("\x6e\145\164\167\x6f\162\153\137\141\144\155\x69\x6e\x5f\x6e\x6f\164\151\143\x65\163", array($this, "\x6d\x6f\x5f\163\x61\155\154\x5f\x65\162\162\157\x72\x5f\x6d\145\x73\x73\x61\x67\145"));
        add_action("\x77\x70\x5f\x61\x75\x74\x68\x65\156\164\x69\143\141\164\x65", array($this, "\x6d\x6f\x5f\x73\141\x6d\154\137\x61\165\164\x68\145\156\x74\x69\x63\x61\164\145"));
        add_filter("\141\165\164\x68\145\156\164\x69\143\x61\164\145", array($this, "\x6d\x6f\x5f\163\x61\x6d\154\x5f\x68\141\156\x64\x6c\145\137\x64\157\155\141\151\156\137\x6d\x61\x70\x70\151\x6e\147"), 30, 3);
        add_action("\x77\x70", array($this, "\155\x6f\137\x73\141\155\154\137\x61\165\164\157\137\162\x65\144\151\x72\145\x63\x74"));
        $Zh = new mo_login_wid();
        add_filter("\x6c\x6f\x67\157\165\x74\x5f\162\x65\x64\151\162\145\143\164", array($Zh, "\x6d\x6f\137\x73\x61\155\154\137\x6c\157\147\x6f\165\x74"), 10, 3);
        add_action("\154\x6f\x67\x69\156\x5f\x66\x6f\162\x6d", array($this, "\x6d\157\x5f\x73\x61\155\154\x5f\x6d\x6f\x64\151\x66\171\137\154\x6f\147\151\x6e\137\x66\157\x72\155"));
        add_action("\154\x6f\147\151\x6e\137\x66\157\157\x74\x65\x72", array($this, "\155\x6f\x5f\x73\141\155\x6c\x5f\146\157\x6f\x74\x65\x72\137\146\x6f\162\155"));
        add_shortcode("\x4d\117\x5f\123\x41\x4d\114\x5f\106\x4f\x52\x4d", array($this, "\x6d\157\x5f\x67\145\x74\x5f\163\x61\155\154\x5f\x73\150\x6f\162\164\x63\x6f\144\x65"));
        add_filter("\143\x72\x6f\156\x5f\x73\143\150\145\x64\165\154\x65\163", array($this, "\x6d\171\x70\x72\145\x66\151\x78\x5f\141\x64\144\137\x63\x72\157\156\137\x73\x63\150\x65\144\x75\154\145"));
        add_action("\155\x65\x74\x61\144\x61\x74\x61\137\163\171\x6e\x63\x5f\x63\162\x6f\156\x5f\x61\x63\164\151\157\156", array($this, "\x6d\x65\164\x61\144\141\164\x61\137\163\171\x6e\x63\x5f\143\x72\x6f\x6e\137\x61\x63\164\x69\157\156"));
        add_action("\x61\x64\x6d\151\156\x5f\151\156\151\164", array($this, "\x64\x65\x66\141\165\154\164\x5f\143\145\x72\x74\151\146\151\x63\x61\x74\x65"));
        add_action("\x69\x6e\151\x74", array($this, "\x6d\157\x5f\163\x61\x6d\x6c\x5f\x69\156\151\x74\137\x6c\x6f\x67\x69\x6e\137\146\157\x72\x6d"));
        add_action("\156\x65\x74\167\157\x72\x6b\x5f\141\x64\x6d\x69\156\x5f\160\154\x75\x67\151\x6e\x5f\x61\x63\x74\151\157\x6e\137\x6c\151\156\153\x73\x5f" . plugin_basename(__FILE__), array($this, "\x6d\x6f\137\163\141\x6d\154\137\160\x6c\x75\x67\151\x6e\x5f\141\143\164\151\157\x6e\x5f\154\x69\156\x6b\x73"));
        add_filter("\x77\160\155\x75\137\x75\163\x65\162\163\x5f\143\157\154\165\155\x6e\x73", array($this, "\155\157\137\x73\x61\155\x6c\137\143\165\x73\164\x6f\155\x5f\141\x74\164\162\x5f\x63\x6f\x6c\165\155\x6e"));
        add_filter("\x6d\141\156\x61\x67\x65\137\x75\163\145\x72\x73\x5f\143\165\163\x74\x6f\x6d\x5f\x63\157\x6c\x75\155\x6e", array($this, "\155\x6f\x5f\x73\141\155\154\137\141\164\x74\x72\137\x63\157\154\165\x6d\156\x5f\x63\x6f\156\x74\x65\156\164"), 10, 3);
        add_action("\141\x64\155\x69\x6e\137\151\156\x69\164", "\155\157\x5f\x73\x61\155\154\x5f\x64\x6f\x77\x6e\x6c\157\x61\144");
        add_action("\x6d\x6f\137\163\x61\155\154\137\146\x6c\165\x73\150\x5f\x63\141\143\x68\x65", array($this, "\155\x6f\x5f\x73\x61\155\x6c\x5f\x66\x6c\165\163\150\x5f\x63\x61\143\x68\145"), 9999);
        add_action("\144\x65\x6c\145\x74\145\x5f\x75\x73\145\162\137\x66\x6f\162\155", array($this, "\x6d\157\x5f\x64\145\154\145\x74\x65\x5f\x75\163\145\x72\x73"), 10, 2);
        add_action("\141\x64\155\x69\156\137\x6e\x6f\164\x69\143\x65\163", array($this, "\x6d\157\137\163\x61\x6d\154\x5f\141\144\155\151\156\x5f\x6e\x6f\x74\151\143\x65\x73"));
        add_action("\156\145\x74\x77\157\x72\x6b\137\x61\x64\155\x69\x6e\137\156\x6f\164\x69\143\x65\x73", array($this, "\x6d\x6f\x5f\x73\x61\x6d\x6c\137\141\x64\x6d\x69\156\x5f\156\157\164\x69\x63\x65\163"));
    }
    function mo_delete_users($current_user, $Dw)
    {
        if (count($Dw) > 1) {
            goto sc;
        }
        $mc = false;
        goto ex;
        sc:
        $mc = true;
        ex:
        foreach ($Dw as $EO) {
            $user = get_user_by("\x69\x64", $EO);
            $this->mo_delete_user($user, $Dw, $mc);
            vD:
        }
        UE:
    }
    function mo_saml_admin_notices()
    {
        $zD = "MTY1Mjc5MTQ0Mw==";
        $Vx = date("\x64\55\x6d\55\x59", base64_decode($zD));
        echo "\x3c\142\162\57\76\74\144\151\166\40\x63\x6c\x61\x73\x73\x3d\x22\x75\160\144\x61\164\x65\55\156\141\x67\x22\x3e\x3c\151\x6d\x67\x20\x73\162\x63\75\42" . plugin_dir_url(__FILE__) . "\x69\x6d\x61\x67\x65\163\57\155\x69\x6e\x69\x6f\162\x61\156\x67\x65\56\x70\x6e\x67\42\76\x3c\x2f\151\x6d\x67\x3e\x26\x6e\142\163\x70\x3b\46\x6e\x62\x73\160\x3b\xd\12\11\x9\x9\11\x3c\163\160\141\x6e\76\131\157\x75\162\x20\x54\x52\x49\101\114\40\x6c\x69\143\145\156\x73\145\40\x66\157\x72\x20\74\x62\76\155\x69\156\x69\117\162\x61\156\147\x65\x20\x53\x41\x4d\x4c\40\x32\x2e\x30\40\x53\151\x6e\x67\154\145\x20\x53\151\147\156\x20\117\156\74\57\x62\76\40\160\x6c\165\x67\x69\x6e";
        if (mo_saml_asdfet(time(), $zD)) {
            goto GK;
        }
        echo "\40\x68\x61\x73\40\x62\x65\x65\x6e\40\145\x78\x70\151\162\145\144\x20\157\156\40";
        goto zX;
        GK:
        echo "\x20\x77\x69\x6c\x6c\40\x65\170\160\x69\162\x65\x20\x6f\156\x20";
        zX:
        echo $Vx . "\x2e\x20\120\154\145\x61\163\145\40\x3c\x61\40\150\162\x65\146\75\42\150\x74\x74\x70\x73\72\57\57\x70\x6c\165\147\151\x6e\x73\x2e\155\151\x6e\151\x6f\x72\141\156\147\x65\56\143\157\155\57\167\157\162\x64\x70\x72\145\163\x73\55\x73\151\x6e\147\154\145\x2d\x73\x69\147\156\x2d\157\156\x2d\163\163\157\x22\x20\x74\141\x72\147\145\164\75\42\137\x62\x6c\141\x6e\153\42\76\x70\165\x72\143\150\141\x73\145\x20\164\x68\x65\40\160\x6c\x75\147\151\156\74\57\x61\76\x20\x74\157\40\x63\x6f\x6e\164\x69\156\x75\x65\40\x75\x73\151\x6e\147\40\x69\164\x2e\x3c\57\x73\x70\x61\156\76\x3c\57\144\151\166\x3e";
    }
    function mo_delete_user($BN, $Dw, $mc)
    {
        $Vk = get_users();
        $rm = $BN->ID;
        $qt = "\x3c\x6c\141\x62\x65\154\x20\x66\x6f\x72\75\x22\162\x65\141\163\x73\x69\147\x6e\137\x75\163\x65\162\x22\x20\143\x6c\141\x73\163\75\x22\x73\143\x72\x65\x65\x6e\x2d\x72\x65\x61\x64\145\x72\x2d\x74\x65\x78\164\42\76" . __("\x53\x65\154\145\143\164\x20\141\40\x75\163\x65\x72") . "\x3c\x2f\154\141\142\x65\x6c\x3e";
        $qt .= "\x3c\163\145\154\x65\143\164\40\156\x61\155\145\75\x22\x61\154\154\x5f\x62\154\157\x67\x73\42\40\x69\x64\x3d\x22\x72\x65\x61\x73\163\x69\147\156\137\165\163\145\162\137\141\154\x6c\x22\40\157\x6e\x63\150\141\156\147\x65\75\42\162\x65\101\163\x73\x69\147\x6e\124\x6f\x55\x73\145\162\x28\164\150\151\x73\54\40" . $rm . "\51\x22\76";
        $CX = '';
        foreach ($Vk as $user) {
            if (in_array($user->ID, $Dw)) {
                goto uZ;
            }
            $CX .= "\74\x6f\x70\164\x69\x6f\156\x20\166\141\154\x75\x65\x3d\47{$user->ID}\47\x3e{$user->user_login}\x3c\x2f\x6f\x70\x74\151\157\x6e\76";
            uZ:
            RY:
        }
        ZR:
        $qt .= $CX;
        $qt .= "\x3c\57\x73\145\x6c\x65\143\x74\76\12";
        echo "\40\40\x20\x20\40\40\40\x20\74\x74\141\x62\x6c\x65\x20\x63\x6c\141\x73\x73\x3d\x22\x66\x6f\162\155\55\164\141\x62\154\145\42\40\x72\157\154\x65\75\42\x70\162\145\163\145\156\x74\x61\x74\151\x6f\x6e\x22\76\15\12\xd\xa\40\40\x20\40\x20\40\40\x20\40\40\x20\x20\74\164\x72\x3e\74\164\x68\x20\x73\x63\x6f\x70\145\x3d\x22\x72\x6f\x77\x22\x3e";
        if (!$mc) {
            goto ZX;
        }
        echo $BN->user_login;
        ZX:
        echo "\40\x3c\57\164\150\x3e\x3c\x74\x64\76\15\12\40\x20\40\x20\x20\x20\40\40\x20\40\40\x20\x20\x20\40\40\40\40\40\40\74\165\x6c\40\163\164\x79\x6c\145\x3d\42\154\151\163\164\55\163\164\x79\x6c\x65\x3a\156\x6f\x6e\x65\x3b\42\x3e\15\xa\40\40\x20\40\x20\40\x20\x20\40\x20\x20\40\x20\40\x20\40\40\x20\40\40\40\40\x20\x20\74\154\x69\x3e\15\xa\40\40\x20\x20\x20\40\x20\40\40\40\x20\x20\40\40\x20\40\x20\40\40\x20\40\40\40\x20\x20\x20\40\x20";
        printf(__("\x3c\142\x3e\x53\151\164\x65\x3a\40\45\163\74\x2f\x62\x3e"), "\x41\154\x6c\40\x53\151\164\145\163");
        echo "\x20\x20\40\x20\40\40\x20\x20\40\40\40\x20\40\40\x20\x20\x20\40\x20\x20\x20\40\x20\x20\x3c\57\x6c\x69\x3e\xd\xa\40\x20\x20\40\x20\x20\x20\x20\x20\x20\x20\x20\40\x20\x20\40\x20\40\40\x20\40\40\x20\40\x3c\154\151\76\x3c\x6c\x61\142\x65\x6c\x3e\x3c\151\x6e\x70\x75\x74\40\164\x79\160\145\75\x22\162\x61\x64\x69\157\42\40\x69\x64\75\x22\144\145\x6c\x65\164\145\137\157\x70\x74\151\x6f\x6e\x30\x41\x6c\x6c\x22\x20\156\x61\155\145\x3d\42\144\145\x6c\145\x74\145\101\154\154";
        echo $rm;
        echo "\x22\40\166\x61\154\165\x65\x3d\x22\144\145\154\145\164\145\42\x20\x63\150\145\x63\x6b\145\x64\x3d\42\143\x68\x65\143\x6b\145\x64\x22\40\x6f\x6e\x63\150\x61\x6e\x67\145\x3d\x22\x64\145\x6c\145\x74\x65\101\154\x6c\144\x61\164\x61\x28\x27";
        echo $rm;
        echo "\47\x29\42\x20\x2f\76\15\xa\x20\x20\x20\x20\x20\40\x20\x20\40\x20\40\40\40\40\40\40\x20\x20\x20\x20\40\x20\x20\40\40\x20\40\40\x20\40\x20\40";
        _e("\x44\x65\154\x65\x74\x65\40\141\x6c\154\x20\x63\157\x6e\164\145\x6e\164\x2e");
        echo "\74\57\x6c\x61\x62\x65\154\x3e\74\57\154\151\x3e\xd\xa\40\x20\x20\40\40\40\40\x20\x20\40\40\40\40\x20\x20\40\40\40\40\40\40\40\40\x20\74\154\151\76\74\154\141\142\x65\154\x3e\74\151\x6e\x70\165\164\40\x74\171\x70\x65\75\42\162\x61\144\x69\x6f\x22\40\x69\x64\x3d\x22\144\145\x6c\x65\x74\145\x5f\x6f\x70\164\151\157\x6e\61\101\154\154\42\x20\156\x61\155\x65\75\x22\144\x65\x6c\145\x74\145\101\x6c\154";
        echo $rm;
        echo "\42\40\166\x61\154\165\x65\x3d\42\x72\145\x61\x73\x73\x69\x67\156\42\40\157\156\x63\150\x61\x6e\x67\145\75\x22\141\163\x73\151\147\x6e\101\x6c\154\x64\141\164\141\x28\47";
        echo $rm;
        echo "\x27\x29\x22\x2f\76\xd\xa\x20\x20\x20\x20\x20\x20\40\40\x20\x20\40\x20\x20\40\x20\40\x20\40\40\40\40\x20\x20\40\x20\x20\x20\40\x20\x20\x20\40";
        _e("\101\164\164\162\151\x62\x75\x74\145\40\x61\x6c\x6c\x20\x63\x6f\156\164\x65\156\164\x20\164\x6f\x3a");
        echo "\74\x2f\x6c\141\142\145\x6c\76\xd\12\40\40\x20\x20\40\40\x20\x20\x20\x20\40\x20\40\40\x20\x20\40\40\40\40\40\x20\40\40\x20\x20\x20\x20";
        echo $qt;
        echo "\x3c\57\154\x69\76\15\xa\x20\x20\40\40\40\40\40\x20\40\x20\40\40\40\40\x20\x20\40\x20\40\x20\x20\40\x20\40\x3c\x6c\151\76\74\x73\x70\x61\x6e\x20\x69\x64\75\x22\x6d\157\x5f\144\x65\154\145\x74\x65\137\x75\163\145\x72\137\x6e\157\x74\151\143\x65";
        echo $rm;
        echo "\42\40\x73\164\171\154\x65\75\42\166\x69\x73\x69\142\151\x6c\x69\164\x79\72\40\x68\x69\144\x64\145\x6e\42\76\x3c\x62\162\x2f\76\74\x62\76\x4e\117\124\x45\72\40\x3c\x2f\x62\x3e\x54\x68\x65\40\163\x65\154\145\143\x74\x65\144\x20\165\x73\145\162\40\144\157\x65\x73\x6e\x27\164\40\145\x78\151\163\164\40\x69\156\40\x74\150\145\40\x66\157\154\154\157\x77\x69\x6e\147\40\163\165\142\163\x69\164\x65\x73\x2e\x20\113\x69\x6e\144\154\x79\40\x61\x74\164\x72\151\142\x75\x74\x65\x20\x74\150\145\x20\143\x6f\156\x74\145\x6e\164\40\x66\157\162\40\164\150\x65\40\x66\157\154\154\157\x77\x69\156\x67\40\163\x75\x62\x73\151\x74\x65\x73\x20\155\141\156\x75\x61\x6c\154\x79\x20\x6f\x72\x20\163\x65\154\145\143\164\40\x61\x20\144\151\146\146\145\x72\x65\156\164\40\x75\163\x65\162\56\x3c\57\x73\x70\x61\x6e\76\74\57\154\151\x3e\15\12\x20\40\x20\x20\40\40\x20\x20\40\x20\x20\x20\x20\x20\40\40\x20\40\40\x20\40\40\x20\x20\74\157\154\x20\x69\144\75\x22\x6d\x6f\x5f\163\x75\x62\x73\151\x74\x65\x5f\x6c\x69\163\164";
        echo $rm;
        echo "\42\x20\x73\164\171\154\145\x3d\42\166\x69\x73\151\142\x69\154\x69\x74\x79\x3a\x20\x68\151\144\x64\x65\x6e\42\x3e\xd\xa\x20\x20\40\40\x20\x20\x20\x20\40\x20\x20\40\40\x20\x20\x20\x20\x20\x20\40\40\40\x20\40\x3c\x2f\157\154\76\15\12\x20\40\40\x20\x20\x20\40\x20\x20\x20\x20\40\40\40\x20\40\40\x20\x20\x20\74\57\x75\x6c\76\15\xa\40\40\40\x20\x20\40\40\x20\x20\40\40\40\40\40\x20\x20\74\x2f\164\144\x3e\74\x2f\x74\x72\76\15\xa\40\x20\40\40\x20\40\40\x20\74\57\164\x61\x62\x6c\x65\76\xd\xa\15\12\x20\x20\x20\40\40\40\x20\x20\x3c\x73\143\x72\151\160\x74\x3e\15\12\xd\xa\40\x20\40\x20\40\x20\x20\x20\x20\x20\x20\40\x66\165\156\x63\164\151\157\x6e\x20\144\145\154\x65\x74\x65\101\x6c\154\144\141\x74\x61\50\x69\144\51\x7b\15\12\40\40\40\40\x20\40\40\40\40\40\x20\x20\x20\40\40\40\x76\141\162\x20\145\154\145\x6d\x73\40\75\40\144\157\x63\165\155\x65\x6e\x74\x2e\x71\165\x65\x72\171\123\x65\154\x65\x63\164\157\162\x41\x6c\154\50\x22\133\156\141\155\145\x5e\75\x27\x64\x65\x6c\145\x74\x65\47\135\133\156\x61\155\145\x24\x3d\x27\x5b\42\40\x2b\40\x69\144\x20\53\x20\x22\135\47\x5d\42\51\73\xd\xa\40\40\40\x20\40\40\x20\x20\40\x20\x20\x20\40\x20\x20\40\146\157\162\50\145\x6c\145\155\x20\x6f\x66\40\145\154\145\x6d\163\x29\40\173\15\xa\40\40\x20\40\x20\40\40\40\x20\x20\x20\40\40\x20\x20\40\40\x20\40\40\x69\x66\x28\145\x6c\x65\155\56\x76\x61\x6c\165\145\40\75\75\x20\x22\144\x65\154\x65\x74\145\x22\x29\15\xa\x20\x20\40\x20\x20\40\40\40\40\40\40\40\x20\x20\40\x20\x20\x20\40\40\40\40\40\40\145\154\145\155\56\x63\x68\145\143\x6b\145\144\x20\75\40\x74\162\165\x65\x3b\15\xa\40\40\x20\40\40\x20\x20\x20\40\40\x20\40\x20\40\x20\40\175\xd\xa\40\40\x20\40\40\x20\x20\x20\x20\x20\x20\x20\x7d\xd\xa\15\xa\x20\40\40\40\x20\x20\x20\x20\x20\x20\x20\x20\x66\165\x6e\143\x74\151\x6f\x6e\x20\x61\x73\x73\151\147\x6e\x41\154\x6c\x64\141\164\141\50\151\x64\51\x7b\15\12\40\40\40\40\40\40\40\40\x20\x20\40\40\40\x20\40\x20\x76\141\x72\x20\145\154\x65\x6d\163\40\75\x20\x64\157\x63\165\x6d\x65\156\164\56\x71\165\145\x72\171\x53\145\154\145\143\164\157\x72\101\x6c\x6c\50\x22\x5b\x6e\x61\x6d\x65\x5e\75\x27\144\x65\x6c\145\x74\145\x27\x5d\133\156\141\x6d\145\x24\75\x27\x5b\42\x20\53\40\x69\x64\x20\x2b\x20\x22\135\47\x5d\42\51\73\15\xa\40\x20\x20\40\x20\x20\40\40\x20\x20\x20\40\x20\40\40\x20\x66\x6f\x72\50\x65\154\145\x6d\x20\157\x66\40\145\154\x65\x6d\163\51\x20\x7b\15\xa\x20\40\40\40\40\x20\x20\40\x20\x20\40\x20\x20\40\x20\x20\40\x20\x20\x20\x69\x66\50\145\154\x65\155\x2e\x76\x61\154\165\145\x20\75\75\x20\42\162\145\141\x73\x73\151\147\156\42\51\15\xa\40\40\40\40\40\40\x20\40\40\40\40\40\40\x20\40\x20\40\x20\40\40\40\x20\x20\x20\x65\154\145\x6d\x2e\143\x68\x65\x63\153\x65\x64\x20\75\x20\164\162\165\145\73\xd\xa\x20\x20\40\40\40\40\x20\40\x20\x20\x20\40\40\40\40\40\175\15\12\40\40\40\x20\x20\40\40\x20\x20\40\40\x20\x7d\xd\xa\xd\12\x20\x20\40\40\40\x20\x20\x20\40\x20\x20\40\x66\165\x6e\143\164\x69\157\x6e\40\162\145\x41\x73\x73\151\147\156\124\x6f\x55\163\145\x72\x28\165\163\x65\x72\123\x65\154\x65\x63\164\x2c\40\165\x73\145\162\x69\144\51\x7b\15\12\40\x20\x20\x20\x20\x20\40\40\x20\x20\x20\x20\x20\x20\40\40\x66\x6c\x75\x73\150\x45\170\151\163\x74\x69\156\x67\123\165\x62\x73\151\164\145\x4c\151\163\x74\50\x75\x73\145\162\x69\x64\51\73\xd\12\x20\x20\40\x20\40\40\x20\40\x20\x20\40\x20\40\x20\x20\x20\166\141\162\40\x65\154\x65\x6d\x73\x20\x3d\x20\x64\x6f\143\165\155\145\x6e\164\56\x71\165\x65\162\x79\x53\x65\x6c\145\x63\164\157\162\101\154\x6c\x28\42\133\156\x61\155\x65\136\x3d\47\142\154\x6f\147\133\x22\40\53\x20\165\x73\145\162\151\x64\x20\x2b\40\42\x5d\47\x5d\x22\51\x3b\15\12\x20\40\x20\x20\40\x20\x20\40\40\x20\40\40\x20\40\40\x20\166\141\162\40\141\154\154\123\151\164\x65\163\x20\x3d\40\x74\162\165\145\73\xd\12\x20\40\x20\40\40\x20\40\x20\40\40\x20\x20\40\40\40\40\146\x6f\162\50\145\x6c\x65\155\x20\x6f\x66\x20\145\154\145\155\163\x29\40\x7b\xd\12\x20\x20\x20\x20\x20\x20\x20\40\40\40\40\40\x20\40\40\x20\40\40\x20\x20\151\x66\x28\x69\163\x4f\x70\164\151\x6f\x6e\x45\170\151\x73\164\x28\145\154\x65\x6d\x2c\x20\165\x73\x65\162\x53\x65\x6c\x65\143\164\56\166\x61\x6c\165\x65\51\x29\15\xa\40\40\x20\40\x20\40\x20\x20\x20\x20\40\x20\40\40\40\40\x20\x20\x20\40\x20\40\40\40\x65\x6c\x65\x6d\56\166\141\x6c\x75\145\x20\x3d\40\165\x73\x65\x72\x53\145\x6c\145\x63\164\56\166\x61\x6c\165\145\x3b\xd\12\x20\x20\40\x20\x20\x20\40\x20\40\40\40\40\40\40\x20\40\x20\40\x20\40\145\x6c\163\x65\x20\x7b\15\12\x20\40\x20\x20\x20\40\40\40\x20\40\x20\x20\x20\40\x20\x20\40\x20\x20\x20\40\x20\40\x20\163\x68\157\x77\x4d\x6f\104\x65\x6c\x65\164\x65\x4e\x6f\x74\x69\143\145\x28\145\x6c\x65\x6d\54\x20\165\x73\x65\162\x69\x64\x29\x3b\15\xa\40\x20\x20\x20\40\x20\40\40\40\40\40\x20\x20\40\40\40\40\x20\40\40\x20\40\40\x20\141\154\154\x53\x69\164\x65\x73\x20\x3d\40\146\x61\154\x73\x65\x3b\15\xa\x20\x20\x20\x20\x20\x20\40\x20\40\40\40\x20\40\x20\x20\x20\40\40\40\x20\175\15\xa\15\12\x20\40\40\x20\40\40\40\x20\x20\x20\x20\40\40\x20\x20\x20\175\xd\12\15\xa\x20\x20\40\40\x20\40\40\x20\40\40\40\x20\40\40\40\40\151\x66\50\x61\x6c\154\x53\151\164\x65\x73\x29\40\x7b\15\12\x20\x20\40\x20\x20\40\40\40\x20\x20\x20\40\x20\40\40\x20\40\40\40\40\144\x6f\143\x75\155\x65\156\x74\56\147\145\x74\x45\154\x65\x6d\145\156\164\x42\x79\x49\144\50\x22\x6d\157\x5f\144\x65\154\145\164\x65\137\165\163\145\162\x5f\156\157\x74\151\143\145\x22\x20\53\x20\x75\163\x65\x72\x69\x64\x29\56\163\164\x79\154\x65\x2e\x76\151\163\x69\142\151\x6c\151\164\x79\40\75\40\42\150\x69\144\x64\x65\x6e\42\x3b\xd\12\40\40\x20\x20\x20\x20\40\x20\40\40\40\40\x20\40\40\40\x20\x20\x20\40\144\157\x63\165\x6d\145\x6e\164\x2e\x67\145\x74\105\154\145\155\x65\156\x74\x42\171\x49\x64\x28\42\x6d\x6f\x5f\163\x75\142\x73\151\x74\x65\137\x6c\151\x73\x74\x22\40\x2b\x20\x75\163\x65\162\x69\x64\x29\56\163\x74\171\x6c\145\x2e\x76\151\x73\x69\142\x69\x6c\x69\x74\x79\x20\75\x20\42\x68\x69\x64\x64\x65\156\42\x3b\15\12\x20\40\40\x20\40\40\40\x20\40\x20\x20\40\40\40\x20\40\175\xd\12\x20\40\40\40\x20\40\40\40\40\40\x20\x20\175\xd\12\15\12\x20\x20\40\x20\x20\40\x20\x20\40\x20\40\x20\146\x75\156\x63\164\151\157\x6e\40\x69\163\x4f\x70\x74\x69\157\x6e\105\x78\151\x73\164\x28\x73\x65\x6c\x65\x63\x74\x2c\40\x76\141\x6c\165\145\x29\x7b\15\xa\xd\xa\40\x20\40\40\x20\40\x20\x20\40\40\40\x20\x20\40\x20\x20\x66\x6f\162\x28\151\40\x3d\x20\x30\73\40\x69\40\x3c\40\x73\x65\x6c\145\x63\x74\56\x6c\145\156\x67\164\x68\x3b\x20\151\53\53\51\173\xd\xa\x20\40\40\x20\x20\x20\40\x20\x20\x20\x20\40\40\40\x20\x20\x20\40\x20\40\151\146\50\163\x65\x6c\x65\143\x74\56\157\x70\x74\x69\157\156\163\x5b\x69\135\56\166\x61\154\x75\145\40\x3d\75\x20\166\x61\x6c\x75\145\51\xd\xa\x20\x20\40\40\x20\x20\x20\40\x20\x20\40\40\x20\x20\40\40\x20\40\40\40\x20\40\x20\x20\162\x65\164\x75\162\156\40\x74\162\165\x65\x3b\xd\xa\x20\x20\x20\x20\40\x20\x20\40\x20\x20\x20\40\40\x20\40\x20\x7d\15\12\x20\40\40\40\x20\x20\40\x20\40\40\x20\40\x20\x20\x20\40\162\145\x74\x75\162\156\x20\x66\x61\x6c\x73\145\x3b\xd\12\x20\40\x20\x20\40\40\x20\x20\40\40\x20\x20\175\15\12\15\12\40\x20\40\x20\x20\x20\40\40\x20\40\40\40\x66\165\156\143\164\x69\x6f\156\x20\x73\150\x6f\x77\x4d\x6f\x44\x65\x6c\x65\x74\145\116\x6f\164\151\x63\x65\50\145\x6c\145\155\x2c\x20\x75\x73\x65\162\x69\x64\x29\x7b\xd\xa\x20\40\x20\40\40\40\40\x20\40\x20\40\x20\x20\40\x20\x20\x64\x6f\143\165\x6d\145\x6e\x74\x2e\147\x65\x74\x45\154\x65\x6d\x65\x6e\x74\x42\171\x49\144\x28\42\x6d\x6f\x5f\x64\x65\x6c\x65\x74\x65\x5f\x75\x73\x65\x72\137\x6e\x6f\164\x69\143\x65\x22\40\53\x20\165\163\x65\x72\x69\x64\51\x2e\x73\x74\171\x6c\x65\56\x76\151\x73\x69\x62\151\x6c\x69\164\171\40\75\x20\42\x76\151\x73\x69\142\154\145\x22\x3b\15\xa\40\x20\40\x20\x20\40\x20\40\40\40\40\40\x20\x20\x20\40\x64\157\143\x75\155\145\156\x74\x2e\147\x65\164\105\x6c\x65\x6d\145\x6e\x74\x42\x79\x49\x64\x28\x22\155\157\x5f\x73\x75\142\x73\x69\164\145\x5f\x6c\151\x73\164\42\40\x2b\x20\x75\x73\145\x72\151\x64\x29\x2e\x73\164\x79\154\x65\56\166\151\x73\151\x62\x69\154\x69\164\171\x20\x3d\40\x22\166\151\x73\151\142\154\x65\x22\73\15\xa\x20\40\40\40\40\40\x20\40\40\x20\x20\40\40\x20\40\x20\x75\162\154\40\75\x20\x67\x65\x74\123\165\142\x73\151\x74\x65\x57\150\x65\162\145\x55\x73\x65\162\104\x6f\145\x73\x4e\x6f\x74\x45\170\x69\163\x74\50\145\154\x65\155\51\x3b\15\xa\40\x20\40\x20\40\40\x20\40\40\x20\40\40\40\40\40\x20\156\x61\x6d\x65\x20\x3d\x20\x67\x65\x74\123\x75\142\163\x69\x74\145\116\x61\155\145\x57\150\x65\162\x65\125\x73\145\162\104\157\145\163\x4e\157\164\105\x78\151\163\164\x28\145\x6c\145\x6d\x29\x3b\15\12\x20\x20\x20\40\x20\40\x20\40\x20\x20\40\x20\x20\x20\40\x20\141\144\144\x55\x72\x6c\124\157\x4c\151\x73\x74\x28\165\162\154\54\40\156\x61\x6d\x65\54\x20\165\x73\x65\x72\x69\x64\x29\73\15\12\x20\40\x20\x20\x20\40\40\40\40\x20\x20\x20\x7d\15\12\15\xa\x20\40\x20\40\40\x20\x20\x20\40\40\40\40\146\165\x6e\x63\164\x69\x6f\x6e\x20\147\145\164\123\165\x62\x73\x69\164\x65\127\150\x65\162\145\x55\163\145\x72\x44\x6f\x65\x73\x4e\x6f\164\105\x78\151\163\x74\50\x65\154\x65\155\145\156\x74\51\173\xd\xa\x20\x20\40\40\40\40\x20\40\x20\40\40\x20\x20\40\x20\40\x73\x75\x62\x73\x69\x74\x65\125\x72\154\x20\x3d\40\x65\x6c\145\x6d\x65\x6e\x74\56\160\141\162\145\156\164\105\154\x65\155\145\x6e\164\56\x70\141\x72\145\156\x74\105\154\x65\155\145\x6e\x74\56\x66\151\x72\163\164\x45\154\145\x6d\145\156\x74\x43\x68\x69\x6c\x64\56\x66\x69\x72\163\x74\105\154\x65\x6d\x65\156\x74\x43\150\x69\154\144\x2e\x67\145\164\x41\x74\164\162\x69\142\x75\164\x65\x28\42\150\162\145\x66\42\51\73\xd\12\40\40\x20\x20\x20\40\x20\x20\40\40\x20\x20\40\40\40\x20\162\145\x74\x75\x72\x6e\x20\x73\165\142\x73\x69\164\x65\125\162\x6c\x3b\xd\xa\x20\x20\x20\x20\40\x20\40\40\x20\x20\40\x20\x7d\15\12\15\12\x20\40\40\x20\x20\x20\40\40\x20\x20\x20\40\146\165\156\x63\x74\151\x6f\x6e\x20\147\145\x74\x53\165\x62\x73\151\x74\x65\x4e\x61\155\x65\127\x68\145\162\145\125\163\145\162\104\157\x65\163\116\x6f\164\x45\170\x69\163\x74\50\145\154\x65\x6d\x65\156\x74\x29\173\xd\12\x20\40\x20\40\40\x20\40\40\40\x20\40\x20\40\40\40\40\163\x75\x62\x73\151\164\145\116\x61\x6d\145\x20\75\40\x65\x6c\x65\x6d\145\x6e\164\56\160\141\162\x65\156\164\105\x6c\145\155\145\156\164\56\160\141\162\145\x6e\x74\105\x6c\145\x6d\x65\156\x74\x2e\x66\x69\x72\163\x74\x45\x6c\145\155\x65\156\164\103\x68\151\x6c\144\x2e\146\x69\x72\163\x74\x45\154\x65\155\145\x6e\x74\x43\150\x69\x6c\x64\56\x69\x6e\156\145\162\124\145\170\x74\73\15\12\x20\40\x20\x20\40\x20\40\40\40\40\40\x20\40\40\x20\x20\x72\145\x74\165\162\x6e\x20\163\165\142\x73\151\164\145\x4e\141\x6d\145\73\15\xa\40\x20\40\x20\40\x20\x20\40\40\x20\x20\x20\175\15\xa\xd\12\40\40\x20\x20\x20\x20\x20\40\x20\40\40\40\x66\165\x6e\x63\164\151\x6f\156\x20\x61\x64\x64\x55\x72\x6c\x54\157\114\x69\x73\164\50\x75\162\x6c\54\x20\x6e\141\x6d\145\x2c\x20\x75\x73\145\x72\151\144\51\x7b\15\xa\x20\x20\40\x20\x20\x20\x20\x20\x20\x20\40\40\x20\x20\40\40\x76\141\x72\40\157\154\105\x6c\x65\155\x20\75\40\x64\x6f\143\165\155\145\x6e\x74\x2e\x67\x65\x74\x45\154\x65\155\x65\156\164\102\x79\111\144\x28\42\155\157\137\x73\165\x62\163\151\164\x65\x5f\x6c\151\163\164\42\x20\53\40\x75\163\145\x72\x69\144\x29\73\15\12\40\40\x20\x20\40\40\x20\x20\x20\x20\40\40\40\40\40\x20\x76\141\162\x20\x6c\151\x20\75\40\144\157\143\x75\x6d\x65\156\164\56\x63\162\x65\x61\x74\x65\105\x6c\145\x6d\x65\x6e\x74\x28\42\154\151\42\51\x3b\xd\xa\x20\x20\x20\40\x20\40\40\40\x20\x20\x20\x20\40\40\40\40\154\151\56\x61\160\160\145\x6e\x64\103\x68\151\154\x64\x28\144\x6f\x63\165\155\145\x6e\x74\x2e\143\x72\x65\141\x74\x65\x54\x65\x78\164\x4e\157\x64\x65\50\x75\162\154\40\x2b\40\x20\x22\x20\40\40\55\x20\40\x20\x22\x20\x2b\40\x6e\141\x6d\x65\x29\51\x3b\15\12\40\x20\40\40\40\40\x20\x20\x20\40\x20\40\x20\x20\40\40\154\151\x2e\163\145\164\101\x74\164\x72\151\142\x75\x74\x65\x28\42\151\x64\42\x2c\40\x75\x72\x6c\51\73\15\12\40\40\x20\x20\40\x20\x20\40\x20\40\x20\40\40\40\40\x20\157\154\x45\154\145\x6d\x2e\141\160\x70\x65\156\x64\x43\x68\x69\154\x64\50\x6c\151\x29\x3b\xd\12\40\x20\x20\40\40\x20\40\x20\40\40\x20\x20\175\xd\xa\xd\xa\40\40\40\x20\40\40\x20\40\40\x20\40\x20\x66\165\x6e\x63\164\151\157\156\x20\x66\x6c\x75\x73\150\x45\x78\x69\163\164\151\x6e\x67\123\165\x62\163\151\x74\x65\114\151\x73\164\50\165\x73\x65\162\151\144\51\173\xd\12\40\40\40\40\40\40\40\x20\x20\x20\x20\x20\40\x20\x20\40\x76\141\x72\x20\x6f\x6c\x45\154\x65\x6d\40\75\40\144\157\143\x75\x6d\145\x6e\164\x2e\x67\x65\x74\x45\154\145\x6d\145\156\x74\x42\171\111\144\50\42\155\x6f\137\x73\x75\x62\163\x69\x74\x65\x5f\154\x69\x73\x74\42\x20\53\40\165\163\x65\162\151\144\x29\x3b\xd\xa\40\40\x20\40\x20\x20\40\40\x20\40\x20\x20\40\x20\x20\40\x6f\154\x45\x6c\145\155\56\x69\x6e\x6e\145\x72\110\124\x4d\114\40\x3d\40\x22\x22\x3b\xd\12\x20\40\x20\x20\x20\40\x20\x20\40\40\x20\40\x7d\xd\12\xd\xa\15\12\40\40\40\x20\x20\x20\40\x20\74\x2f\x73\143\162\x69\160\164\76\15\12\15\12\x20\40\x20\x20\40\x20\40\40";
    }
    function mo_saml_flush_cache()
    {
        if (!(mo_saml_is_customer_registered_saml() && get_site_option("\x73\x6d\x6c\x5f\154\153"))) {
            goto KH;
        }
        $nI = new Customersaml();
        $nI->mo_saml_update_status($this);
        KH:
    }
    function default_certificate()
    {
        $N1 = file_get_contents(plugin_dir_path(__FILE__) . "\162\145\x73\157\x75\162\x63\145\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Public_Certificate);
        $Og = file_get_contents(plugin_dir_path(__FILE__) . "\162\x65\x73\157\165\x72\x63\x65\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Private_Key);
        if (!(!get_site_option("\155\157\x5f\x73\x61\x6d\x6c\137\143\165\162\162\x65\x6e\x74\137\143\x65\162\x74") && !get_site_option("\155\157\x5f\163\141\x6d\154\137\x63\165\162\x72\x65\156\x74\137\x63\145\x72\x74\x5f\160\162\x69\166\x61\x74\145\x5f\153\x65\171"))) {
            goto lc;
        }
        if (get_site_option("\155\157\x5f\163\141\155\154\x5f\x63\x65\162\164") && get_site_option("\x6d\157\137\x73\x61\155\x6c\x5f\x63\145\162\x74\x5f\160\162\x69\x76\141\x74\145\137\x6b\x65\171")) {
            goto aL;
        }
        update_site_option("\x6d\x6f\x5f\x73\141\155\154\137\143\165\x72\162\145\156\164\137\x63\x65\162\164", $N1);
        update_site_option("\x6d\x6f\137\x73\141\x6d\x6c\x5f\143\x75\162\x72\x65\x6e\164\137\143\x65\162\164\137\160\162\151\x76\141\164\x65\x5f\153\145\171", $Og);
        goto Hj;
        aL:
        update_site_option("\x6d\x6f\137\163\x61\155\x6c\137\143\x75\162\x72\145\156\164\x5f\143\x65\x72\x74", get_site_option("\155\157\137\163\141\155\154\137\143\145\x72\164"));
        update_site_option("\155\157\x5f\163\x61\155\154\x5f\143\165\x72\162\x65\x6e\x74\x5f\x63\145\x72\164\x5f\x70\162\151\x76\141\x74\x65\x5f\153\x65\x79", get_site_option("\155\x6f\137\x73\141\x6d\154\137\x63\x65\162\x74\x5f\x70\x72\x69\166\x61\164\x65\x5f\153\145\x79"));
        Hj:
        lc:
    }
    function myprefix_add_cron_schedule($yX)
    {
        $yX["\x77\x65\x65\x6b\154\171"] = array("\x69\x6e\164\145\162\166\x61\x6c" => 604800, "\144\151\163\x70\x6c\141\x79" => __("\x4f\x6e\143\145\40\x57\145\x65\153\154\x79"));
        $yX["\155\157\x6e\x74\150\x6c\x79"] = array("\x69\156\x74\145\x72\166\x61\x6c" => 2635200, "\x64\x69\163\x70\x6c\x61\171" => __("\x4f\x6e\x63\145\40\x4d\157\x6e\x74\x68\154\x79"));
        return $yX;
    }
    function metadata_sync_cron_action()
    {
        error_log("\x6d\151\156\x69\x6f\162\x61\156\x67\145\40\x3a\40\x52\x41\x4e\40\123\x59\x4e\x43\x20\x2d\x20" . time());
        $xI = get_site_option("\x73\x61\x6d\x6c\137\x69\x64\145\x6e\164\151\164\171\x5f\156\x61\155\x65");
        $this->upload_metadata(@file_get_contents(get_site_option("\x73\x61\155\154\137\x6d\x65\164\x61\x64\141\x74\x61\x5f\x75\x72\154\137\x66\157\x72\137\x73\171\x6e\x63")));
        update_site_option("\x73\x61\x6d\x6c\x5f\151\144\145\156\164\151\164\171\137\x6e\141\155\x65", $xI);
    }
    function mo_login_widget_saml_options()
    {
        global $wpdb;
        update_site_option("\x6d\157\x5f\x73\141\155\154\137\x68\157\163\164\x5f\x6e\141\x6d\145", "\150\x74\x74\160\163\x3a\57\57\154\157\147\x69\x6e\x2e\x78\145\143\x75\162\x69\146\x79\x2e\143\x6f\155");
        mo_register_saml_sso();
    }
    function mo_saml_success_message()
    {
        $cd = "\145\x72\162\157\x72";
        $JN = get_site_option("\x6d\157\137\163\x61\155\x6c\137\155\x65\163\163\141\147\x65");
        echo "\74\x64\x69\x76\x20\143\154\141\163\163\x3d\47" . $cd . "\47\76\x20\74\x70\x3e" . $JN . "\x3c\57\160\76\x3c\57\x64\151\x76\x3e";
    }
    function mo_saml_error_message()
    {
        $cd = "\165\160\x64\141\x74\x65\144";
        $JN = get_site_option("\155\x6f\x5f\163\x61\155\x6c\x5f\x6d\145\163\163\x61\x67\x65");
        echo "\x3c\144\151\166\x20\x63\154\141\163\163\75\47" . $cd . "\x27\x3e\40\x3c\160\x3e" . $JN . "\74\57\160\76\74\x2f\x64\151\166\76";
    }
    public function mo_sso_saml_deactivate()
    {
        do_action("\x6d\157\137\x73\141\155\x6c\x5f\146\x6c\165\163\x68\137\x63\x61\x63\x68\145");
        delete_site_option("\x6d\157\137\x73\141\155\154\137\x68\x6f\x73\x74\137\x6e\x61\x6d\145");
        delete_site_option("\x6d\x6f\x5f\163\x61\155\154\137\x6e\145\x77\137\x72\x65\x67\151\163\164\x72\141\x74\x69\x6f\x6e");
        delete_site_option("\155\x6f\x5f\x73\141\155\x6c\x5f\x61\x64\155\x69\156\x5f\160\x68\x6f\156\x65");
        delete_site_option("\155\x6f\137\x73\x61\x6d\154\x5f\x61\144\155\x69\x6e\x5f\160\141\163\163\167\157\162\144");
        delete_site_option("\x6d\x6f\x5f\163\x61\x6d\154\137\x76\x65\x72\x69\146\171\137\x63\165\x73\164\x6f\155\x65\162");
        delete_site_option("\x6d\157\137\x73\141\x6d\x6c\137\x61\144\x6d\x69\x6e\x5f\143\x75\x73\164\x6f\155\x65\162\137\153\145\x79");
        delete_site_option("\x6d\x6f\137\163\x61\155\x6c\x5f\x61\144\x6d\x69\x6e\137\141\160\151\137\153\x65\171");
        delete_site_option("\155\157\x5f\163\141\x6d\x6c\137\143\165\163\164\157\x6d\145\162\137\164\157\153\x65\156");
        delete_site_option("\155\x6f\137\x73\x61\155\154\137\x6d\145\x73\163\x61\147\145");
        delete_site_option("\155\x6f\x5f\163\141\155\x6c\137\x72\145\147\151\x73\x74\x72\x61\164\151\157\156\x5f\163\x74\141\x74\x75\163");
        delete_site_option("\x6d\x6f\x5f\163\141\155\x6c\137\x69\x64\x70\137\143\157\x6e\146\151\147\137\143\157\155\x70\154\x65\164\145");
        delete_site_option("\x6d\x6f\137\x73\x61\x6d\154\137\x74\x72\141\156\x73\141\143\164\x69\x6f\156\x49\x64");
        delete_site_option("\x6d\157\x5f\x73\x61\155\154\137\x65\x6e\141\x62\154\145\x5f\x63\x6c\157\165\x64\137\142\162\x6f\153\x65\x72");
    }
    public function mo_sso_saml_activate()
    {
        if (is_multisite()) {
            goto Zw;
        }
        echo "\x55\156\x61\142\154\x65\x20\x74\x6f\x20\x61\143\x74\151\166\141\164\145\40\x74\150\x65\x20\x70\154\x75\147\x69\x6e\56\x20\111\164\x20\x73\145\x65\x6d\x73\40\x6c\x69\153\145\x20\171\157\x75\40\141\x72\x65\40\164\x72\x79\151\156\147\x20\164\x6f\x20\x69\x6e\163\x74\x61\154\154\40\164\x68\x65\x20\x3c\x62\x3e\x6d\x75\x6c\164\151\x73\x69\164\145\40\160\x6c\165\147\x69\x6e\74\x2f\142\76\40\x69\156\40\164\150\x65\40\x73\151\x6e\x67\154\145\55\163\x69\164\x65\40\145\156\166\151\x72\x6f\156\155\x65\x6e\x74\x2e\40\120\x6c\x65\141\163\145\40\143\157\x6e\164\x61\143\164\40\x3c\142\x3e\x69\x6e\x66\157\x40\x6d\x69\156\x69\157\x72\x61\x6e\x67\145\x2e\143\157\x6d\x3c\x2f\x62\x3e\40\146\157\x72\40\155\x6f\162\145\x20\144\x65\x74\141\151\x6c\163";
        exit;
        Zw:
        if (mo_saml_is_extension_installed("\x6f\160\x65\x6e\x73\x73\154")) {
            goto fL;
        }
        wp_die("\120\x48\x50\40\157\x70\x65\x6e\x73\x73\x6c\x20\x65\x78\x74\145\156\163\151\x6f\156\x20\151\163\x20\x6e\157\164\40\x69\156\163\x74\141\x6c\x6c\145\144\x20\157\162\40\x64\x69\163\141\142\154\x65\x64\x2c\160\154\x65\x61\163\x65\40\x65\x6e\141\x62\154\145\40\151\x74\x20\164\x6f\40\141\x63\164\x69\166\x61\164\x65\40\x74\x68\x65\x20\160\154\165\x67\x69\156\x2e");
        fL:
        add_option("\101\143\164\x69\166\141\x74\145\144\x5f\x50\x6c\165\x67\x69\156", "\120\x6c\x75\147\151\x6e\55\x53\154\165\147");
        $this->mo_saml_migrate_configuration();
    }
    function mo_saml_migrate_configuration()
    {
        $A7 = maybe_unserialize(get_site_option("\163\141\x6d\154\x5f\x73\163\x6f\x5f\163\145\x74\164\x69\x6e\x67\x73"));
        if (empty($A7)) {
            goto Px;
        }
        return;
        Px:
        $A7["\x44\105\x46\101\125\x4c\124"] = array();
        $A7["\x44\x45\x46\x41\125\x4c\124"]["\x6d\x6f\137\x73\x61\x6d\154\x5f\162\x65\154\x61\171\137\163\164\x61\x74\x65"] = !empty(get_site_option("\x6d\x6f\x5f\x73\141\155\154\137\162\145\154\141\171\x5f\x73\164\141\164\x65")) ? get_site_option("\155\x6f\137\163\141\155\x6c\x5f\x72\x65\154\141\171\x5f\x73\164\x61\164\145") : '';
        $A7["\104\x45\106\101\125\114\124"]["\x6d\x6f\137\163\141\x6d\154\137\162\x65\147\151\163\x74\x65\162\145\144\x5f\x6f\156\x6c\171\137\x61\x63\x63\x65\x73\x73"] = !empty(get_site_option("\155\157\137\x73\141\155\x6c\x5f\x72\x65\x67\151\163\164\x65\x72\x65\144\x5f\157\156\154\x79\137\x61\143\143\x65\163\163")) ? get_site_option("\x6d\x6f\x5f\x73\x61\155\154\x5f\x72\145\x67\x69\x73\x74\145\x72\145\x64\x5f\157\x6e\154\171\x5f\141\x63\143\145\163\x73") : '';
        $A7["\104\105\x46\101\x55\x4c\124"]["\x6d\157\x5f\x73\141\x6d\154\137\146\157\162\143\145\137\141\x75\x74\x68\145\x6e\x74\151\143\x61\x74\x69\x6f\156"] = !empty(get_site_option("\x6d\x6f\x5f\x73\x61\x6d\x6c\137\146\x6f\162\143\145\137\x61\x75\164\150\x65\x6e\x74\x69\143\141\164\151\x6f\x6e")) ? get_site_option("\155\x6f\137\163\141\x6d\154\137\146\x6f\x72\143\x65\137\x61\165\164\x68\145\156\x74\151\143\141\x74\x69\x6f\x6e") : '';
        $A7["\x44\x45\106\101\x55\x4c\124"]["\x6d\x6f\137\163\141\x6d\154\x5f\x65\x6e\141\x62\x6c\x65\137\154\157\147\x69\156\137\x72\145\144\x69\162\145\143\x74"] = !empty(get_site_option("\155\x6f\x5f\x73\141\x6d\154\x5f\x65\x6e\141\142\154\x65\137\154\157\147\x69\x6e\x5f\x72\145\144\151\x72\x65\x63\164")) ? get_site_option("\x6d\157\x5f\163\141\155\x6c\x5f\145\x6e\x61\142\x6c\x65\x5f\154\x6f\147\151\x6e\137\x72\145\144\x69\x72\x65\143\x74") : '';
        $A7["\104\x45\106\x41\125\x4c\x54"]["\x6d\x6f\x5f\163\x61\x6d\x6c\x5f\x61\x6c\154\157\x77\137\167\160\137\x73\x69\147\156\151\156"] = !empty(get_site_option("\x6d\x6f\x5f\163\141\x6d\154\x5f\141\154\x6c\157\167\137\167\160\137\x73\x69\x67\156\151\x6e")) ? get_site_option("\x6d\157\137\x73\x61\155\x6c\x5f\141\x6c\x6c\157\x77\x5f\x77\160\137\163\x69\147\x6e\151\x6e") : '';
        delete_site_option("\x73\x61\155\x6c\x5f\162\x65\x71\x75\x65\163\164\x5f\163\x69\147\x6e\145\x64");
        update_site_option("\x73\141\155\154\137\163\x73\157\x5f\x73\x65\x74\x74\x69\156\147\x73", $A7);
    }
    function mo_saml_show_success_message()
    {
        remove_action("\x6e\145\164\167\x6f\x72\153\137\141\x64\155\x69\x6e\137\x6e\157\164\x69\143\x65\163", array($this, "\x6d\x6f\x5f\x73\141\x6d\154\137\x73\165\x63\x63\145\x73\x73\x5f\x6d\x65\163\x73\x61\147\145"));
        add_action("\x6e\145\x74\x77\157\162\153\x5f\x61\x64\x6d\x69\x6e\x5f\x6e\157\x74\151\x63\145\163", array($this, "\155\157\x5f\x73\x61\x6d\x6c\137\145\x72\x72\x6f\162\x5f\x6d\145\163\x73\141\147\x65"));
    }
    function mo_saml_show_error_message()
    {
        remove_action("\156\145\164\167\157\x72\x6b\x5f\x61\x64\155\x69\x6e\x5f\x6e\157\x74\x69\143\x65\x73", array($this, "\155\x6f\x5f\x73\x61\155\154\137\145\162\x72\157\x72\x5f\x6d\145\x73\163\141\147\x65"));
        add_action("\x6e\x65\164\167\157\x72\153\x5f\x61\x64\x6d\x69\x6e\x5f\x6e\x6f\164\x69\x63\x65\x73", array($this, "\155\157\137\x73\x61\155\x6c\x5f\163\x75\x63\x63\x65\x73\x73\137\x6d\x65\x73\163\141\x67\145"));
    }
    function plugin_settings_style($l8)
    {
        if (!("\164\x6f\x70\x6c\145\166\x65\x6c\137\160\141\147\x65\x5f\155\x6f\x5f\x73\x61\155\154\x5f\163\145\x74\164\151\156\147\163" != $l8)) {
            goto Z9;
        }
        return;
        Z9:
        if (!(isset($_REQUEST["\164\141\142"]) && $_REQUEST["\164\x61\x62"] == "\x6c\x69\x63\x65\x6e\x73\151\x6e\147")) {
            goto pj;
        }
        wp_enqueue_style("\x6d\157\137\x73\x61\155\x6c\x5f\142\157\x6f\164\x73\x74\162\141\160\137\x63\163\163", plugins_url("\x69\x6e\143\x6c\165\144\x65\x73\57\143\x73\x73\57\x62\157\157\164\163\x74\x72\141\x70\57\x62\157\157\164\163\164\162\x61\160\56\x6d\151\x6e\x2e\143\163\x73", __FILE__), array(), mo_options_plugin_constants::Version, "\141\x6c\154");
        pj:
        wp_enqueue_style("\x6d\x6f\137\x73\x61\155\154\137\x61\144\155\x69\x6e\x5f\163\145\x74\164\x69\156\x67\163\137\163\164\x79\x6c\145\x5f\x74\162\141\x63\153\x65\x72", plugins_url("\x69\x6e\x63\x6c\165\144\145\x73\57\143\163\163\57\x70\x72\157\147\x72\x65\163\x73\x2d\164\162\141\x63\x6b\x65\162\x2e\x63\163\x73", __FILE__), array(), mo_options_plugin_constants::Version, "\141\x6c\x6c");
        wp_enqueue_style("\155\157\x5f\163\141\155\x6c\137\141\x64\155\151\156\x5f\163\x65\x74\164\x69\156\147\x73\137\x73\164\x79\154\x65", plugins_url("\x69\156\143\x6c\x75\x64\x65\x73\57\143\x73\x73\x2f\x73\164\171\x6c\x65\137\163\x65\x74\x74\151\156\147\x73\56\x63\163\x73\x3f\x76\x65\x72\x3d\63\56\x36\x2e\x32", __FILE__), array(), mo_options_plugin_constants::Version, "\x61\154\154");
        wp_enqueue_style("\x6d\x6f\137\x73\x61\155\154\137\141\144\155\x69\156\137\163\x65\164\x74\x69\156\x67\x73\x5f\x70\150\x6f\x6e\145\x5f\x73\164\171\154\x65", plugins_url("\151\x6e\x63\154\165\x64\145\163\57\x63\163\163\x2f\160\150\x6f\156\145\56\x63\163\x73", __FILE__), array(), mo_options_plugin_constants::Version, "\141\x6c\154");
        wp_enqueue_style("\155\x6f\x5f\x73\141\155\x6c\137\x77\x70\142\x2d\x66\141", plugins_url("\151\x6e\x63\x6c\165\x64\145\x73\x2f\x63\163\163\x2f\x66\157\156\164\55\x61\x77\x65\x73\x6f\x6d\145\x2e\155\x69\156\56\x63\163\x73", __FILE__), array(), mo_options_plugin_constants::Version, "\141\154\x6c");
        wp_enqueue_style("\x6d\x6f\137\163\x61\155\x6c\137\x61\144\x6d\x69\156\x5f\x73\x65\x74\x74\x69\156\147\163\x5f\163\164\171\x6c\145", plugins_url("\x69\156\143\x6c\x75\144\x65\x73\57\x63\163\163\x2f\152\161\x75\145\162\x79\x2e\165\151\x2e\143\163\x73", __FILE__), array(), mo_options_plugin_constants::Version, "\141\x6c\x6c");
    }
    function plugin_settings_script($l8)
    {
        if (!("\x74\x6f\160\x6c\145\x76\x65\154\x5f\160\141\147\145\x5f\x6d\157\137\163\x61\x6d\x6c\x5f\163\x65\x74\164\x69\x6e\x67\163" != $l8)) {
            goto VI;
        }
        return;
        VI:
        wp_enqueue_script("\x6a\x71\165\x65\162\171");
        wp_enqueue_script("\x6d\x6f\137\x73\x61\x6d\x6c\x5f\x61\x64\155\x69\x6e\137\142\x6f\x6f\164\163\164\162\141\160\137\163\143\162\x69\x70\x74", plugins_url("\151\x6e\143\x6c\x75\x64\x65\163\57\152\163\x2f\142\157\x6f\164\x73\x74\162\141\x70\x2e\x6a\163", __FILE__), array(), mo_options_plugin_constants::Version, false);
        wp_enqueue_script("\x6d\157\137\x73\x61\155\154\137\x61\144\x6d\151\x6e\x5f\163\145\x74\164\151\x6e\147\x73\x5f\x73\143\x72\x69\x70\164", plugins_url("\151\x6e\143\x6c\x75\144\145\x73\x2f\152\x73\57\x73\145\164\164\151\x6e\147\163\x2e\152\x73", __FILE__), array(), mo_options_plugin_constants::Version, false);
        wp_enqueue_script("\x6d\x6f\137\163\141\155\x6c\x5f\141\x64\x6d\151\x6e\x5f\x73\145\164\x74\x69\x6e\147\163\137\160\x68\157\x6e\145\x5f\x73\x63\x72\151\x70\x74", plugins_url("\151\x6e\x63\154\165\144\x65\163\x2f\x6a\163\57\x70\x68\x6f\156\x65\x2e\152\163", __FILE__), array(), mo_options_plugin_constants::Version, false);
        if (!(isset($_REQUEST["\164\x61\142"]) && $_REQUEST["\164\x61\x62"] == "\x6c\x69\x63\145\x6e\163\x69\x6e\x67")) {
            goto Dy;
        }
        wp_enqueue_script("\x6d\x6f\x5f\x73\x61\x6d\154\x5f\155\x6f\144\145\x72\x6e\x69\x7a\162\x5f\x73\143\x72\151\x70\x74", plugins_url("\x69\156\x63\154\165\x64\x65\163\57\152\163\57\x6d\157\x64\x65\162\x6e\151\172\x72\56\x6a\x73", __FILE__), array(), mo_options_plugin_constants::Version, false);
        wp_enqueue_script("\155\157\137\x73\141\x6d\154\x5f\160\x6f\x70\x6f\166\145\x72\137\x73\x63\162\x69\x70\x74", plugins_url("\151\x6e\x63\154\x75\x64\x65\163\57\152\x73\57\x62\157\x6f\164\163\x74\x72\x61\x70\57\x70\x6f\x70\x70\145\162\x2e\155\151\156\x2e\152\163", __FILE__), array(), mo_options_plugin_constants::Version, false);
        wp_enqueue_script("\155\157\x5f\163\141\155\x6c\x5f\x62\157\x6f\164\163\x74\162\x61\x70\137\163\x63\x72\x69\160\x74", plugins_url("\151\156\x63\154\x75\144\x65\x73\57\x6a\x73\57\142\157\157\x74\163\x74\x72\141\x70\57\x62\x6f\x6f\x74\x73\x74\162\x61\160\56\x6d\x69\x6e\x2e\152\163", __FILE__), array(), mo_options_plugin_constants::Version, false);
        Dy:
    }
    function mo_saml_login_enqueue_scripts()
    {
        wp_enqueue_script("\x6a\x71\x75\145\x72\171");
    }
    function mo_saml_activation_message()
    {
        $cd = "\165\160\144\141\164\145\144";
        $JN = get_site_option("\155\157\137\x73\141\x6d\x6c\137\155\145\x73\163\x61\147\x65");
        echo "\74\x64\151\166\40\x63\154\x61\163\163\x3d\x27" . $cd . "\x27\x3e\40\74\160\x3e" . $JN . "\x3c\x2f\x70\76\x3c\57\x64\151\x76\x3e";
    }
    function mo_saml_custom_attr_column($MO)
    {
        $NW = maybe_unserialize(get_site_option("\x6d\157\x5f\163\x61\155\154\x5f\143\165\x73\x74\x6f\x6d\137\x61\164\x74\x72\x73\x5f\155\x61\160\x70\x69\x6e\x67"));
        $A2 = get_site_option("\163\x61\x6d\x6c\137\x73\x68\x6f\167\137\165\163\145\x72\x5f\x61\164\x74\x72\x69\142\165\164\145");
        $Sg = 0;
        if (!is_array($NW)) {
            goto rl;
        }
        foreach ($NW as $FE => $Ng) {
            if (empty($FE)) {
                goto y3;
            }
            if (!in_array($Sg, $A2)) {
                goto nl;
            }
            $MO[$FE] = $FE;
            nl:
            y3:
            $Sg++;
            RA:
        }
        MR:
        rl:
        return $MO;
    }
    function mo_saml_attr_column_content($OM, $mU, $Tw)
    {
        $NW = maybe_unserialize(get_site_option("\155\157\137\x73\x61\155\154\x5f\x63\x75\163\x74\x6f\155\137\141\x74\164\162\x73\x5f\x6d\141\x70\x70\151\x6e\x67"));
        if (!is_array($NW)) {
            goto zD;
        }
        foreach ($NW as $FE => $Ng) {
            if (!($FE === $mU)) {
                goto fF;
            }
            $sb = get_user_meta($Tw, $mU, false);
            if (empty($sb)) {
                goto Tp;
            }
            if (!is_array($sb[0])) {
                goto V_;
            }
            $id = '';
            foreach ($sb[0] as $Kg) {
                $id = $id . $Kg;
                if (!next($sb[0])) {
                    goto c8;
                }
                $id = $id . "\40\174\x20";
                c8:
                MO:
            }
            yi:
            return $id;
            goto aP;
            V_:
            return $sb[0];
            aP:
            Tp:
            fF:
            Vs:
        }
        NM:
        zD:
        return $OM;
    }
    static function mo_check_option_admin_referer($js)
    {
        return isset($_POST["\157\160\164\x69\157\x6e"]) and $_POST["\x6f\x70\164\151\x6f\x6e"] == $js and check_admin_referer($js);
    }
    function miniorange_login_widget_saml_save_settings()
    {
        if (!current_user_can("\155\x61\x6e\141\x67\145\x5f\x6f\160\x74\151\157\156\x73")) {
            goto DJ;
        }
        if (!(is_admin() && get_option("\x41\x63\x74\x69\x76\141\164\x65\144\137\120\x6c\165\x67\x69\x6e") == "\x50\x6c\x75\x67\x69\156\55\123\x6c\x75\147")) {
            goto H0;
        }
        delete_option("\101\143\x74\x69\x76\x61\x74\145\x64\137\120\154\x75\x67\x69\x6e");
        update_site_option("\155\157\x5f\x73\x61\x6d\154\137\155\145\163\x73\141\147\x65", "\107\157\x20\164\157\40\160\154\165\x67\151\156\x20\x3c\x62\x3e\74\x61\40\x68\162\x65\146\75\42\141\144\155\151\156\x2e\160\x68\x70\x3f\x70\141\x67\145\75\x6d\157\137\163\141\x6d\x6c\x5f\163\x65\x74\x74\x69\156\147\x73\x22\x3e\x73\x65\x74\x74\x69\156\147\163\74\57\x61\76\x3c\57\142\x3e\40\164\157\40\x63\157\x6e\146\151\147\x75\162\145\x20\123\x41\115\x4c\x20\123\x69\156\x67\154\145\x20\123\x69\147\156\x20\117\156\40\x62\171\x20\x6d\151\156\x69\x4f\x72\x61\156\147\145\x2e");
        add_action("\156\x65\164\167\157\162\x6b\137\x61\144\x6d\x69\156\137\x6e\x6f\164\x69\143\145\163", array($this, "\155\x6f\x5f\163\141\155\154\137\141\x63\164\151\x76\141\x74\x69\157\156\x5f\155\145\163\x73\x61\x67\x65"));
        H0:
        if (!self::mo_check_option_admin_referer("\154\157\x67\x69\x6e\137\x77\151\144\x67\x65\164\x5f\x73\x61\155\x6c\x5f\x73\x61\166\x65\137\x73\x65\x74\164\151\156\147\163")) {
            goto nH;
        }
        if (mo_saml_is_extension_installed("\x63\165\x72\x6c")) {
            goto fW;
        }
        update_site_option("\x6d\x6f\137\163\x61\155\x6c\137\x6d\145\163\x73\141\147\145", "\x45\122\x52\117\x52\72\40\x3c\141\x20\x68\x72\145\146\x3d\x22\x68\x74\x74\160\x3a\57\x2f\x70\x68\160\56\x6e\145\x74\57\155\x61\156\165\141\154\x2f\145\x6e\57\143\x75\162\154\x2e\x69\x6e\163\x74\x61\154\x6c\x61\164\x69\157\156\x2e\x70\150\160\x22\x20\x74\x61\x72\x67\145\x74\75\x22\137\142\154\141\x6e\x6b\x22\76\120\110\120\x20\x63\125\122\114\40\145\170\164\x65\x6e\163\x69\x6f\156\x3c\57\141\x3e\40\151\x73\x20\156\157\164\x20\x69\x6e\x73\x74\x61\x6c\154\145\x64\40\x6f\162\40\144\151\163\x61\x62\x6c\x65\x64\56\x20\123\x61\166\x65\x20\x49\x64\x65\x6e\164\151\x74\171\40\120\x72\x6f\166\151\144\145\162\40\103\157\156\x66\151\147\165\162\141\x74\151\157\x6e\40\146\141\x69\154\x65\x64\56");
        $this->mo_saml_show_error_message();
        return;
        fW:
        $xI = '';
        $z_ = '';
        $zW = '';
        $Gx = '';
        $Jy = '';
        $UN = '';
        $ea = '';
        $tl = '';
        $RC = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\163\x61\155\x6c\137\x69\144\145\x6e\164\151\164\171\x5f\156\x61\x6d\x65"]) || $this->mo_saml_check_empty_or_null($_POST["\163\x61\155\x6c\x5f\x6c\x6f\x67\x69\x6e\137\165\162\154"]) || $this->mo_saml_check_empty_or_null($_POST["\163\x61\x6d\154\137\x69\x73\x73\x75\145\x72"])) {
            goto AG;
        }
        if (!preg_match("\57\136\x5c\x77\52\x24\57", $_POST["\163\x61\x6d\x6c\x5f\151\144\x65\x6e\x74\151\164\x79\x5f\x6e\141\155\x65"])) {
            goto Hm;
        }
        $xI = htmlspecialchars(trim($_POST["\x73\141\x6d\154\x5f\x69\x64\145\x6e\x74\151\x74\171\137\x6e\x61\x6d\x65"]));
        $zW = htmlspecialchars(trim($_POST["\163\141\x6d\154\x5f\154\157\147\151\x6e\x5f\x75\162\154"]));
        if (!array_key_exists("\x73\x61\155\154\x5f\x6c\157\x67\151\156\137\142\151\156\144\x69\156\x67\137\x74\x79\160\x65", $_POST)) {
            goto hs;
        }
        $z_ = htmlspecialchars($_POST["\163\141\155\x6c\x5f\154\x6f\147\x69\x6e\x5f\142\x69\x6e\x64\151\156\147\x5f\x74\171\x70\x65"]);
        hs:
        if (!array_key_exists("\x73\141\x6d\154\x5f\x6c\x6f\x67\157\165\x74\x5f\x62\151\x6e\144\x69\156\x67\x5f\x74\x79\x70\x65", $_POST)) {
            goto XO;
        }
        $Gx = htmlspecialchars($_POST["\163\x61\155\154\137\x6c\x6f\x67\x6f\165\x74\137\142\x69\x6e\x64\x69\156\147\137\164\x79\x70\145"]);
        XO:
        if (!array_key_exists("\x73\141\155\x6c\x5f\x6c\157\x67\157\x75\x74\137\x75\x72\154", $_POST)) {
            goto sA;
        }
        $Jy = htmlspecialchars(trim($_POST["\163\141\155\154\137\154\x6f\147\157\x75\164\x5f\165\162\x6c"]));
        sA:
        $UN = htmlspecialchars(trim($_POST["\x73\141\x6d\x6c\137\x69\x73\x73\x75\145\x72"]));
        $mL = htmlspecialchars(trim($_POST["\163\141\155\x6c\x5f\151\x64\145\156\x74\x69\164\x79\x5f\160\x72\157\x76\x69\144\x65\162\137\x67\x75\151\x64\x65\x5f\156\141\155\x65"]));
        $ea = maybe_unserialize($_POST["\163\x61\155\x6c\x5f\170\x35\60\x39\x5f\143\x65\162\164\151\x66\151\x63\141\x74\x65"]);
        $RC = htmlspecialchars($_POST["\163\141\x6d\x6c\137\x6e\141\155\145\x69\x64\137\x66\157\x72\155\x61\164"]);
        goto Au;
        Hm:
        update_site_option("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\155\x65\163\163\141\x67\145", "\120\154\145\x61\163\x65\x20\155\141\x74\x63\150\40\x74\x68\x65\x20\x72\145\161\165\x65\x73\x74\x65\x64\x20\146\x6f\x72\x6d\141\x74\x20\146\157\x72\x20\111\x64\145\156\164\x69\164\x79\x20\x50\162\157\x76\x69\144\145\162\40\116\x61\155\145\56\40\x4f\x6e\154\x79\x20\141\x6c\x70\x68\141\142\145\164\x73\x2c\x20\156\165\x6d\x62\145\x72\163\x20\x61\156\144\40\x75\156\144\145\x72\x73\x63\x6f\162\145\40\x69\163\40\141\154\154\x6f\167\145\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        Au:
        goto bo;
        AG:
        update_site_option("\155\157\x5f\x73\x61\155\x6c\137\x6d\x65\163\163\x61\147\145", "\x41\154\154\40\x74\x68\145\x20\146\x69\x65\x6c\144\163\x20\141\162\145\40\x72\145\x71\x75\x69\162\x65\144\56\40\120\154\x65\x61\x73\x65\x20\145\x6e\x74\x65\x72\x20\x76\x61\x6c\151\x64\x20\145\156\164\x72\x69\145\x73\56");
        $this->mo_saml_show_error_message();
        return;
        bo:
        update_site_option("\163\x61\x6d\x6c\137\151\x64\x65\156\164\151\164\171\x5f\156\x61\155\145", $xI);
        update_site_option("\163\141\x6d\x6c\x5f\x6c\157\147\x69\156\137\x62\151\x6e\144\x69\x6e\147\137\164\171\160\145", $z_);
        update_site_option("\163\x61\x6d\x6c\x5f\x6c\x6f\x67\x69\156\x5f\x75\x72\154", $zW);
        update_site_option("\x73\141\155\x6c\137\154\x6f\147\x6f\165\164\x5f\142\x69\156\144\151\x6e\x67\x5f\164\171\x70\x65", $Gx);
        update_site_option("\163\x61\x6d\154\x5f\x6c\157\147\157\x75\x74\137\165\162\154", $Jy);
        update_site_option("\163\x61\155\x6c\137\x69\163\x73\165\145\x72", $UN);
        update_site_option("\163\141\x6d\154\x5f\156\x61\155\x65\151\144\137\x66\157\162\155\x61\x74", $RC);
        update_site_option("\x73\x61\x6d\154\137\151\144\145\x6e\164\x69\164\x79\x5f\x70\x72\x6f\x76\x69\144\x65\162\137\147\165\x69\144\145\137\156\141\155\145", $mL);
        if (isset($_POST["\163\141\155\x6c\137\162\x65\x71\165\145\x73\164\x5f\x73\151\147\156\145\x64"])) {
            goto hJ;
        }
        update_site_option("\x73\141\x6d\154\137\162\145\161\x75\x65\x73\164\x5f\163\x69\147\156\145\x64", "\165\x6e\143\x68\x65\x63\153\x65\144");
        goto fb;
        hJ:
        update_site_option("\x73\141\x6d\x6c\x5f\x72\145\x71\165\x65\x73\x74\x5f\x73\151\147\x6e\145\144", "\x63\x68\x65\x63\153\145\x64");
        fb:
        foreach ($ea as $FE => $Ng) {
            if (empty($Ng)) {
                goto Nb;
            }
            $ea[$FE] = Utilities::sanitize_certificate($Ng);
            if (@openssl_x509_read($ea[$FE])) {
                goto g5;
            }
            update_site_option("\x6d\x6f\137\x73\141\155\154\x5f\x6d\145\163\x73\141\x67\145", "\111\156\x76\x61\154\x69\144\40\x63\145\162\x74\x69\146\151\143\x61\164\145\40\146\157\162\155\x61\164\72\x50\x6c\145\x61\163\145\x20\x70\162\x6f\x76\x69\144\x65\x20\x61\x20\166\141\x6c\x69\x64\x20\143\145\162\x74\151\146\x69\x63\141\164\x65");
            $this->mo_saml_show_error_message();
            delete_site_option("\x73\141\x6d\x6c\x5f\x78\65\60\71\137\143\x65\x72\164\x69\x66\x69\143\141\164\x65");
            return;
            g5:
            goto NL;
            Nb:
            unset($ea[$FE]);
            NL:
            nZ:
        }
        W2:
        if (!empty($ea)) {
            goto yy;
        }
        update_site_option("\155\157\137\163\x61\155\154\x5f\155\x65\163\163\x61\147\x65", "\111\156\x76\141\x6c\x69\x64\x20\143\145\162\x74\x69\146\x69\x63\x61\x74\x65\40\146\x6f\x72\x6d\x61\164\40\72\x20\x50\x6c\145\x61\163\145\x20\160\x72\x6f\x76\151\144\145\40\x61\40\143\145\162\x74\x69\x66\151\143\141\x74\145");
        $this->mo_saml_show_error_message();
        return;
        yy:
        if (isset($_POST["\x73\141\x6d\x6c\x5f\x72\x65\163\160\157\x6e\x73\145\x5f\163\x69\147\156\145\144"])) {
            goto GI;
        }
        update_site_option("\163\141\155\x6c\137\162\145\x73\x70\x6f\x6e\163\145\x5f\163\x69\147\x6e\x65\144", "\x59\145\x73");
        goto GM;
        GI:
        update_site_option("\x73\x61\155\x6c\x5f\x72\x65\x73\160\x6f\x6e\163\x65\137\x73\x69\147\156\x65\144", "\143\x68\145\143\153\x65\144");
        GM:
        if (isset($_POST["\x73\x61\155\x6c\137\141\163\x73\x65\x72\164\x69\x6f\156\x5f\163\151\x67\156\145\144"])) {
            goto kt;
        }
        update_site_option("\163\x61\x6d\x6c\137\141\x73\x73\x65\162\164\151\x6f\156\x5f\x73\x69\x67\x6e\145\144", "\131\145\x73");
        goto vc;
        kt:
        update_site_option("\163\x61\155\x6c\137\x61\x73\163\145\162\164\x69\x6f\156\x5f\x73\x69\x67\156\145\x64", "\143\x68\145\143\x6b\145\x64");
        vc:
        update_site_option("\x73\141\x6d\x6c\x5f\x78\x35\x30\x39\137\143\145\x72\x74\x69\146\x69\143\141\x74\145", $ea);
        if (array_key_exists("\x65\156\141\x62\154\x65\137\151\143\x6f\156\166", $_POST)) {
            goto KJ;
        }
        update_site_option("\155\157\137\163\141\155\x6c\137\145\156\143\157\x64\x69\x6e\147\137\145\156\x61\x62\x6c\145\144", '');
        goto hk;
        KJ:
        update_site_option("\x6d\157\x5f\x73\x61\x6d\154\137\145\156\143\157\144\151\156\147\137\145\x6e\141\142\154\145\144", "\x63\150\145\x63\153\145\x64");
        hk:
        update_site_option("\155\x6f\x5f\163\x61\155\x6c\x5f\x6d\x65\x73\163\x61\x67\x65", "\x49\144\145\156\164\x69\x74\x79\40\x50\162\157\x76\151\144\x65\x72\x20\144\145\164\141\x69\154\163\x20\x73\141\x76\x65\x64\x20\x73\165\143\x63\x65\163\x73\x66\165\x6c\154\171\x2e");
        $this->mo_saml_show_success_message();
        nH:
        if (!self::mo_check_option_admin_referer("\x6c\157\147\x69\156\137\x77\x69\144\x67\145\164\137\163\141\x6d\x6c\x5f\x64\x6f\155\141\151\156\137\x6d\141\160\x70\x69\156\x67")) {
            goto Vv;
        }
        $Y1 = array();
        $xI = get_site_option("\x73\x61\x6d\x6c\x5f\x69\144\145\156\x74\151\x74\x79\x5f\156\141\x6d\x65");
        $FE = "\163\x61\155\x6c\x5f\144\157\155\141\x69\x6e\x5f\x6d\141\160\x70\151\156\x67\x5f" . $xI;
        $Y1[$xI] = !empty($_POST[$FE]) ? stripslashes($_POST[$FE]) : '';
        update_site_option("\163\141\x6d\x6c\x5f\151\x64\160\x5f\x64\x6f\155\x61\x69\x6e\x5f\155\x61\x70\x70\151\x6e\x67", $Y1);
        update_site_option("\155\x6f\137\x73\x61\155\154\137\x6d\x65\163\x73\x61\147\x65", "\104\157\155\x61\x69\156\x20\115\141\160\x70\151\156\147\40\x64\145\x74\141\151\154\163\40\163\x61\166\145\144\40\163\x75\143\143\x65\163\x73\x66\x75\154\154\x79\56");
        $this->mo_saml_show_success_message();
        Vv:
        if (!self::mo_check_option_admin_referer("\x6c\157\147\x69\x6e\x5f\167\x69\x64\x67\145\x74\137\x73\141\x6d\154\x5f\141\164\x74\x72\151\142\165\164\145\137\x6d\141\160\x70\151\156\147")) {
            goto NH;
        }
        if (mo_saml_is_extension_installed("\x63\165\162\x6c")) {
            goto A3;
        }
        update_site_option("\155\x6f\137\163\141\x6d\x6c\137\155\145\163\x73\x61\x67\145", "\105\x52\x52\x4f\122\72\x20\x3c\141\x20\150\162\145\146\75\x22\150\164\164\160\x3a\x2f\x2f\160\150\160\56\x6e\x65\164\x2f\x6d\141\156\165\x61\154\57\x65\156\57\x63\165\x72\x6c\x2e\x69\156\163\164\x61\154\x6c\141\x74\x69\x6f\156\56\160\x68\x70\x22\x20\164\x61\x72\x67\145\x74\75\42\x5f\x62\154\141\156\x6b\x22\x3e\120\110\120\x20\143\x55\x52\x4c\x20\145\170\164\145\156\163\151\157\x6e\74\57\x61\76\x20\151\163\40\x6e\x6f\x74\x20\x69\156\163\x74\x61\x6c\154\x65\x64\x20\x6f\x72\40\x64\151\163\x61\x62\154\145\x64\x2e\40\123\x61\166\x65\40\x41\164\x74\x72\151\142\x75\x74\145\40\x4d\x61\x70\x70\x69\x6e\147\40\x66\141\151\154\x65\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        A3:
        update_site_option("\x73\x61\x6d\x6c\137\x61\155\x5f\165\163\145\x72\x6e\141\x6d\x65", htmlspecialchars(stripslashes($_POST["\x73\141\155\x6c\137\x61\155\x5f\165\163\x65\x72\x6e\141\155\x65"])));
        update_site_option("\163\x61\x6d\x6c\x5f\141\155\x5f\x65\x6d\141\x69\x6c", htmlspecialchars(stripslashes($_POST["\163\x61\x6d\154\x5f\x61\155\x5f\x65\x6d\141\151\154"])));
        update_site_option("\x73\x61\155\154\x5f\141\x6d\x5f\146\x69\x72\x73\x74\x5f\156\141\155\145", htmlspecialchars(stripslashes($_POST["\163\x61\155\x6c\x5f\x61\155\137\146\151\x72\x73\164\x5f\156\141\x6d\145"])));
        update_site_option("\163\x61\x6d\154\137\141\x6d\x5f\x6c\x61\x73\x74\x5f\x6e\x61\155\145", htmlspecialchars(stripslashes($_POST["\163\x61\155\154\x5f\x61\x6d\137\154\x61\163\164\x5f\156\x61\x6d\145"])));
        update_site_option("\x73\x61\155\154\137\x61\x6d\137\147\162\x6f\165\x70\137\x6e\141\155\145", htmlspecialchars(stripslashes($_POST["\163\x61\155\154\137\x61\x6d\x5f\x67\162\x6f\165\160\x5f\156\141\155\x65"])));
        update_site_option("\163\141\x6d\x6c\x5f\141\155\x5f\x64\151\x73\x70\154\141\171\137\x6e\x61\155\x65", htmlspecialchars(stripslashes($_POST["\163\141\155\x6c\137\x61\155\137\144\x69\163\x70\154\141\x79\x5f\156\141\x6d\x65"])));
        $NW = array();
        $b3 = array();
        $ga = array();
        $hh = array();
        if (!(isset($_POST["\x6d\157\137\x73\x61\x6d\x6c\x5f\143\165\x73\x74\x6f\155\x5f\141\164\164\x72\151\x62\x75\164\145\137\x6b\x65\x79\163"]) && !empty($_POST["\x6d\157\137\x73\x61\x6d\x6c\137\x63\x75\163\164\157\155\x5f\141\164\x74\x72\151\x62\165\164\x65\137\153\x65\171\x73"]))) {
            goto jh;
        }
        $b3 = $_POST["\x6d\x6f\137\x73\141\155\154\x5f\143\165\x73\164\157\x6d\137\141\164\x74\x72\151\x62\165\164\x65\137\153\x65\171\163"];
        jh:
        if (!(isset($_POST["\x6d\x6f\x5f\x73\141\x6d\154\x5f\143\165\x73\164\157\x6d\137\x61\x74\x74\162\151\x62\x75\164\145\137\166\x61\x6c\x75\x65\x73"]) && !empty($_POST["\155\x6f\137\163\141\x6d\x6c\137\143\x75\163\x74\157\155\137\x61\164\164\162\151\x62\x75\x74\145\137\166\x61\x6c\x75\x65\x73"]))) {
            goto Yw;
        }
        $ga = $_POST["\155\x6f\137\163\x61\x6d\154\137\143\x75\163\164\157\x6d\137\x61\164\x74\x72\x69\142\x75\164\x65\x5f\x76\141\x6c\x75\145\163"];
        Yw:
        $gw = count($b3);
        if (!($gw > 0)) {
            goto i2;
        }
        $b3 = array_map("\x68\x74\x6d\x6c\x73\x70\x65\x63\x69\141\154\143\x68\141\162\163", $b3);
        $ga = array_map("\150\164\155\154\x73\x70\145\143\x69\141\154\143\150\141\x72\x73", $ga);
        $mZ = 0;
        Yf:
        if (!($mZ < $gw)) {
            goto Rp;
        }
        if (!(isset($_POST["\x6d\x6f\x5f\163\141\x6d\154\137\144\151\x73\x70\154\x61\x79\137\x61\164\x74\162\151\x62\165\164\x65\137" . $mZ]) && !empty($_POST["\155\x6f\137\163\x61\x6d\154\137\144\x69\x73\x70\x6c\141\x79\x5f\x61\164\164\162\x69\x62\165\164\x65\137" . $mZ]))) {
            goto nE;
        }
        array_push($hh, $mZ);
        nE:
        $mZ++;
        goto Yf;
        Rp:
        i2:
        update_site_option("\x73\x61\x6d\154\137\163\150\x6f\x77\x5f\x75\163\145\x72\137\141\x74\x74\x72\x69\x62\x75\164\x65", $hh);
        $NW = array_combine($b3, $ga);
        $NW = array_filter($NW);
        if (!empty($NW)) {
            goto qF;
        }
        $NW = get_site_option("\x6d\157\x5f\163\141\x6d\154\x5f\x63\x75\163\164\x6f\155\x5f\141\x74\x74\x72\163\x5f\x6d\141\x70\160\x69\156\147");
        if (empty($NW)) {
            goto M_;
        }
        delete_site_option("\155\x6f\137\163\141\x6d\154\x5f\143\165\x73\164\x6f\x6d\137\141\164\164\x72\x73\137\155\x61\x70\x70\x69\x6e\147");
        M_:
        goto XK;
        qF:
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\137\143\165\163\x74\x6f\x6d\137\141\164\x74\162\163\137\155\141\x70\x70\151\x6e\x67", $NW);
        XK:
        update_site_option("\155\x6f\137\x73\141\x6d\154\137\155\145\163\163\141\x67\145", "\x41\x74\x74\x72\151\142\165\x74\x65\x20\x4d\141\x70\160\x69\156\x67\x20\x64\145\164\141\151\x6c\163\40\x73\x61\166\145\x64\x20\163\165\x63\143\145\163\163\146\x75\154\x6c\x79");
        $this->mo_saml_show_success_message();
        NH:
        if (!self::mo_check_option_admin_referer("\x63\154\145\141\162\x5f\x61\x74\x74\162\163\137\154\151\x73\164")) {
            goto gT;
        }
        delete_site_option("\155\x6f\x5f\x73\x61\155\154\137\x74\x65\163\x74\137\143\157\156\x66\151\147\137\141\x74\164\162\163");
        update_site_option("\155\157\137\163\141\155\154\x5f\x6d\145\163\x73\141\147\x65", "\101\x74\x74\162\x69\x62\x75\x74\x65\163\40\x6c\x69\x73\x74\x20\x72\145\x6d\157\166\x65\144\40\x73\x75\143\x63\145\x73\163\146\x75\154\154\171");
        $this->mo_saml_show_success_message();
        gT:
        if (!self::mo_check_option_admin_referer("\163\x61\x6d\x6c\x5f\146\157\x72\x6d\x5f\x64\157\155\x61\x69\x6e\x5f\x72\x65\163\164\x72\151\x63\x74\x69\x6f\156\x5f\x6f\160\x74\x69\x6f\156")) {
            goto Kc;
        }
        $XS = isset($_POST["\155\x6f\x5f\163\x61\x6d\154\137\145\x6e\141\142\x6c\x65\137\x64\157\x6d\141\x69\156\x5f\162\145\163\164\162\x69\x63\x74\151\x6f\156\x5f\x6c\x6f\x67\151\156"]) && !empty($_POST["\x6d\157\x5f\163\141\x6d\x6c\x5f\145\156\x61\142\154\x65\x5f\x64\x6f\x6d\141\x69\x6e\137\162\145\163\x74\x72\151\143\164\x69\x6f\x6e\137\154\x6f\147\x69\x6e"]) ? htmlspecialchars($_POST["\x6d\157\x5f\163\141\x6d\x6c\x5f\x65\x6e\141\x62\154\x65\137\x64\x6f\x6d\x61\151\156\137\x72\145\x73\164\162\x69\x63\x74\x69\157\x6e\137\154\157\147\151\156"]) : '';
        $D0 = isset($_POST["\155\x6f\137\163\141\x6d\154\137\x61\x6c\x6c\157\x77\x5f\144\x65\x6e\x79\x5f\165\x73\145\x72\x5f\167\x69\x74\150\137\144\x6f\x6d\141\151\x6e"]) && !empty($_POST["\155\x6f\x5f\x73\141\155\x6c\x5f\x61\154\x6c\x6f\x77\137\144\145\156\171\x5f\165\163\145\162\x5f\167\151\x74\150\x5f\144\x6f\x6d\x61\151\156"]) ? htmlspecialchars($_POST["\x6d\157\137\x73\141\x6d\154\x5f\141\154\x6c\157\167\x5f\x64\x65\156\171\x5f\165\163\145\x72\137\167\x69\164\x68\137\144\157\x6d\141\151\156"]) : "\x61\x6c\154\157\x77";
        $sn = isset($_POST["\163\141\x6d\154\137\x61\155\137\145\155\141\151\x6c\x5f\x64\157\x6d\x61\x69\156\163"]) && !empty($_POST["\x73\x61\155\154\x5f\141\x6d\137\145\155\x61\151\x6c\137\x64\157\x6d\x61\x69\x6e\x73"]) ? htmlspecialchars($_POST["\163\x61\155\154\137\141\x6d\137\145\155\141\x69\154\137\144\157\155\141\151\156\163"]) : '';
        update_site_option("\x6d\157\137\163\141\x6d\154\137\x65\x6e\141\x62\154\x65\137\x64\x6f\x6d\x61\x69\x6e\x5f\x72\145\x73\x74\x72\x69\143\164\x69\157\156\137\x6c\157\x67\151\156", $XS);
        update_site_option("\155\x6f\x5f\x73\141\155\154\137\x61\x6c\154\157\x77\137\x64\x65\156\x79\x5f\x75\163\x65\162\137\x77\x69\164\x68\137\x64\x6f\155\x61\151\156", $D0);
        update_site_option("\x73\x61\155\x6c\137\x61\155\137\145\x6d\x61\x69\154\137\x64\157\x6d\141\x69\156\x73", $sn);
        update_site_option("\155\x6f\x5f\x73\x61\155\154\x5f\155\x65\163\x73\x61\147\145", "\104\x6f\x6d\x61\151\156\40\x52\145\x73\164\162\x69\x63\x74\151\157\156\x20\150\x61\x73\40\x62\x65\x65\156\x20\163\141\x76\x65\x64\x20\x73\165\143\x63\145\163\x73\x66\165\x6c\154\171\56");
        $this->mo_saml_show_success_message();
        Kc:
        if (!self::mo_check_option_admin_referer("\x6c\x6f\x67\x69\x6e\x5f\167\x69\x64\x67\x65\x74\137\163\141\x6d\x6c\137\x72\157\154\x65\x5f\x6d\x61\160\x70\x69\x6e\x67")) {
            goto FB;
        }
        if (mo_saml_is_extension_installed("\x63\165\162\154")) {
            goto e8;
        }
        update_site_option("\x6d\x6f\x5f\163\x61\x6d\154\137\155\x65\x73\x73\141\x67\145", "\x45\122\x52\x4f\x52\72\40\74\x61\40\x68\162\x65\146\x3d\42\x68\164\164\x70\72\x2f\57\160\150\160\x2e\156\145\164\57\x6d\x61\x6e\165\x61\x6c\x2f\145\156\57\x63\x75\x72\x6c\56\151\156\x73\x74\x61\x6c\154\141\x74\x69\157\x6e\x2e\160\150\x70\42\40\164\141\x72\147\x65\164\75\x22\x5f\142\x6c\141\156\x6b\x22\76\120\110\x50\x20\143\125\x52\114\x20\x65\170\x74\x65\x6e\x73\x69\157\156\x3c\57\141\76\40\151\x73\40\156\x6f\x74\x20\x69\156\x73\x74\141\x6c\154\x65\144\x20\157\162\x20\x64\x69\163\x61\142\154\145\x64\x2e\40\123\x61\x76\x65\x20\122\157\154\x65\x20\x4d\x61\160\160\x69\156\x67\x20\146\141\151\154\145\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        e8:
        if (isset($_POST["\x6d\157\137\x61\160\160\x6c\171\x5f\162\157\x6c\x65\x5f\x6d\141\160\x70\x69\x6e\x67\x5f\146\x6f\162\137\163\x69\164\x65\163"]) && $_POST["\155\157\x5f\x61\160\160\154\171\137\x72\x6f\x6c\x65\137\x6d\x61\x70\x70\151\156\147\x5f\146\157\x72\x5f\163\151\x74\145\x73"] == 0) {
            goto yU;
        }
        if (!(isset($_POST["\x6d\157\x5f\141\160\x70\x6c\171\x5f\162\157\x6c\x65\x5f\155\x61\x70\160\x69\x6e\147\x5f\146\157\162\x5f\x73\x69\164\x65\163"]) && $_POST["\155\157\x5f\x61\x70\160\154\171\x5f\x72\157\154\x65\x5f\x6d\x61\x70\160\x69\x6e\x67\x5f\146\x6f\162\137\163\x69\x74\145\x73"] == 1)) {
            goto wK;
        }
        update_site_option("\155\157\137\141\x70\160\x6c\x79\137\x72\x6f\x6c\x65\137\155\141\160\160\x69\x6e\x67\137\146\157\x72\x5f\163\151\164\x65\x73", 1);
        $HC = 0;
        $fn = array();
        update_site_option("\x73\141\x6d\154\x5f\x61\x6d\x5f\162\157\154\x65\137\x6d\x61\160\160\151\x6e\x67", $fn);
        wK:
        goto L2;
        yU:
        if (!$this->mo_saml_check_empty_or_null($_POST["\x72\x6f\154\145\137\155\x61\x70\x70\x69\156\147\137\163\x69\164\x65"])) {
            goto pH;
        }
        update_site_option("\155\x6f\x5f\x73\x61\155\x6c\137\x6d\x65\x73\163\141\x67\145", "\120\x6c\145\141\x73\x65\x20\x73\145\154\145\x63\x74\40\x61\x20\163\151\x74\145\x20\164\x6f\40\163\141\166\145\40\x72\x6f\154\x65\40\x6d\141\160\x70\151\x6e\147");
        $this->mo_saml_show_error_message();
        return;
        pH:
        update_site_option("\x6d\x6f\137\141\x70\160\x6c\x79\x5f\x72\157\x6c\x65\137\x6d\141\x70\160\151\x6e\147\x5f\x66\x6f\162\137\163\151\x74\145\x73", 0);
        $HC = htmlspecialchars($_POST["\162\157\x6c\x65\x5f\155\x61\x70\160\x69\x6e\147\137\163\x69\164\x65"]);
        L2:
        if (!isset($_POST["\163\x61\155\154\137\x61\155\137\144\145\146\x61\165\x6c\164\x5f\x75\x73\145\162\137\162\157\154\x65"])) {
            goto WT;
        }
        $Hd = htmlspecialchars($_POST["\x73\x61\155\154\137\141\x6d\x5f\144\x65\146\x61\165\x6c\164\x5f\x75\163\145\162\x5f\x72\x6f\x6c\145"]);
        WT:
        if (isset($_POST["\x73\141\155\x6c\137\x61\x6d\137\x64\x6f\x6e\164\x5f\141\154\x6c\x6f\167\x5f\x75\x6e\154\151\x73\164\145\x64\137\x75\163\x65\162\x5f\x72\157\154\x65"])) {
            goto wS;
        }
        $qh = "\x75\156\x63\x68\x65\x63\153\x65\144";
        goto O5;
        wS:
        $qh = "\143\150\x65\x63\x6b\x65\144";
        $Hd = false;
        O5:
        if (isset($_POST["\x6d\x6f\137\163\141\x6d\x6c\137\x64\157\156\x74\x5f\143\x72\145\141\164\145\x5f\165\x73\145\162\137\x69\x66\137\162\157\154\x65\137\156\157\164\137\155\x61\x70\x70\145\144"])) {
            goto dh;
        }
        $AD = "\165\156\x63\150\145\x63\x6b\x65\144";
        goto a1;
        dh:
        $AD = "\143\x68\145\x63\153\x65\144";
        $qh = "\165\x6e\x63\x68\x65\x63\x6b\x65\144";
        $Hd = false;
        a1:
        if (isset($_POST["\x6d\157\137\163\x61\x6d\154\x5f\x6b\x65\x65\160\137\145\170\151\x73\164\151\156\x67\137\x75\x73\145\x72\163\137\x72\157\154\145"])) {
            goto JD;
        }
        $nf = "\x75\x6e\143\150\x65\143\153\x65\x64";
        goto Wh;
        JD:
        $nf = "\143\x68\145\x63\x6b\x65\144";
        Wh:
        if (isset($_POST["\x6d\x6f\x5f\x73\x61\x6d\154\137\144\x6f\156\x74\137\x61\154\x6c\157\167\x5f\x75\163\145\x72\x5f\164\x6f\154\x6f\x67\151\x6e\x5f\143\162\145\x61\x74\145\x5f\x77\151\x74\x68\137\x67\x69\x76\x65\x6e\137\147\x72\x6f\165\160\x73"])) {
            goto qW;
        }
        $Z4 = "\x75\156\143\x68\145\143\x6b\x65\x64";
        goto I7;
        qW:
        $Z4 = "\143\x68\145\143\x6b\x65\144";
        I7:
        if (!isset($_POST["\155\x6f\137\x73\x61\x6d\x6c\137\162\145\163\164\162\151\143\x74\137\165\x73\145\x72\163\x5f\x77\x69\164\150\137\x67\162\x6f\165\160\163"])) {
            goto G6;
        }
        $Y5 = htmlspecialchars($_POST["\x6d\x6f\x5f\x73\141\x6d\154\137\162\x65\x73\164\x72\151\x63\164\x5f\165\x73\x65\x72\x73\137\167\151\164\x68\x5f\x67\x72\x6f\165\160\x73"]);
        G6:
        if (!isset($_POST["\163\141\155\x6c\x5f\141\155\137\x67\162\x6f\165\160\137\x61\164\164\x72\x5f\166\x61\x6c\165\145\x73\x5f\163\165\160\145\x72\x61\144\155\x69\156"])) {
            goto Hy;
        }
        $f2 = htmlspecialchars($_POST["\163\x61\155\x6c\137\141\155\137\x67\162\157\165\160\137\141\164\164\162\x5f\x76\x61\x6c\165\145\x73\137\x73\x75\160\x65\162\x61\144\155\x69\156"]);
        Hy:
        $wp_roles = new WP_Roles($HC);
        $zK = $wp_roles->get_names();
        $fn = maybe_unserialize(get_site_option("\163\141\x6d\154\x5f\x61\x6d\137\x72\x6f\x6c\x65\137\155\x61\160\160\151\x6e\x67"));
        foreach ($zK as $Fi => $di) {
            $ox = "\163\x61\155\154\x5f\141\155\137\147\162\x6f\x75\x70\x5f\x61\164\164\162\x5f\166\141\154\x75\x65\163\x5f" . $Fi;
            $fn[$HC][$Fi] = stripslashes($_POST[$ox]);
            Dl:
        }
        jG:
        $fn[$HC]["\x64\145\x66\x61\165\154\x74\x5f\x72\157\154\145"] = $Hd;
        $fn[$HC]["\x64\157\156\164\137\x63\x72\145\141\x74\145\x5f\x75\x73\x65\162"] = $AD;
        $fn[$HC]["\144\157\x6e\x74\137\x61\154\x6c\157\167\x5f\x75\x6e\x6c\151\163\x74\145\144\137\165\163\145\162"] = $qh;
        $fn[$HC]["\153\145\x65\160\137\145\x78\x69\163\x74\x69\x6e\x67\137\165\x73\x65\162\x73\x5f\162\157\154\145"] = $nf;
        $fn[$HC]["\x6d\157\137\163\141\155\x6c\x5f\x64\157\156\164\x5f\141\154\x6c\157\167\137\165\x73\145\162\x5f\x74\157\x6c\157\147\151\x6e\137\x63\x72\x65\141\x74\145\137\167\x69\164\150\x5f\147\x69\x76\x65\156\x5f\147\x72\x6f\165\160\x73"] = $Z4;
        $fn[$HC]["\155\157\137\163\x61\x6d\154\137\162\145\163\x74\162\x69\143\164\x5f\165\x73\145\162\163\137\x77\x69\x74\x68\137\147\162\x6f\165\160\163"] = $Y5;
        $fn = array_filter($fn, "\146\x69\154\164\145\x72\137\145\155\x70\164\171\137\166\141\x6c\x75\145\x73");
        $CR = false;
        if (!(isset($_POST["\155\x6f\x5f\163\141\155\154\x5f\144\x69\163\141\x62\x6c\x65\137\x72\157\x6c\x65\x5f\155\x61\160\x70\151\x6e\147"]) and $_POST["\155\157\137\163\141\x6d\x6c\137\144\x69\x73\x61\142\154\145\x5f\162\157\154\x65\137\155\x61\160\160\151\x6e\x67"] == "\164\x72\x75\x65")) {
            goto dD;
        }
        $CR = true;
        dD:
        update_site_option("\x6d\157\x5f\163\141\155\x6c\137\144\151\x73\x61\142\154\145\x5f\x72\157\x6c\x65\x5f\x6d\x61\x70\x70\x69\x6e\x67", $CR);
        update_site_option("\x73\x61\155\x6c\137\141\155\137\162\157\154\145\x5f\155\x61\x70\160\151\156\x67", $fn);
        update_site_option("\x6d\x6f\137\x73\x61\155\x6c\137\155\x65\163\163\141\147\x65", "\x52\157\x6c\x65\x20\x4d\x61\160\160\x69\156\x67\40\144\x65\164\141\x69\154\x73\x20\163\x61\166\x65\144\x20\163\x75\x63\143\x65\163\x73\x66\165\x6c\x6c\x79\x2e");
        update_site_option("\155\157\137\x73\141\x6d\x6c\x5f\x73\165\160\x65\162\137\141\x64\x6d\x69\156\x5f\x72\x6f\154\145\137\155\x61\160\x70\151\156\x67", $f2);
        $this->mo_saml_show_success_message();
        FB:
        if (!self::mo_check_option_admin_referer("\155\x6f\137\x73\x61\x6d\x6c\x5f\163\165\142\x73\151\x74\x65\137\x73\145\x6c\x65\143\x74\x69\x6f\156\137\146\x6f\x72\x5f\162\157\154\145\137\x6d\141\160\x70\151\x6e\147")) {
            goto oD;
        }
        $tG = isset($_POST["\155\x6f\x5f\x61\x70\x70\154\x79\137\162\157\154\145\x5f\155\141\x70\x70\151\156\147\137\146\157\x72\137\163\x69\x74\x65\163"]) ? htmlspecialchars($_POST["\155\x6f\x5f\141\160\160\154\x79\x5f\162\157\154\145\x5f\x6d\x61\x70\x70\x69\x6e\x67\x5f\x66\x6f\162\x5f\163\x69\164\x65\x73"]) : 0;
        $so = isset($_POST["\x72\x6f\154\145\137\155\141\160\160\x69\156\147\137\163\151\x74\x65"]) ? htmlspecialchars($_POST["\x72\x6f\154\145\137\x6d\141\160\160\x69\x6e\147\137\163\151\x74\x65"]) : false;
        update_site_option("\162\x6f\154\x65\137\x6d\141\x70\x70\151\156\147\137\x73\x69\164\145", $so);
        update_site_option("\155\157\x5f\x61\160\160\154\171\x5f\162\157\x6c\x65\137\x6d\x61\x70\x70\151\x6e\x67\x5f\146\157\162\x5f\163\151\x74\145\163", $tG);
        oD:
        if (!self::mo_check_option_admin_referer("\155\157\x5f\x73\141\155\x6c\137\x72\145\x73\145\164\x5f\162\x6f\x6c\145\x5f\x6d\x61\x70\x70\151\156\147\137\141\164\164\x72\x69\x62\x75\x74\145\163")) {
            goto d0;
        }
        update_site_option("\155\x6f\x5f\141\x70\160\154\171\137\x72\x6f\x6c\x65\137\x6d\141\x70\x70\151\156\x67\137\x66\157\x72\137\163\151\x74\145\163", 0);
        $fn = array();
        update_site_option("\x73\x61\x6d\154\137\141\155\137\162\x6f\x6c\x65\x5f\x6d\x61\160\160\x69\156\147", $fn);
        update_site_option("\x6d\x6f\x5f\x73\x61\x6d\154\137\163\x75\160\x65\162\137\141\144\155\151\156\137\162\157\x6c\x65\x5f\155\x61\160\160\x69\156\147", '');
        update_site_option("\155\x6f\137\163\x61\155\x6c\x5f\x6d\145\163\163\x61\x67\x65", "\122\157\154\x65\40\x4d\x61\x70\160\x69\x6e\147\40\150\x61\163\x20\x62\145\x65\156\40\162\x65\x73\x65\x74\x20\163\165\143\143\145\163\163\x66\165\x6c\x6c\171\x2e");
        $this->mo_saml_show_success_message();
        d0:
        if (!self::mo_check_option_admin_referer("\155\x6f\137\x73\141\155\x6c\137\162\145\x73\145\164\137\163\x73\x6f\x5f\163\145\x74\x74\x69\x6e\x67\163\x5f\x6f\160\x74\151\157\156")) {
            goto kC;
        }
        $A7 = array();
        update_site_option("\163\141\155\x6c\x5f\163\x73\x6f\137\163\145\x74\x74\151\156\147\x73", $A7);
        update_site_option("\x6d\157\137\x73\x61\155\154\x5f\x6d\145\x73\x73\141\147\x65", "\123\x53\117\x20\123\x65\x74\164\x69\x6e\147\x73\x20\x68\x61\163\x20\x62\x65\x65\156\40\x72\145\163\145\x74\40\163\x75\x63\143\x65\x73\x73\x66\165\x6c\154\171\40\146\x6f\x72\x20\x61\154\154\x20\x79\157\x75\162\40\x73\165\x62\x2d\x73\151\x74\x65\x73\x2e");
        $this->mo_saml_show_success_message();
        kC:
        if (!(isset($_POST["\x6f\160\164\x69\157\x6e"]) and $_POST["\x6f\160\x74\x69\157\156"] == "\155\157\x5f\x73\x61\x6d\154\137\165\160\x64\141\164\145\x5f\163\160\x5f\142\x61\163\x65\137\165\162\154\137\157\x70\164\151\157\156")) {
            goto qN;
        }
        if (!(isset($_POST["\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\x73\x70\137\142\141\x73\x65\137\x75\x72\154"]) && isset($_POST["\x6d\157\x5f\163\x61\155\154\137\163\x70\137\x65\156\x74\x69\x74\171\137\x69\x64"]))) {
            goto Qo;
        }
        $jt = sanitize_text_field($_POST["\155\157\x5f\x73\141\x6d\154\137\163\x70\x5f\x62\141\163\x65\137\165\x72\154"]);
        $N5 = sanitize_text_field($_POST["\155\x6f\x5f\163\x61\x6d\154\x5f\x73\160\137\145\156\x74\x69\164\x79\x5f\x69\x64"]);
        if (!(substr($jt, -1) == "\x2f")) {
            goto Pm;
        }
        $jt = substr($jt, 0, -1);
        Pm:
        update_site_option("\155\x6f\137\163\x61\x6d\154\x5f\x73\x70\137\x62\141\163\x65\x5f\165\162\x6c", $jt);
        update_site_option("\x6d\157\137\163\x61\155\x6c\x5f\x73\160\137\x65\156\164\x69\164\x79\x5f\151\x64", $N5);
        Qo:
        update_site_option("\x6d\x6f\x5f\163\x61\x6d\154\137\x6d\145\163\163\x61\147\145", "\123\120\40\102\x61\163\145\40\125\x52\114\40\x75\160\x64\141\164\145\144\x20\163\165\143\143\145\x73\163\x66\x75\154\154\171\x2e");
        $this->mo_saml_show_success_message();
        qN:
        if (!self::mo_check_option_admin_referer("\163\141\155\x6c\137\165\x70\x6c\x6f\141\x64\x5f\155\x65\x74\141\144\141\164\x61")) {
            goto OK;
        }
        if (!function_exists("\167\160\137\150\x61\x6e\x64\154\x65\x5f\x75\x70\154\157\x61\x64")) {
            require_once ABSPATH . "\167\160\55\x61\144\155\x69\x6e\57\x69\156\143\154\x75\x64\145\x73\57\146\x69\154\x65\56\x70\150\160";
        }
        $this->upload_metadata();
        OK:
        if (!self::mo_check_option_admin_referer("\155\157\137\x73\x61\x6d\x6c\x5f\x75\160\x64\141\164\145\x5f\x69\x64\160\137\163\x65\x74\164\151\x6e\x67\x73\x5f\x6f\160\x74\151\157\x6e")) {
            goto oz;
        }
        if (!(isset($_POST["\155\x6f\x5f\x73\x61\155\154\137\163\160\x5f\142\x61\x73\145\x5f\x75\x72\154"]) && isset($_POST["\155\x6f\137\x73\141\x6d\x6c\137\x73\160\137\x65\156\x74\151\164\x79\137\151\x64"]))) {
            goto RM;
        }
        $jt = sanitize_text_field($_POST["\155\157\137\163\x61\x6d\154\137\x73\160\137\142\x61\x73\x65\x5f\165\x72\x6c"]);
        $N5 = sanitize_text_field($_POST["\x6d\157\x5f\x73\141\x6d\154\137\x73\160\137\145\x6e\x74\x69\164\171\x5f\x69\144"]);
        if (!(substr($jt, -1) == "\57")) {
            goto W5;
        }
        $jt = substr($jt, 0, -1);
        W5:
        update_site_option("\x6d\157\137\x73\x61\x6d\154\x5f\163\x70\x5f\x62\x61\x73\x65\x5f\x75\162\x6c", $jt);
        update_site_option("\x6d\x6f\x5f\163\x61\x6d\x6c\137\x73\160\x5f\145\x6e\164\151\x74\171\x5f\151\x64", $N5);
        RM:
        update_site_option("\155\157\x5f\163\x61\155\x6c\x5f\155\145\x73\163\x61\x67\145", "\x53\145\164\164\x69\x6e\x67\163\40\x75\x70\x64\141\x74\145\144\x20\x73\x75\143\x63\x65\x73\163\146\x75\154\154\x79\56");
        $this->mo_saml_show_success_message();
        oz:
        if (!self::mo_check_option_admin_referer("\145\156\141\x62\x6c\x65\x5f\163\x73\x6f\137\x6e\x65\x77\x5f\x73\x69\164\145\x5f\x6f\x70\x74\x69\x6f\x6e")) {
            goto Pw;
        }
        if (isset($_POST["\x65\x6e\141\x62\154\145\137\x73\x73\157\x5f\x6e\x65\x77\137\x73\x69\164\145"]) and $_POST["\x65\x6e\x61\142\x6c\145\137\163\x73\x6f\137\x6e\145\167\x5f\x73\151\x74\x65"] == "\164\x72\165\145") {
            goto Yv;
        }
        $ow = "\x66\x61\x6c\163\x65";
        goto c0;
        Yv:
        $ow = "\164\x72\165\145";
        c0:
        update_site_option("\x6d\x6f\137\x73\x61\155\x6c\x5f\x65\156\x61\x62\154\x65\x5f\163\163\157\x5f\x6e\145\x77\x5f\x73\x69\164\145", $ow);
        update_site_option("\155\x6f\x5f\163\141\x6d\x6c\x5f\155\145\163\x73\x61\147\x65", "\x53\x65\x74\164\151\x6e\x67\163\40\x75\160\144\141\164\145\144\40\x73\x75\143\x63\145\x73\163\x66\165\154\x6c\171\x2e");
        $this->mo_saml_show_success_message();
        Pw:
        if (!self::mo_check_option_admin_referer("\x75\160\x67\162\141\x64\145\137\x63\x65\x72\x74")) {
            goto uJ;
        }
        $N1 = file_get_contents(plugin_dir_path(__FILE__) . "\x72\x65\x73\x6f\x75\x72\143\145\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Public_Certificate);
        $Og = file_get_contents(plugin_dir_path(__FILE__) . "\x72\x65\163\157\165\162\x63\x65\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Private_Key);
        update_site_option("\155\157\x5f\x73\141\x6d\x6c\137\143\165\x72\162\145\156\x74\137\x63\x65\x72\x74", $N1);
        update_site_option("\x6d\157\137\163\x61\x6d\154\x5f\x63\165\162\162\145\156\x74\137\143\145\x72\x74\137\x70\x72\151\166\x61\164\145\137\x6b\145\x79", $Og);
        update_site_option("\155\x6f\137\163\x61\155\154\137\x63\145\162\164\x69\146\x69\x63\141\x74\145\137\162\x6f\154\x6c\x5f\142\141\x63\x6b\137\x61\x76\141\151\154\141\142\x6c\x65", true);
        update_site_option("\x6d\x6f\x5f\x73\x61\x6d\x6c\137\x6d\145\163\163\141\x67\x65", "\x43\145\162\x74\x69\x66\151\143\141\x74\145\x20\x55\160\x67\162\141\x64\145\144\40\163\165\x63\x63\x65\163\163\146\x75\x6c\154\x79");
        $this->mo_saml_show_success_message();
        uJ:
        if (!self::mo_check_option_admin_referer("\x72\x6f\x6c\x6c\x62\x61\143\x6b\137\143\145\x72\164")) {
            goto xx;
        }
        $N1 = file_get_contents(plugin_dir_path(__FILE__) . "\x72\145\x73\157\165\x72\143\145\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Rollback_Public_Cert);
        $Og = file_get_contents(plugin_dir_path(__FILE__) . "\x72\145\x73\x6f\165\162\x63\145\163" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Rollback_Public_Key);
        update_site_option("\155\x6f\137\x73\141\x6d\x6c\x5f\143\165\162\162\145\156\164\x5f\143\x65\x72\x74", $N1);
        update_site_option("\x6d\157\137\163\141\155\154\137\x63\165\x72\x72\145\x6e\164\x5f\143\x65\162\164\x5f\x70\162\151\x76\x61\x74\x65\137\x6b\x65\x79", $Og);
        update_site_option("\x6d\x6f\137\163\x61\155\x6c\137\155\145\163\x73\141\x67\145", "\103\x65\162\164\x69\x66\x69\x63\x61\164\x65\40\122\157\x6c\x6c\x2d\142\x61\x63\x6b\x65\144\40\163\165\x63\143\x65\x73\163\x66\x75\x6c\x6c\171");
        delete_option("\155\157\137\163\x61\x6d\x6c\137\143\145\x72\x74\x69\146\151\x63\x61\164\145\137\162\x6f\154\x6c\x5f\x62\x61\143\x6b\x5f\x61\x76\x61\x69\154\x61\x62\x6c\x65");
        $this->mo_saml_show_success_message();
        xx:
        if (self::mo_check_option_admin_referer("\x61\144\x64\x5f\143\165\x73\x74\157\x6d\137\x63\145\x72\164\151\146\x69\143\141\164\145")) {
            goto aF;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\137\x73\x61\x6d\x6c\x5f\x72\145\155\157\166\x65\137\x61\143\x63\157\x75\x6e\164")) {
            goto EJ;
        }
        if (!self::mo_check_option_admin_referer("\x61\x64\144\x5f\x63\165\163\x74\x6f\155\137\x6d\145\x73\x73\141\147\x65\163")) {
            goto X8;
        }
        update_site_option("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\x61\143\x63\157\165\156\x74\x5f\143\162\x65\141\164\151\x6f\156\x5f\x64\x69\163\141\x62\x6c\145\144\x5f\155\163\x67", sanitize_text_field($_POST["\x6d\157\x5f\x73\141\155\154\x5f\x61\143\x63\157\165\x6e\164\137\x63\162\x65\141\164\151\x6f\x6e\x5f\x64\151\x73\x61\x62\x6c\x65\x64\137\x6d\x73\x67"]));
        update_site_option("\x6d\157\137\x73\141\x6d\x6c\x5f\162\145\x73\164\162\x69\143\164\145\x64\x5f\144\157\x6d\x61\151\156\137\x65\162\162\157\x72\x5f\155\163\147", sanitize_text_field($_POST["\155\157\x5f\x73\x61\x6d\154\137\162\145\163\x74\x72\x69\143\164\145\144\137\x64\157\x6d\x61\x69\156\137\x65\x72\162\x6f\x72\137\x6d\163\147"]));
        update_site_option("\x6d\157\x5f\x73\x61\x6d\x6c\x5f\x6d\x65\163\163\141\x67\145", "\x43\157\156\146\151\147\x75\x72\x61\164\151\x6f\156\40\x68\x61\x73\x20\x62\145\145\x6e\40\x73\x61\x76\x65\x64\40\x73\165\143\x63\x65\163\163\x66\x75\154\x6c\x79\56");
        $this->mo_saml_show_success_message();
        X8:
        goto sw;
        EJ:
        $this->mo_sso_saml_deactivate();
        add_site_option("\155\x6f\137\x73\x61\x6d\x6c\x5f\162\145\147\151\163\164\162\x61\164\x69\157\156\137\163\x74\141\x74\165\163", "\162\x65\x6d\157\166\145\144\x5f\x61\x63\143\x6f\165\156\x74");
        $yO = add_query_arg(array("\164\x61\x62" => "\154\157\x67\x69\x6e"), $_SERVER["\x52\x45\x51\x55\105\123\x54\137\x55\122\x49"]);
        header("\x4c\157\x63\141\164\x69\x6f\156\x3a\x20" . $yO);
        sw:
        goto Ww;
        aF:
        $N1 = file_get_contents(plugin_dir_path(__FILE__) . "\162\x65\x73\157\165\x72\x63\145\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Public_Certificate);
        $Og = file_get_contents(plugin_dir_path(__FILE__) . "\x72\145\163\157\x75\162\x63\145\163" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Private_Key);
        if (isset($_POST["\x73\x75\x62\155\151\164"]) and $_POST["\x73\x75\142\x6d\151\164"] == "\125\160\x6c\x6f\x61\x64") {
            goto ZK;
        }
        if (!(isset($_POST["\163\x75\x62\x6d\151\x74"]) and $_POST["\x73\x75\142\x6d\151\x74"] == "\122\x65\x73\145\x74")) {
            goto eM;
        }
        delete_site_option("\155\157\x5f\163\x61\155\154\x5f\x63\x75\x73\164\x6f\155\x5f\143\x65\162\164");
        delete_site_option("\x6d\x6f\137\163\x61\x6d\x6c\x5f\143\x75\163\x74\157\x6d\x5f\x63\145\x72\164\x5f\x70\162\x69\x76\x61\164\145\x5f\153\145\171");
        update_site_option("\155\x6f\137\x73\x61\155\154\137\143\x75\162\162\x65\x6e\164\x5f\x63\145\x72\164", $N1);
        update_site_option("\x6d\157\137\163\x61\155\154\x5f\143\x75\162\x72\145\156\x74\137\x63\145\162\164\137\160\162\x69\166\141\164\x65\137\153\145\x79", $Og);
        update_site_option("\x6d\x6f\137\163\141\155\154\137\x6d\145\163\163\x61\147\x65", "\x52\145\163\x65\x74\x20\x43\145\162\164\151\x66\x69\x63\x61\164\145\x20\163\165\143\x63\x65\163\x73\146\165\154\x6c\171\56");
        $this->mo_saml_show_success_message();
        eM:
        goto Yj;
        ZK:
        if (!@openssl_x509_read($_POST["\163\x61\x6d\x6c\137\160\x75\142\x6c\151\143\137\170\x35\x30\71\x5f\143\x65\162\x74\151\x66\151\x63\x61\164\x65"])) {
            goto ah;
        }
        if (!@openssl_x509_check_private_key($_POST["\x73\141\x6d\154\x5f\160\x75\x62\154\151\143\137\170\x35\60\x39\137\143\145\x72\x74\x69\146\151\143\141\x74\x65"], $_POST["\x73\x61\155\154\137\x70\162\x69\166\141\x74\145\x5f\170\x35\60\x39\x5f\143\145\162\x74\151\146\151\x63\141\164\x65"])) {
            goto e2;
        }
        if (openssl_x509_read($_POST["\x73\x61\155\x6c\x5f\x70\x75\x62\154\151\143\137\x78\x35\x30\x39\137\x63\x65\x72\x74\151\x66\x69\x63\x61\164\x65"]) && openssl_x509_check_private_key($_POST["\163\141\x6d\x6c\137\x70\165\x62\154\x69\143\x5f\170\65\60\71\x5f\x63\x65\x72\x74\x69\x66\151\x63\141\x74\145"], $_POST["\x73\x61\155\x6c\137\160\162\x69\166\141\164\145\137\x78\65\60\x39\137\143\x65\162\164\151\x66\x69\143\141\x74\x65"])) {
            goto T2;
        }
        goto SP;
        ah:
        update_site_option("\x6d\157\137\x73\141\x6d\154\x5f\x6d\x65\x73\x73\x61\147\145", "\111\x6e\166\141\154\151\144\x20\x43\x65\x72\164\x69\146\x69\143\x61\x74\145\40\146\157\162\155\141\164\56\40\x50\x6c\145\141\x73\145\40\145\x6e\x74\145\162\40\x61\40\166\x61\x6c\151\144\x20\143\x65\162\x74\x69\146\151\143\x61\x74\145\56");
        $this->mo_saml_show_error_message();
        return;
        goto SP;
        e2:
        update_site_option("\x6d\157\137\x73\x61\x6d\x6c\x5f\155\145\163\163\141\147\x65", "\x49\156\166\141\154\x69\x64\x20\x50\x72\x69\166\x61\164\145\x20\x4b\x65\x79\56");
        $this->mo_saml_show_error_message();
        return;
        goto SP;
        T2:
        $iL = $_POST["\x73\x61\x6d\154\137\x70\165\x62\154\151\x63\x5f\170\x35\x30\x39\137\143\145\x72\164\151\x66\151\x63\141\164\145"];
        $wz = $_POST["\163\x61\155\154\137\x70\x72\x69\x76\x61\x74\145\137\170\65\60\x39\x5f\x63\x65\x72\164\151\x66\x69\143\x61\x74\x65"];
        update_site_option("\x6d\x6f\x5f\163\x61\155\x6c\x5f\x63\x75\163\164\157\155\x5f\x63\x65\162\164", $iL);
        update_site_option("\155\157\x5f\x73\141\x6d\154\137\143\x75\163\164\157\155\x5f\x63\x65\x72\164\137\x70\x72\x69\x76\141\164\x65\137\x6b\x65\171", $wz);
        update_site_option("\155\157\137\163\141\155\x6c\x5f\143\x75\x72\162\x65\156\164\x5f\143\x65\x72\x74", $iL);
        update_site_option("\x6d\157\137\x73\141\x6d\154\x5f\x63\165\x72\162\x65\x6e\164\x5f\x63\145\x72\164\137\160\162\x69\x76\141\x74\x65\x5f\153\145\x79", $wz);
        update_site_option("\155\157\137\163\x61\x6d\154\x5f\x6d\145\163\x73\x61\x67\x65", "\x43\x75\163\x74\157\x6d\x20\103\x65\x72\x74\x69\146\x69\143\141\164\x65\40\165\x70\144\x61\164\x65\x64\40\163\x75\x63\143\145\163\163\x66\x75\154\x6c\171\56");
        $this->mo_saml_show_success_message();
        SP:
        Yj:
        Ww:
        if (!self::mo_check_option_admin_referer("\155\x61\156\x61\x67\x65\x5f\x73\x73\x6f\x5f\x73\x69\x74\145\163")) {
            goto YL;
        }
        $P1 = Utilities::get_sites();
        $Qf = Utilities::get_active_sites();
        $nK = false;
        $ol = false;
        if (isset($_POST["\x65\156\x61\142\x6c\145\101\154\x6c"]) and $_POST["\x65\x6e\x61\x62\x6c\145\101\x6c\154"] == "\x74\162\x75\145") {
            goto cn;
        }
        if (!(isset($_POST["\x64\x69\x73\x61\x62\x6c\x65\x41\x6c\x6c"]) and $_POST["\144\x69\163\x61\142\x6c\145\x41\154\x6c"] == "\x74\162\x75\x65")) {
            goto po;
        }
        $ol = true;
        po:
        goto w0;
        cn:
        $nK = true;
        w0:
        foreach ($P1 as $I7) {
            $HC = $I7->blog_id;
            if ($nK) {
                goto V6;
            }
            if ($ol) {
                goto Dx;
            }
            if (!isset($_POST[$HC])) {
                goto cE;
            }
            if ($_POST[$HC] == "\x66\x61\x6c\163\145") {
                goto z2;
            }
            if ($_POST[$HC] == "\x74\x72\x75\145") {
                goto yP;
            }
            goto Xq;
            z2:
            $FE = array_search($HC, $Qf);
            if (!($FE !== false)) {
                goto IX;
            }
            unset($Qf[$FE]);
            IX:
            goto Xq;
            yP:
            if (in_array($HC, $Qf)) {
                goto NA;
            }
            array_push($Qf, $HC);
            NA:
            Xq:
            cE:
            goto Zr;
            V6:
            if (in_array($HC, $Qf)) {
                goto Nw;
            }
            array_push($Qf, $HC);
            Nw:
            goto Zr;
            Dx:
            $FE = array_search($HC, $Qf);
            if (!($FE !== false)) {
                goto w9;
            }
            unset($Qf[$FE]);
            w9:
            Zr:
            f9:
        }
        wR:
        $kg = Utilities::get_main_subsite_id();
        if (in_array($kg, $Qf)) {
            goto WR;
        }
        array_push($Qf, $kg);
        WR:
        update_site_option("\155\157\137\145\x6e\141\142\154\x65\137\x73\x73\157\x5f\x73\151\x74\x65\163", $Qf);
        YL:
        if (!self::mo_check_option_admin_referer("\x6d\x6f\137\163\141\155\154\x5f\x72\145\154\141\x79\x5f\163\x74\x61\x74\x65\x5f\157\x70\x74\x69\157\x6e")) {
            goto JU;
        }
        $GH = sanitize_text_field($_POST["\155\157\x5f\163\141\x6d\x6c\137\x72\145\154\141\171\x5f\x73\164\x61\x74\x65"]);
        $A7 = maybe_unserialize(get_site_option("\163\x61\155\154\x5f\163\x73\157\137\163\145\164\164\x69\156\147\163"));
        if ($A7) {
            goto ko;
        }
        $A7 = array();
        ko:
        $I7 = "\104\105\106\x41\125\x4c\x54";
        if (!isset($_POST["\163\x69\164\x65"])) {
            goto aE;
        }
        $I7 = htmlspecialchars($_POST["\163\x69\164\145"]);
        aE:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\106\x41\125\x4c\124"]))) {
            goto TL;
        }
        $A7[$I7] = $A7["\x44\105\x46\101\125\114\124"];
        TL:
        $A7[$I7]["\x6d\157\137\163\x61\x6d\154\137\x72\x65\x6c\x61\171\x5f\x73\164\141\164\x65"] = $GH;
        update_site_option("\x73\x61\155\x6c\137\163\x73\x6f\x5f\x73\x65\x74\x74\x69\x6e\x67\x73", $A7);
        update_site_option("\155\157\x5f\x73\141\x6d\x6c\137\155\x65\163\163\141\147\x65", "\x52\x65\154\141\x79\40\123\164\141\x74\145\x20\x75\x70\144\141\164\x65\x64\40\x73\165\x63\x63\145\x73\x73\x66\x75\154\x6c\171\56");
        $this->mo_saml_show_success_message();
        JU:
        if (!self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\x61\x6d\154\x5f\x77\x69\x64\147\145\x74\137\x6f\x70\164\151\x6f\x6e")) {
            goto JK;
        }
        $A7 = maybe_unserialize(get_site_option("\163\x61\155\x6c\x5f\163\x73\x6f\137\163\145\164\164\x69\156\x67\x73"));
        if ($A7) {
            goto Ko;
        }
        $A7 = array();
        Ko:
        $I7 = "\104\105\106\x41\x55\114\124";
        if (!isset($_POST["\163\x69\x74\145"])) {
            goto gp;
        }
        $I7 = htmlspecialchars($_POST["\163\151\x74\x65"]);
        gp:
        if (!(empty($A7[$I7]) && !empty($A7["\x44\x45\106\101\125\114\124"]))) {
            goto mn;
        }
        $A7[$I7] = $A7["\104\x45\x46\101\125\x4c\x54"];
        mn:
        $pE = sanitize_text_field($_POST["\155\x6f\137\163\x61\x6d\x6c\x5f\143\165\163\x74\157\x6d\x5f\154\x6f\147\151\x6e\137\164\x65\170\x74"]);
        $A7[$I7]["\155\157\x5f\x73\x61\x6d\x6c\x5f\143\x75\163\164\157\155\x5f\154\157\147\151\156\137\164\145\x78\164"] = stripcslashes($pE);
        $t2 = sanitize_text_field($_POST["\x6d\157\x5f\163\141\x6d\154\x5f\143\x75\x73\x74\x6f\155\137\x67\162\145\145\164\151\156\147\x5f\164\145\x78\164"]);
        $A7[$I7]["\x6d\x6f\137\x73\141\155\154\137\143\165\163\x74\157\155\137\x67\162\145\145\x74\x69\156\x67\137\x74\x65\170\164"] = stripcslashes($t2);
        $fh = htmlspecialchars(stripslashes($_POST["\155\x6f\137\x73\141\x6d\154\x5f\147\x72\145\145\164\x69\x6e\147\x5f\156\x61\155\145"]));
        $A7[$I7]["\155\x6f\137\x73\x61\x6d\x6c\137\x67\x72\x65\x65\164\151\x6e\147\x5f\156\x61\155\145"] = $fh;
        $hx = sanitize_text_field($_POST["\x6d\157\137\x73\x61\155\x6c\x5f\x63\x75\163\164\157\155\137\154\157\x67\x6f\165\164\137\164\145\170\164"]);
        $A7[$I7]["\x6d\157\137\x73\x61\155\154\x5f\x63\165\x73\164\157\155\137\154\157\147\157\165\x74\x5f\164\145\x78\164"] = stripcslashes($hx);
        update_site_option("\x73\141\155\x6c\137\163\x73\157\137\x73\x65\164\x74\151\156\147\x73", $A7);
        update_site_option("\x6d\157\137\163\141\155\154\137\x6d\145\163\163\141\147\145", "\x57\x69\144\147\x65\x74\x20\x53\145\164\164\151\156\147\163\40\165\x70\x64\141\x74\145\144\40\163\x75\x63\143\145\x73\163\146\165\x6c\154\171\x2e");
        $this->mo_saml_show_success_message();
        JK:
        if (!self::mo_check_option_admin_referer("\x73\163\157\x5f\x73\145\x74\x74\x69\x6e\147\x73\x5f\163\x69\164\x65\x5f\x6f\160\164\151\x6f\156")) {
            goto yg;
        }
        if (!isset($_POST["\x73\x73\157\x5f\163\145\164\164\151\x6e\x67\x73\x5f\x73\151\164\145"])) {
            goto xt;
        }
        update_site_option("\x73\163\x6f\137\x73\x65\164\x74\151\156\x67\163\137\x73\x69\164\x65", htmlspecialchars($_POST["\x73\x73\157\137\x73\145\164\164\x69\x6e\x67\163\x5f\x73\151\x74\x65"]));
        xt:
        yg:
        if (!self::mo_check_option_admin_referer("\155\157\137\163\x61\x6d\154\x5f\x72\145\x67\151\x73\x74\x65\162\137\x63\165\x73\164\157\155\x65\162")) {
            goto XT;
        }
        if (mo_saml_is_extension_installed("\x63\x75\162\x6c")) {
            goto AI;
        }
        update_site_option("\155\157\x5f\x73\141\155\x6c\137\155\145\163\x73\141\147\x65", "\105\x52\x52\117\122\x3a\x20\x3c\x61\x20\x68\162\x65\146\x3d\x22\150\164\164\160\72\57\57\160\150\160\56\x6e\x65\x74\x2f\155\x61\156\165\141\154\57\x65\x6e\x2f\x63\x75\162\154\56\x69\156\163\x74\141\154\154\x61\164\x69\157\x6e\56\x70\x68\x70\x22\40\164\x61\x72\147\x65\x74\x3d\42\x5f\142\x6c\141\x6e\153\x22\76\x50\x48\120\40\x63\125\122\114\40\x65\x78\164\145\156\163\151\x6f\156\74\x2f\x61\x3e\40\x69\x73\x20\156\x6f\x74\40\151\x6e\163\164\141\154\x6c\x65\x64\x20\x6f\162\40\x64\x69\x73\141\x62\154\145\144\x2e\x20\122\145\x67\151\163\164\162\141\x74\151\x6f\x6e\40\x66\141\x69\154\x65\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        AI:
        $KC = '';
        $sR = '';
        $fK = '';
        $Zm = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\x65\x6d\141\x69\154"]) || $this->mo_saml_check_empty_or_null($_POST["\x70\141\x73\x73\167\x6f\162\x64"]) || $this->mo_saml_check_empty_or_null($_POST["\x63\157\x6e\x66\x69\x72\155\120\x61\163\x73\167\x6f\162\144"])) {
            goto v5;
        }
        if (strlen($_POST["\x70\141\163\x73\x77\157\x72\144"]) < 6 || strlen($_POST["\143\157\x6e\x66\x69\x72\x6d\120\141\163\x73\x77\x6f\162\x64"]) < 6) {
            goto Rx;
        }
        if ($this->checkPasswordPattern(strip_tags($_POST["\160\x61\163\x73\167\x6f\162\x64"]))) {
            goto g7;
        }
        $KC = sanitize_email($_POST["\145\x6d\x61\151\154"]);
        if (!array_key_exists("\160\x68\157\156\x65", $_POST)) {
            goto tg;
        }
        $sR = sanitize_text_field($_POST["\160\x68\157\156\145"]);
        tg:
        $fK = stripslashes(strip_tags($_POST["\x70\x61\x73\163\167\157\x72\x64"]));
        $Zm = stripslashes(strip_tags($_POST["\x63\x6f\156\146\x69\162\x6d\x50\x61\163\163\x77\157\x72\144"]));
        goto oB;
        g7:
        update_site_option("\155\157\137\163\141\155\154\137\x6d\145\163\x73\141\x67\145", "\115\x69\x6e\x69\155\165\155\x20\x36\40\143\x68\141\x72\141\143\164\145\x72\x73\40\163\150\157\x75\x6c\144\40\x62\145\x20\x70\x72\145\x73\145\x6e\x74\56\x20\x4d\x61\x78\x69\155\x75\x6d\40\61\x35\x20\x63\150\141\x72\141\143\164\145\162\163\40\x73\150\157\165\x6c\x64\40\x62\x65\40\160\x72\145\163\145\x6e\x74\56\x20\x4f\x6e\154\x79\x20\146\x6f\154\154\x6f\167\x69\156\x67\x20\x73\171\155\142\x6f\154\x73\x20\50\41\x40\43\56\x24\45\x5e\46\52\x2d\137\x29\40\x73\x68\157\165\x6c\x64\40\x62\x65\40\x70\162\x65\x73\145\156\x74\x2e");
        $this->mo_saml_show_error_message();
        return;
        oB:
        goto KQ;
        Rx:
        update_site_option("\155\x6f\137\163\141\155\154\137\x6d\x65\x73\x73\x61\147\x65", "\103\150\x6f\x6f\x73\145\40\141\x20\160\x61\163\x73\167\x6f\162\144\x20\167\151\164\150\40\155\151\156\x69\155\x75\x6d\40\154\145\x6e\147\x74\150\40\x36\x2e");
        $this->mo_saml_show_error_message();
        return;
        KQ:
        goto Jc;
        v5:
        update_site_option("\x6d\157\137\163\141\x6d\x6c\137\x6d\145\x73\163\141\147\145", "\101\x6c\154\40\x74\x68\145\x20\x66\151\x65\154\144\163\40\x61\162\145\x20\x72\x65\x71\165\151\162\x65\144\x2e\40\x50\x6c\145\141\x73\145\x20\145\156\x74\145\162\40\x76\x61\154\x69\x64\40\x65\156\164\162\151\145\163\56");
        $this->mo_saml_show_error_message();
        return;
        Jc:
        update_site_option("\155\x6f\137\x73\x61\x6d\x6c\137\141\x64\x6d\151\x6e\137\145\x6d\141\x69\x6c", $KC);
        update_site_option("\x6d\157\x5f\163\141\x6d\x6c\x5f\x61\144\x6d\x69\156\137\160\x68\157\156\145", $sR);
        if (strcmp($fK, $Zm) == 0) {
            goto WW;
        }
        update_site_option("\x6d\x6f\137\163\141\x6d\154\x5f\155\145\163\x73\x61\147\145", "\120\x61\163\x73\167\157\162\x64\163\40\144\157\x20\x6e\x6f\x74\40\155\141\x74\143\150\x2e");
        delete_site_option("\x6d\x6f\x5f\163\x61\155\154\x5f\x76\x65\162\151\146\171\137\x63\165\x73\164\x6f\155\145\x72");
        $this->mo_saml_show_error_message();
        goto je;
        WW:
        update_site_option("\155\x6f\x5f\163\141\x6d\154\x5f\x61\144\x6d\151\x6e\x5f\160\141\x73\163\x77\157\162\144", $fK);
        $KC = get_site_option("\x6d\157\137\163\x61\155\154\137\141\x64\x6d\x69\156\x5f\145\x6d\x61\x69\x6c");
        $nI = new CustomerSaml();
        $D3 = $nI->check_customer($this);
        if ($D3) {
            goto gV;
        }
        return;
        gV:
        $sb = json_decode($D3, true);
        if (strcasecmp($sb["\163\164\x61\164\165\x73"], "\103\125\123\124\117\115\x45\122\x5f\x4e\x4f\x54\137\x46\x4f\125\116\104") == 0) {
            goto s8;
        }
        $this->get_current_customer();
        goto n3;
        s8:
        $sb = json_decode($nI->send_otp_token($KC, '', $this), true);
        if (strcasecmp($sb["\x73\x74\x61\x74\165\x73"], "\123\x55\103\x43\105\x53\x53") == 0) {
            goto sf;
        }
        update_site_option("\155\x6f\x5f\163\141\155\154\137\155\x65\x73\x73\141\x67\145", "\124\x68\145\162\x65\x20\x77\141\163\40\x61\156\40\145\x72\162\157\x72\40\x69\156\x20\163\145\x6e\144\151\156\x67\40\145\x6d\141\x69\x6c\x2e\40\x50\x6c\145\141\x73\145\40\x76\x65\162\151\146\171\40\171\157\165\162\40\145\x6d\141\x69\x6c\40\x61\x6e\144\40\x74\x72\x79\40\141\147\x61\151\x6e\56");
        update_site_option("\x6d\157\137\x73\141\155\x6c\x5f\162\145\x67\151\163\164\x72\141\164\x69\157\156\137\163\164\x61\164\x75\x73", "\115\x4f\x5f\x4f\x54\x50\137\104\105\x4c\111\126\105\x52\105\x44\137\x46\101\x49\x4c\125\122\x45\137\105\x4d\x41\x49\114");
        $this->mo_saml_show_error_message();
        goto U2;
        sf:
        update_site_option("\155\x6f\137\x73\141\155\x6c\x5f\x6d\x65\x73\x73\141\x67\145", "\x20\101\40\x6f\x6e\x65\40\x74\x69\x6d\145\x20\160\141\x73\x73\143\157\x64\x65\x20\x69\x73\x20\163\145\156\164\x20\164\157\40" . get_site_option("\155\x6f\x5f\163\141\155\x6c\137\141\144\x6d\151\x6e\137\145\x6d\x61\x69\x6c") . "\x2e\40\x50\154\x65\141\163\145\40\145\156\164\x65\x72\x20\164\150\145\40\157\164\x70\40\150\x65\x72\145\40\164\x6f\x20\166\x65\x72\151\x66\171\x20\x79\x6f\x75\x72\40\x65\x6d\141\151\x6c\x2e");
        update_site_option("\155\157\137\x73\x61\x6d\x6c\x5f\x74\162\141\x6e\x73\x61\x63\x74\x69\x6f\x6e\111\x64", $sb["\x74\x78\111\144"]);
        update_site_option("\155\157\x5f\x73\x61\x6d\x6c\x5f\162\145\147\151\163\x74\x72\x61\x74\151\x6f\x6e\x5f\163\164\x61\x74\x75\163", "\x4d\117\137\117\124\120\x5f\104\105\x4c\x49\126\105\x52\x45\x44\x5f\x53\125\x43\103\x45\123\123\137\x45\115\101\x49\x4c");
        $this->mo_saml_show_success_message();
        U2:
        n3:
        je:
        XT:
        if (!self::mo_check_option_admin_referer("\155\157\137\163\x61\155\x6c\137\166\x61\154\x69\x64\x61\164\145\137\x6f\x74\x70")) {
            goto Qs;
        }
        if (mo_saml_is_extension_installed("\x63\x75\162\x6c")) {
            goto kb;
        }
        update_site_option("\x6d\157\x5f\163\141\155\154\137\155\145\x73\163\141\147\145", "\x45\x52\x52\117\x52\x3a\x20\x3c\x61\40\x68\162\145\x66\75\42\150\x74\164\160\x3a\x2f\x2f\160\150\160\56\x6e\x65\164\57\x6d\x61\156\165\x61\x6c\57\x65\156\x2f\143\165\162\x6c\56\x69\x6e\x73\x74\141\154\x6c\x61\164\151\x6f\x6e\56\x70\x68\160\42\40\x74\141\x72\x67\145\164\x3d\x22\137\142\154\x61\x6e\x6b\42\x3e\120\x48\120\x20\143\x55\122\x4c\x20\145\170\164\145\x6e\x73\x69\157\x6e\x3c\x2f\x61\x3e\x20\151\x73\40\x6e\157\x74\x20\151\156\x73\x74\141\x6c\x6c\x65\144\x20\x6f\x72\x20\144\x69\163\x61\x62\154\145\x64\56\40\126\x61\x6c\x69\x64\x61\164\x65\x20\117\x54\120\x20\x66\141\x69\154\x65\x64\56");
        $this->mo_saml_show_error_message();
        return;
        kb:
        $eB = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\157\164\160\137\164\157\153\x65\156"])) {
            goto LU;
        }
        $eB = sanitize_text_field($_POST["\157\x74\x70\137\164\157\x6b\145\156"]);
        goto vO;
        LU:
        update_site_option("\155\x6f\x5f\163\x61\x6d\x6c\x5f\155\145\163\x73\141\x67\x65", "\120\x6c\x65\x61\x73\x65\x20\x65\x6e\x74\x65\162\40\141\40\166\141\154\x75\145\40\x69\x6e\40\x6f\164\x70\40\146\x69\145\154\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        vO:
        $nI = new CustomerSaml();
        $sb = json_decode($nI->validate_otp_token(get_site_option("\155\157\137\x73\x61\x6d\x6c\137\164\162\141\x6e\x73\x61\x63\164\x69\x6f\156\111\144"), $eB, $this), true);
        if (strcasecmp($sb["\x73\x74\141\x74\x75\x73"], "\123\125\x43\x43\105\x53\123") == 0) {
            goto vB;
        }
        update_site_option("\x6d\x6f\137\163\141\155\154\137\x6d\x65\x73\x73\141\x67\145", "\x49\156\166\x61\x6c\x69\144\x20\x6f\x6e\145\40\164\151\155\145\40\160\x61\163\x73\143\157\144\145\x2e\x20\x50\x6c\x65\141\163\x65\x20\x65\156\x74\x65\x72\x20\141\x20\x76\x61\154\151\x64\x20\157\x74\x70\56");
        $this->mo_saml_show_error_message();
        goto q8;
        vB:
        $this->create_customer();
        q8:
        Qs:
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\163\141\155\x6c\137\166\145\162\151\146\x79\137\x63\x75\163\x74\157\x6d\x65\162")) {
            goto CP;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\x73\141\x6d\154\137\143\x6f\156\164\141\143\164\137\x75\163\137\x71\x75\145\x72\x79\137\x6f\160\164\151\x6f\x6e")) {
            goto bc;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\141\x6d\154\x5f\162\x65\163\x65\156\x64\137\x6f\x74\160\137\145\x6d\x61\x69\154")) {
            goto XM;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\x73\141\x6d\x6c\137\x72\145\x73\145\x6e\144\137\x6f\x74\x70\137\x70\x68\157\156\145")) {
            goto sM;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\137\x73\141\155\x6c\137\147\157\x5f\x62\141\143\x6b")) {
            goto Db;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\x73\141\155\154\x5f\x72\x65\x67\x69\163\x74\x65\162\x5f\x77\x69\164\150\x5f\x70\150\x6f\156\145\137\x6f\x70\164\151\x6f\156")) {
            goto H8;
        }
        if (self::mo_check_option_admin_referer("\155\157\x5f\163\x61\x6d\x6c\137\x72\x65\147\151\x73\164\145\162\x65\144\x5f\157\x6e\x6c\x79\137\141\143\143\145\x73\163\137\x6f\x70\x74\x69\x6f\x6e")) {
            goto a2;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\x73\141\x6d\x6c\x5f\x73\x75\142\x73\151\x74\x65\x5f\x61\143\x63\145\163\163\x5f\144\x65\x6e\x69\145\144\137\157\x70\x74\x69\157\156")) {
            goto eJ;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\x73\141\x6d\154\137\146\x6f\162\143\x65\x5f\141\165\x74\150\145\156\164\151\x63\141\164\x69\x6f\156\137\x6f\x70\x74\151\x6f\x6e")) {
            goto YZ;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\163\141\x6d\154\137\145\156\141\x62\x6c\x65\x5f\x64\x6f\155\141\x69\x6e\x5f\x6d\x61\x70\x70\151\156\147\137\157\160\x74\151\x6f\156")) {
            goto Xu;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\x73\141\155\x6c\137\x65\156\x61\x62\154\x65\x5f\x6c\157\x67\151\x6e\137\162\x65\144\151\162\145\143\x74\137\157\160\164\x69\x6f\156")) {
            goto mR;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\137\163\141\x6d\154\137\x72\x65\144\151\162\x65\x63\164\x5f\164\157\x5f\x77\160\137\154\x6f\147\x69\156\x5f\x6f\160\x74\x69\x6f\156")) {
            goto o2;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\163\141\155\154\x5f\141\x64\x64\137\x73\163\157\x5f\142\165\x74\x74\x6f\156\137\x77\x70\137\157\x70\164\151\x6f\x6e")) {
            goto tE;
        }
        if (self::mo_check_option_admin_referer("\155\157\x5f\163\x61\x6d\154\137\165\163\x65\137\x62\x75\x74\164\157\x6e\137\141\x73\x5f\163\x68\157\x72\164\x63\157\x64\x65\x5f\x6f\160\x74\151\x6f\156")) {
            goto my;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\137\163\x61\155\x6c\x5f\x75\163\145\137\142\x75\x74\164\157\x6e\137\x61\x73\x5f\167\151\x64\147\145\164\137\157\x70\x74\x69\157\156")) {
            goto xG;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\137\163\141\x6d\x6c\x5f\143\x75\163\164\x6f\x6d\137\x62\x75\x74\164\157\x6e\x5f\157\x70\164\x69\157\156")) {
            goto Iy;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\x73\141\155\154\137\x61\154\154\157\x77\137\167\160\x5f\163\151\x67\x6e\x69\156\x5f\x6f\x70\x74\x69\x6f\x6e")) {
            goto p4;
        }
        if (!self::mo_check_option_admin_referer("\x6d\157\137\163\141\x6d\x6c\x5f\x66\157\x72\x67\x6f\164\x5f\x70\x61\x73\x73\167\x6f\162\144\137\146\157\x72\x6d\137\157\160\164\151\x6f\156")) {
            goto hO;
        }
        if (mo_saml_is_extension_installed("\x63\165\x72\x6c")) {
            goto g3;
        }
        update_site_option("\x6d\x6f\137\163\141\155\x6c\137\x6d\x65\163\163\141\x67\145", "\105\122\x52\x4f\122\72\40\74\x61\40\150\x72\145\146\x3d\42\150\164\164\160\72\57\x2f\x70\x68\x70\56\156\x65\164\57\155\141\x6e\165\141\154\57\145\x6e\x2f\x63\x75\162\154\56\x69\x6e\x73\164\141\x6c\x6c\x61\x74\x69\157\156\x2e\x70\150\160\x22\x20\x74\141\x72\147\x65\x74\x3d\42\x5f\x62\154\x61\156\153\42\76\120\x48\120\x20\x63\x55\122\x4c\40\145\x78\164\x65\x6e\163\151\x6f\156\74\57\x61\x3e\x20\x69\163\40\156\x6f\164\x20\x69\156\163\164\141\154\x6c\145\144\40\x6f\x72\40\144\x69\x73\x61\142\x6c\x65\144\x2e\x20\x52\145\163\145\x6e\x64\40\117\124\x50\40\146\141\x69\x6c\145\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        g3:
        $KC = get_site_option("\x6d\x6f\x5f\x73\141\155\x6c\x5f\x61\144\x6d\x69\156\137\x65\155\141\x69\154");
        $nI = new Customersaml();
        $sb = json_decode($nI->mo_saml_forgot_password($KC, $this), true);
        if (strcasecmp($sb["\163\x74\141\164\x75\x73"], "\123\x55\x43\103\105\x53\x53") == 0) {
            goto H6;
        }
        update_site_option("\155\x6f\x5f\x73\141\x6d\x6c\x5f\x6d\145\163\x73\141\147\x65", "\101\156\x20\x65\162\x72\x6f\162\x20\157\143\x63\165\x72\x65\144\x20\167\x68\x69\x6c\x65\40\160\x72\157\143\145\163\163\151\x6e\147\40\x79\x6f\x75\x72\x20\x72\x65\x71\165\x65\163\164\x2e\x20\x50\154\145\141\163\145\x20\x54\x72\x79\40\x61\x67\141\151\156\56");
        $this->mo_saml_show_error_message();
        goto Dc;
        H6:
        update_site_option("\155\x6f\x5f\163\141\155\154\x5f\155\145\x73\163\x61\x67\145", "\x59\157\165\x72\x20\160\x61\163\163\167\x6f\162\x64\40\150\141\163\x20\x62\x65\145\x6e\x20\162\145\163\145\x74\40\163\x75\143\143\x65\x73\x73\x66\x75\154\154\171\x2e\x20\x50\154\x65\x61\163\145\x20\x65\x6e\164\145\162\x20\x74\150\145\40\x6e\145\167\x20\160\x61\x73\163\x77\x6f\162\144\x20\163\x65\156\x74\40\x74\x6f\40" . $KC . "\56");
        $this->mo_saml_show_success_message();
        Dc:
        hO:
        goto Cu;
        p4:
        $A7 = maybe_unserialize(get_site_option("\x73\x61\x6d\154\x5f\x73\x73\x6f\x5f\x73\145\x74\x74\x69\156\147\x73"));
        if (!empty($A7)) {
            goto el;
        }
        $A7 = array();
        el:
        $I7 = "\x44\x45\106\101\125\114\124";
        if (!isset($_POST["\163\151\x74\x65"])) {
            goto PJ;
        }
        $I7 = htmlspecialchars($_POST["\163\x69\x74\x65"]);
        PJ:
        if (!(empty($A7[$I7]) && !empty($A7["\x44\x45\106\101\x55\114\x54"]))) {
            goto PU;
        }
        $A7[$I7] = $A7["\104\x45\x46\x41\125\114\x54"];
        PU:
        $E2 = "\146\x61\154\163\145";
        if (array_key_exists("\155\x6f\x5f\x73\141\x6d\x6c\137\141\x6c\x6c\157\167\x5f\167\160\137\163\151\x67\156\x69\x6e", $_POST)) {
            goto SO;
        }
        $oZ = "\x66\141\154\163\145";
        goto VX;
        SO:
        $oZ = htmlspecialchars($_POST["\x6d\157\x5f\x73\x61\155\154\137\x61\x6c\154\157\x77\137\x77\160\x5f\163\151\x67\x6e\151\156"]);
        VX:
        if ($oZ == "\x74\x72\165\x65") {
            goto Ol;
        }
        $A7[$I7]["\155\x6f\x5f\x73\x61\155\x6c\x5f\141\x6c\x6c\157\x77\x5f\x77\160\137\163\151\x67\156\x69\156"] = '';
        goto Jr;
        Ol:
        $A7[$I7]["\155\x6f\x5f\x73\x61\x6d\x6c\x5f\x61\x6c\x6c\157\x77\x5f\x77\x70\137\163\151\147\x6e\x69\156"] = "\x74\162\165\x65";
        if (!array_key_exists("\x6d\x6f\137\163\x61\x6d\154\x5f\142\141\143\153\144\157\157\162\137\x75\x72\154", $_POST)) {
            goto zJ;
        }
        $E2 = htmlspecialchars(trim($_POST["\155\x6f\x5f\x73\x61\x6d\154\x5f\x62\141\143\x6b\144\x6f\157\162\x5f\x75\x72\x6c"]));
        zJ:
        Jr:
        $A7[$I7]["\x6d\157\x5f\x73\x61\155\154\137\x62\141\143\x6b\144\x6f\x6f\162\x5f\165\162\x6c"] = $E2;
        update_site_option("\x73\141\x6d\154\x5f\163\163\x6f\x5f\x73\x65\164\x74\151\156\x67\x73", $A7);
        update_site_option("\x6d\157\137\163\141\x6d\154\x5f\155\x65\x73\x73\x61\x67\x65", "\123\151\x67\x6e\40\x49\x6e\40\x73\x65\164\x74\x69\x6e\147\163\x20\x75\x70\144\141\164\145\144\56");
        $this->mo_saml_show_success_message();
        Cu:
        goto iq;
        Iy:
        $A7 = maybe_unserialize(get_site_option("\163\141\x6d\x6c\x5f\163\163\x6f\x5f\163\145\164\x74\151\x6e\147\163"));
        if ($A7) {
            goto nV;
        }
        $A7 = array();
        nV:
        $I7 = "\x44\x45\106\101\125\114\124";
        if (!isset($_POST["\163\151\164\145"])) {
            goto cY;
        }
        $I7 = htmlspecialchars($_POST["\163\151\164\x65"]);
        cY:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\x46\x41\x55\x4c\124"]))) {
            goto R3;
        }
        $A7[$I7] = $A7["\x44\x45\x46\101\x55\x4c\x54"];
        R3:
        $Bz = '';
        $iK = '';
        $Ak = '';
        $GW = '';
        $vx = '';
        $C6 = '';
        $lf = '';
        $ES = '';
        $Eb = '';
        $vK = '';
        $NA = "\141\142\157\x76\x65";
        if (!(array_key_exists("\x6d\157\x5f\x73\x61\x6d\x6c\137\x62\x75\x74\x74\x6f\156\x5f\x73\x69\172\x65", $_POST) && !empty($_POST["\x6d\157\137\163\x61\155\154\x5f\x62\x75\164\164\x6f\x6e\x5f\163\x69\172\x65"]))) {
            goto qz;
        }
        $Ak = htmlspecialchars($_POST["\155\x6f\x5f\163\141\x6d\154\137\142\x75\x74\x74\157\156\137\x73\151\x7a\145"]);
        qz:
        if (!(array_key_exists("\x6d\157\137\x73\x61\155\154\x5f\142\165\164\164\x6f\x6e\137\x77\x69\144\164\x68", $_POST) && !empty($_POST["\155\x6f\x5f\163\141\x6d\x6c\x5f\x62\165\x74\x74\157\156\137\167\151\144\x74\150"]))) {
            goto p6;
        }
        $GW = htmlspecialchars($_POST["\x6d\x6f\137\163\141\155\154\x5f\x62\165\x74\164\x6f\x6e\x5f\x77\151\144\x74\150"]);
        p6:
        if (!(array_key_exists("\155\x6f\x5f\x73\141\x6d\154\137\x62\165\x74\164\157\156\x5f\150\145\x69\147\x68\164", $_POST) && !empty($_POST["\155\157\137\x73\x61\155\x6c\x5f\x62\165\164\164\x6f\x6e\x5f\x68\145\151\147\x68\164"]))) {
            goto tU;
        }
        $vx = htmlspecialchars($_POST["\155\x6f\x5f\163\x61\x6d\154\x5f\142\x75\164\164\x6f\156\137\x68\145\x69\147\150\x74"]);
        tU:
        if (!(array_key_exists("\x6d\157\137\x73\141\155\x6c\137\x62\x75\x74\164\157\x6e\137\143\165\x72\x76\145", $_POST) && !empty($_POST["\x6d\157\x5f\x73\x61\x6d\x6c\137\142\x75\164\164\x6f\x6e\137\143\x75\162\166\145"]))) {
            goto T8;
        }
        $C6 = htmlspecialchars($_POST["\155\157\x5f\163\x61\155\154\137\x62\x75\x74\164\x6f\x6e\x5f\143\165\162\166\x65"]);
        T8:
        if (!array_key_exists("\x6d\157\137\x73\x61\155\x6c\137\142\165\x74\164\157\x6e\137\x63\x6f\154\x6f\x72", $_POST)) {
            goto Vo;
        }
        $lf = htmlspecialchars($_POST["\155\x6f\137\163\141\155\154\x5f\142\x75\164\x74\x6f\156\137\143\157\154\x6f\162"]);
        Vo:
        if (!array_key_exists("\x6d\x6f\137\163\x61\155\154\x5f\x62\165\164\164\x6f\156\137\164\x68\145\x6d\x65", $_POST)) {
            goto wz;
        }
        $Bz = htmlspecialchars($_POST["\155\x6f\x5f\x73\x61\x6d\x6c\x5f\142\165\164\164\x6f\156\137\x74\150\x65\x6d\145"]);
        wz:
        if (!array_key_exists("\155\157\137\x73\141\x6d\154\137\142\x75\x74\x74\x6f\156\x5f\x74\x65\x78\x74", $_POST)) {
            goto cR;
        }
        $ES = htmlspecialchars($_POST["\x6d\x6f\x5f\163\x61\155\154\137\142\x75\x74\164\157\x6e\137\164\x65\x78\164"]);
        if (!(empty($ES) || $ES == "\43\x23\x49\x44\x50\x23\43")) {
            goto i9;
        }
        $ES = "\43\43\x49\x44\x50\43\x23";
        i9:
        $B0 = get_site_option("\163\141\155\154\137\151\144\145\156\x74\151\x74\x79\137\x6e\141\155\145");
        $ES = str_replace("\x23\43\x49\x44\x50\43\x23", $B0, $ES);
        cR:
        if (!array_key_exists("\x6d\x6f\x5f\163\141\155\154\x5f\x66\x6f\156\x74\x5f\143\157\x6c\157\162", $_POST)) {
            goto wk;
        }
        $Eb = htmlspecialchars($_POST["\x6d\x6f\137\163\x61\x6d\x6c\x5f\146\157\156\x74\137\143\x6f\154\x6f\x72"]);
        wk:
        if (!array_key_exists("\x6d\157\137\x73\x61\155\154\137\x66\157\x6e\x74\137\x73\x69\172\145", $_POST)) {
            goto MM;
        }
        $vK = htmlspecialchars($_POST["\155\x6f\137\163\x61\155\154\137\x66\157\x6e\164\137\x73\x69\x7a\145"]);
        MM:
        if (!array_key_exists("\163\163\x6f\137\x62\x75\x74\x74\x6f\x6e\137\x6c\157\x67\x69\x6e\137\146\x6f\x72\155\137\x70\x6f\x73\151\164\151\157\x6e", $_POST)) {
            goto S6;
        }
        $NA = htmlspecialchars($_POST["\163\x73\x6f\x5f\x62\x75\164\164\x6f\156\137\154\157\x67\151\156\137\146\x6f\x72\x6d\x5f\160\157\x73\x69\164\x69\157\156"]);
        S6:
        $A7[$I7]["\155\x6f\137\163\141\155\154\x5f\x62\165\164\164\157\x6e\x5f\164\150\145\x6d\x65"] = $Bz;
        $A7[$I7]["\x6d\157\137\163\x61\x6d\x6c\137\x62\165\x74\x74\x6f\156\137\163\x69\x7a\x65"] = $Ak;
        $A7[$I7]["\155\157\137\163\141\155\154\137\142\x75\164\x74\x6f\x6e\137\167\151\144\x74\x68"] = $GW;
        $A7[$I7]["\x6d\157\x5f\x73\x61\155\154\x5f\142\x75\164\164\157\156\x5f\150\x65\151\147\150\x74"] = $vx;
        $A7[$I7]["\x6d\x6f\x5f\x73\x61\155\154\137\142\165\164\x74\x6f\156\137\143\165\162\x76\145"] = $C6;
        $A7[$I7]["\155\x6f\x5f\x73\x61\155\154\137\142\165\x74\x74\x6f\x6e\137\x63\157\154\x6f\162"] = $lf;
        $A7[$I7]["\155\x6f\x5f\x73\x61\155\x6c\x5f\142\x75\164\x74\157\156\x5f\x74\x65\x78\164"] = $ES;
        $A7[$I7]["\x6d\x6f\x5f\163\x61\155\x6c\x5f\146\x6f\156\164\x5f\143\157\x6c\157\x72"] = $Eb;
        $A7[$I7]["\155\157\137\163\x61\155\x6c\x5f\x66\x6f\x6e\164\x5f\163\151\172\145"] = $vK;
        $A7[$I7]["\x73\163\157\137\x62\x75\164\x74\x6f\x6e\137\154\157\x67\151\156\x5f\x66\x6f\162\x6d\x5f\x70\x6f\x73\x69\x74\151\x6f\156"] = $NA;
        update_site_option("\163\141\x6d\154\x5f\163\x73\157\x5f\x73\145\x74\164\151\x6e\147\x73", $A7);
        update_site_option("\155\x6f\x5f\x73\x61\155\x6c\137\155\145\163\x73\141\147\x65", "\123\x69\147\x6e\x20\111\x6e\40\163\x65\164\x74\151\156\147\x73\x20\x75\x70\144\x61\x74\x65\x64\56");
        $this->mo_saml_show_success_message();
        iq:
        goto WU;
        xG:
        if (mo_saml_is_sp_configured()) {
            goto ld;
        }
        update_site_option("\155\157\x5f\x73\141\x6d\154\137\155\x65\x73\x73\141\147\x65", "\x50\154\145\x61\x73\x65\40\143\157\x6d\160\154\145\164\145\40" . addLink("\x53\x65\x72\166\151\143\x65\x20\120\162\157\166\x69\144\145\x72", add_query_arg(array("\164\141\142" => "\x73\141\x76\x65"), $_SERVER["\x52\x45\x51\125\105\123\124\x5f\x55\122\111"])) . "\x20\x63\157\156\x66\151\x67\165\x72\x61\x74\151\157\x6e\40\x66\x69\162\163\x74\x2e");
        $this->mo_saml_show_error_message();
        goto ZN;
        ld:
        $A7 = maybe_unserialize(get_site_option("\163\141\155\154\x5f\163\x73\x6f\x5f\163\x65\x74\x74\151\x6e\147\x73"));
        if ($A7) {
            goto Mh;
        }
        $A7 = array();
        Mh:
        $I7 = "\x44\x45\x46\x41\x55\x4c\x54";
        if (!isset($_POST["\x73\151\x74\x65"])) {
            goto dj;
        }
        $I7 = htmlspecialchars($_POST["\x73\151\x74\x65"]);
        dj:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\106\x41\125\114\x54"]))) {
            goto Xc;
        }
        $A7[$I7] = $A7["\104\x45\106\x41\125\x4c\124"];
        Xc:
        if (array_key_exists("\x6d\x6f\x5f\x73\141\x6d\154\x5f\165\x73\x65\x5f\142\165\164\x74\x6f\x6e\137\x61\163\x5f\167\x69\144\x67\x65\164", $_POST)) {
            goto tM;
        }
        $kQ = "\x66\x61\x6c\x73\145";
        goto At;
        tM:
        $kQ = htmlspecialchars($_POST["\x6d\x6f\x5f\x73\141\x6d\154\137\165\x73\x65\x5f\x62\165\x74\164\157\x6e\137\x61\163\x5f\167\151\144\x67\145\164"]);
        At:
        $A7[$I7]["\155\157\137\163\x61\x6d\154\x5f\x75\x73\x65\x5f\x62\165\x74\x74\x6f\x6e\x5f\141\x73\x5f\167\151\x64\147\145\164"] = $kQ;
        update_site_option("\163\141\155\154\137\x73\x73\x6f\137\163\x65\x74\x74\x69\x6e\x67\x73", $A7);
        update_site_option("\x6d\157\137\x73\141\155\x6c\137\155\x65\163\x73\x61\147\145", "\x53\x69\147\156\x20\x69\x6e\40\157\x70\x74\x69\157\x6e\163\40\165\x70\x64\141\164\x65\144\56");
        $this->mo_saml_show_success_message();
        ZN:
        WU:
        goto Br;
        my:
        if (mo_saml_is_sp_configured()) {
            goto ws;
        }
        update_site_option("\155\x6f\137\163\x61\155\x6c\137\155\145\163\x73\141\147\145", "\120\154\145\141\163\145\40\x63\x6f\x6d\x70\x6c\x65\164\145\40" . addLink("\123\145\162\x76\151\x63\145\x20\120\162\157\166\151\144\x65\x72", add_query_arg(array("\x74\141\x62" => "\x73\141\x76\145"), $_SERVER["\122\x45\121\x55\x45\123\x54\x5f\x55\122\x49"])) . "\40\x63\x6f\x6e\146\x69\x67\165\x72\x61\x74\x69\157\x6e\40\146\x69\162\x73\164\56");
        $this->mo_saml_show_error_message();
        goto GT;
        ws:
        $A7 = maybe_unserialize(get_site_option("\x73\141\155\x6c\137\163\163\157\137\x73\x65\164\x74\x69\x6e\x67\x73"));
        if ($A7) {
            goto pN;
        }
        $A7 = array();
        pN:
        $I7 = "\104\x45\106\101\125\x4c\x54";
        if (!isset($_POST["\x73\x69\164\145"])) {
            goto Pc;
        }
        $I7 = htmlspecialchars($_POST["\163\x69\164\x65"]);
        Pc:
        if (!(empty($A7[$I7]) && !empty($A7["\104\x45\106\x41\x55\114\124"]))) {
            goto yv;
        }
        $A7[$I7] = $A7["\104\x45\x46\101\x55\x4c\124"];
        yv:
        if (array_key_exists("\x6d\157\137\x73\141\x6d\154\x5f\x75\163\x65\x5f\x62\x75\x74\x74\x6f\156\137\x61\163\137\x73\x68\x6f\x72\x74\143\x6f\144\x65", $_POST)) {
            goto kQ;
        }
        $kQ = "\146\x61\x6c\x73\145";
        goto yl;
        kQ:
        $kQ = htmlspecialchars($_POST["\155\157\137\x73\141\x6d\x6c\x5f\165\x73\145\137\x62\165\164\164\x6f\156\x5f\141\163\x5f\x73\150\x6f\x72\x74\143\157\x64\x65"]);
        yl:
        $A7[$I7]["\x6d\x6f\137\163\x61\x6d\154\137\x75\163\145\137\142\x75\164\x74\x6f\x6e\137\x61\163\x5f\163\x68\157\x72\x74\143\157\x64\145"] = $kQ;
        update_site_option("\163\x61\155\x6c\137\x73\x73\x6f\137\x73\x65\164\164\151\156\147\x73", $A7);
        update_site_option("\x6d\157\x5f\163\141\155\154\x5f\155\x65\x73\163\x61\147\x65", "\123\x69\x67\x6e\40\151\x6e\40\157\160\164\x69\x6f\156\163\40\165\160\144\141\x74\x65\x64\x2e");
        $this->mo_saml_show_success_message();
        GT:
        Br:
        goto sK;
        tE:
        if (mo_saml_is_sp_configured()) {
            goto U3;
        }
        update_site_option("\155\157\x5f\x73\x61\x6d\154\x5f\155\x65\x73\x73\141\147\145", "\x50\x6c\x65\x61\x73\x65\x20\x63\157\155\x70\154\x65\x74\x65\40" . addLink("\123\x65\x72\x76\151\x63\145\x20\120\162\x6f\166\151\144\145\162", add_query_arg(array("\164\141\142" => "\163\x61\166\x65"), $_SERVER["\x52\x45\x51\x55\105\123\x54\137\125\x52\x49"])) . "\x20\143\x6f\156\x66\151\147\x75\162\141\164\x69\157\x6e\40\146\151\162\x73\x74\x2e");
        $this->mo_saml_show_error_message();
        goto PF;
        U3:
        $A7 = maybe_unserialize(get_site_option("\x73\x61\x6d\x6c\137\163\x73\x6f\137\x73\145\x74\x74\x69\x6e\147\163"));
        if ($A7) {
            goto BJ;
        }
        $A7 = array();
        BJ:
        $I7 = "\x44\105\106\x41\x55\x4c\124";
        if (!isset($_POST["\x73\x69\x74\x65"])) {
            goto Yi;
        }
        $I7 = htmlspecialchars($_POST["\x73\151\x74\145"]);
        Yi:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\x46\x41\x55\x4c\124"]))) {
            goto iG;
        }
        $A7[$I7] = $A7["\104\x45\x46\101\x55\114\124"];
        iG:
        if (array_key_exists("\155\x6f\x5f\163\141\155\x6c\x5f\141\144\144\x5f\163\x73\157\137\x62\165\x74\164\157\156\137\167\160", $_POST)) {
            goto F3;
        }
        $a_ = "\x66\x61\x6c\x73\x65";
        goto dg;
        F3:
        $a_ = htmlspecialchars($_POST["\155\x6f\x5f\163\141\155\154\x5f\141\x64\144\x5f\163\x73\157\x5f\142\x75\x74\x74\x6f\156\x5f\167\x70"]);
        dg:
        $A7[$I7]["\x6d\x6f\137\x73\141\x6d\154\x5f\x61\144\144\x5f\x73\x73\x6f\137\142\165\164\x74\157\x6e\x5f\x77\160"] = $a_;
        update_site_option("\163\141\155\154\x5f\163\x73\x6f\x5f\x73\145\164\164\x69\156\x67\x73", $A7);
        update_site_option("\155\157\137\163\141\155\154\137\x6d\145\163\163\141\x67\x65", "\x53\151\147\156\40\x69\156\40\157\160\164\151\x6f\x6e\x73\40\x75\160\144\141\164\x65\144\x2e");
        $this->mo_saml_show_success_message();
        PF:
        sK:
        goto sL;
        o2:
        if (!mo_saml_is_sp_configured()) {
            goto CD;
        }
        $A7 = maybe_unserialize(get_site_option("\x73\141\155\x6c\x5f\x73\163\x6f\x5f\x73\145\x74\x74\151\x6e\147\x73"));
        if ($A7) {
            goto nQ;
        }
        $A7 = array();
        nQ:
        $I7 = "\104\105\106\x41\x55\114\x54";
        if (!isset($_POST["\163\x69\x74\x65"])) {
            goto so;
        }
        $I7 = htmlspecialchars($_POST["\x73\151\x74\x65"]);
        so:
        if (!(empty($A7[$I7]) && !empty($A7["\104\x45\x46\101\x55\x4c\124"]))) {
            goto pm;
        }
        $A7[$I7] = $A7["\104\105\x46\101\125\x4c\x54"];
        pm:
        if (array_key_exists("\x6d\x6f\137\163\141\x6d\154\137\x72\145\x64\151\x72\145\143\164\x5f\164\x6f\x5f\x77\x70\137\x6c\x6f\147\151\x6e", $_POST)) {
            goto Tr;
        }
        $Mn = "\146\x61\x6c\163\x65";
        goto Wv;
        Tr:
        $Mn = htmlspecialchars($_POST["\155\x6f\x5f\163\141\x6d\x6c\137\x72\x65\x64\151\162\x65\143\164\137\164\x6f\x5f\167\x70\x5f\154\157\x67\151\156"]);
        Wv:
        $A7[$I7]["\155\x6f\x5f\x73\141\x6d\154\137\162\145\x64\x69\x72\x65\143\x74\137\x74\x6f\137\x77\x70\137\154\x6f\x67\151\156"] = $Mn;
        update_site_option("\163\141\x6d\154\137\x73\163\x6f\137\163\x65\x74\x74\151\156\147\x73", $A7);
        update_site_option("\155\157\x5f\x73\x61\155\154\137\x6d\145\x73\x73\141\147\145", "\123\151\147\156\x20\x69\x6e\40\157\x70\164\151\x6f\156\163\x20\165\160\x64\141\164\145\144\56");
        $this->mo_saml_show_success_message();
        CD:
        sL:
        goto x1;
        mR:
        if (mo_saml_is_sp_configured()) {
            goto Go;
        }
        update_site_option("\x6d\x6f\x5f\163\141\x6d\x6c\137\x6d\145\163\163\x61\147\x65", "\120\154\x65\141\163\145\x20\x63\x6f\x6d\160\x6c\145\164\145\40\74\x61\x20\150\x72\145\x66\75\x22" . add_query_arg(array("\164\141\142" => "\x73\141\x76\145"), $_SERVER["\x52\x45\121\x55\105\123\124\x5f\x55\122\111"]) . "\42\40\57\x3e\x53\145\162\166\151\143\x65\40\x50\x72\157\x76\x69\144\145\162\x3c\x2f\x61\76\40\x63\x6f\156\146\x69\147\165\x72\141\x74\151\x6f\x6e\x20\146\151\162\x73\x74\56");
        $this->mo_saml_show_error_message();
        goto ZW;
        Go:
        $A7 = maybe_unserialize(get_site_option("\163\141\x6d\154\137\x73\x73\157\x5f\163\x65\164\164\151\156\x67\163"));
        if (!empty($A7)) {
            goto Kr;
        }
        $A7 = array();
        Kr:
        $I7 = "\x44\x45\x46\x41\125\x4c\x54";
        if (!isset($_POST["\x73\151\x74\145"])) {
            goto Rf;
        }
        $I7 = htmlspecialchars($_POST["\x73\x69\x74\145"]);
        Rf:
        if (!(empty($A7[$I7]) && !empty($A7["\104\x45\x46\x41\125\x4c\x54"]))) {
            goto tf;
        }
        $A7[$I7] = $A7["\x44\x45\106\x41\125\x4c\124"];
        tf:
        if (array_key_exists("\155\157\x5f\x73\x61\155\154\137\x65\156\141\x62\154\145\x5f\154\157\147\151\156\137\162\145\144\x69\x72\145\x63\x74", $_POST)) {
            goto c5;
        }
        $kM = "\146\141\x6c\163\x65";
        goto XY;
        c5:
        $kM = htmlspecialchars($_POST["\x6d\x6f\137\x73\141\155\x6c\x5f\x65\x6e\141\142\154\145\137\x6c\157\x67\x69\x6e\137\x72\145\x64\x69\162\145\x63\x74"]);
        XY:
        if ($kM == "\164\x72\165\145") {
            goto H3;
        }
        $A7[$I7]["\x6d\x6f\137\163\141\155\154\137\x65\x6e\x61\142\154\x65\x5f\154\157\x67\x69\156\x5f\x72\x65\144\151\162\x65\x63\x74"] = '';
        $A7[$I7]["\x6d\157\x5f\163\x61\x6d\x6c\137\141\x6c\x6c\x6f\167\x5f\167\x70\137\x73\151\147\x6e\x69\156"] = '';
        goto cN;
        H3:
        $A7[$I7]["\155\x6f\x5f\x73\x61\x6d\x6c\137\145\x6e\141\142\154\x65\x5f\154\157\x67\x69\156\x5f\162\x65\x64\151\162\145\143\164"] = "\x74\162\165\145";
        $A7[$I7]["\155\x6f\137\x73\x61\x6d\x6c\137\x61\154\x6c\x6f\167\137\167\x70\137\x73\x69\x67\156\151\x6e"] = "\x74\162\x75\145";
        cN:
        update_site_option("\x73\141\155\x6c\137\x73\163\x6f\137\163\145\164\164\x69\156\x67\x73", $A7);
        update_site_option("\x6d\x6f\x5f\163\141\x6d\x6c\137\155\145\163\x73\141\x67\x65", "\x53\151\x67\x6e\40\x69\x6e\40\x6f\x70\x74\x69\x6f\156\x73\40\x75\x70\x64\x61\x74\145\144\56");
        $this->mo_saml_show_success_message();
        ZW:
        x1:
        goto lt;
        Xu:
        if (mo_saml_is_sp_configured()) {
            goto PV;
        }
        update_site_option("\155\x6f\x5f\163\141\x6d\154\137\x6d\145\x73\163\x61\147\145", "\x50\x6c\x65\x61\163\145\x20\x63\x6f\x6d\x70\154\145\164\145\x20\74\141\x20\x68\162\145\x66\75\42" . add_query_arg(array("\x74\x61\x62" => "\163\x61\166\145"), $_SERVER["\x52\105\121\125\x45\x53\x54\137\125\x52\x49"]) . "\x22\x20\57\x3e\x53\145\x72\x76\151\143\x65\40\x50\162\x6f\166\151\x64\145\162\x3c\57\x61\76\40\x63\x6f\156\146\151\147\165\x72\x61\x74\151\x6f\x6e\x20\x66\151\162\163\164\x2e");
        goto cF;
        PV:
        $Ck = "\x66\x61\154\163\x65";
        if (array_key_exists("\155\157\x5f\x73\x61\155\154\137\x65\x6e\x61\142\154\145\137\144\x6f\155\x61\151\156\x5f\x6d\141\160\x70\x69\x6e\x67", $_POST)) {
            goto dL;
        }
        $Ck = "\146\141\x6c\x73\145";
        goto DI;
        dL:
        $Ck = $_POST["\155\157\x5f\163\141\155\154\137\x65\156\141\x62\154\x65\137\144\x6f\155\141\151\x6e\x5f\x6d\x61\160\x70\x69\x6e\147"];
        $U7 = get_site_option("\x6d\x6f\x5f\x73\x61\x6d\154\137\144\x6f\155\141\x69\x6e\137\x6c\157\x67\x69\x6e\137\146\x61\x69\154");
        if ($U7) {
            goto la;
        }
        update_site_option("\x6d\x6f\137\163\141\155\x6c\x5f\x64\x6f\155\141\x69\x6e\137\x6c\x6f\x67\151\156\x5f\146\141\151\x6c", "\x74\x72\165\145");
        la:
        DI:
        update_site_option("\x6d\157\137\x73\x61\x6d\x6c\137\x65\156\141\x62\x6c\145\137\x64\x6f\155\141\151\156\137\155\141\x70\x70\x69\156\x67", $Ck);
        update_site_option("\155\157\137\163\141\155\154\x5f\x6d\x65\x73\x73\141\147\x65", "\123\151\147\156\40\151\x6e\40\x6f\x70\x74\x69\157\156\163\x20\165\x70\x64\141\164\145\x64\x2e");
        $this->mo_saml_show_success_message();
        cF:
        lt:
        goto cs;
        YZ:
        if (mo_saml_is_sp_configured()) {
            goto cm;
        }
        update_site_option("\x6d\157\137\163\x61\155\154\137\x6d\x65\163\x73\x61\147\145", "\120\x6c\145\x61\163\145\40\x63\x6f\155\160\154\x65\164\145\x20\x3c\141\40\x68\162\145\146\75\x22" . add_query_arg(array("\164\141\142" => "\x73\141\166\x65"), $_SERVER["\x52\x45\x51\125\105\x53\124\137\125\122\111"]) . "\42\40\57\x3e\123\x65\x72\166\x69\143\x65\x20\120\162\x6f\166\x69\x64\x65\x72\74\x2f\x61\76\x20\x63\x6f\x6e\146\x69\147\x75\162\x61\x74\151\157\156\x20\x66\x69\162\x73\x74\x2e");
        $this->mo_saml_show_error_message();
        goto cr;
        cm:
        $A7 = maybe_unserialize(get_site_option("\163\141\x6d\x6c\x5f\163\x73\157\137\x73\x65\164\x74\x69\x6e\x67\163"));
        if (!empty($A7)) {
            goto A0;
        }
        $A7 = array();
        A0:
        $I7 = "\x44\105\106\101\x55\114\124";
        if (!isset($_POST["\x73\x69\x74\x65"])) {
            goto Nt;
        }
        $I7 = htmlspecialchars($_POST["\x73\151\164\145"]);
        Nt:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\106\x41\125\x4c\x54"]))) {
            goto jN;
        }
        $A7[$I7] = $A7["\104\x45\106\101\x55\114\124"];
        jN:
        if (array_key_exists("\x6d\x6f\x5f\x73\141\x6d\154\137\x66\x6f\162\x63\145\137\x61\165\x74\x68\145\x6e\164\151\143\x61\x74\x69\x6f\x6e", $_POST)) {
            goto ro;
        }
        $kM = "\x66\141\x6c\x73\x65";
        goto r3;
        ro:
        $kM = htmlspecialchars($_POST["\155\x6f\x5f\x73\141\155\154\x5f\x66\x6f\x72\143\x65\x5f\141\165\164\x68\x65\156\x74\x69\x63\141\x74\x69\157\x6e"]);
        r3:
        if ($kM == "\x74\x72\x75\145") {
            goto Ud;
        }
        $A7[$I7]["\155\157\137\x73\x61\155\x6c\137\x66\x6f\162\x63\x65\137\x61\165\x74\150\145\156\x74\x69\x63\x61\164\x69\157\x6e"] = '';
        goto UO;
        Ud:
        $A7[$I7]["\155\x6f\x5f\x73\x61\155\x6c\x5f\146\157\x72\143\x65\x5f\x61\165\164\x68\x65\156\x74\151\x63\141\x74\x69\157\x6e"] = "\164\x72\165\x65";
        UO:
        update_site_option("\163\141\x6d\x6c\137\163\163\x6f\x5f\163\145\x74\x74\151\156\147\163", $A7);
        update_site_option("\x6d\157\137\x73\141\155\x6c\137\x6d\x65\163\163\x61\147\145", "\123\x69\x67\156\40\x69\156\x20\x6f\160\x74\x69\157\x6e\x73\x20\165\160\x64\141\x74\x65\x64\56");
        $this->mo_saml_show_success_message();
        cr:
        cs:
        goto My;
        eJ:
        if (mo_saml_is_sp_configured()) {
            goto q5;
        }
        update_site_option("\155\x6f\137\x73\x61\x6d\154\137\x6d\x65\x73\x73\141\x67\145", "\x50\x6c\x65\141\x73\x65\40\143\157\155\160\x6c\145\x74\145\40\74\141\x20\150\x72\145\146\75\x22" . add_query_arg(array("\164\x61\142" => "\163\x61\166\x65"), $_SERVER["\x52\x45\121\x55\105\123\124\137\125\x52\111"]) . "\42\x20\x2f\x3e\x53\145\162\166\151\143\x65\40\120\162\157\166\151\x64\145\162\74\57\x61\x3e\40\143\157\x6e\x66\151\147\x75\162\141\164\151\x6f\156\40\146\151\162\163\x74\x2e");
        $this->mo_saml_show_error_message();
        goto ch;
        q5:
        $A7 = maybe_unserialize(get_site_option("\x73\141\155\x6c\x5f\163\x73\157\x5f\163\145\164\164\x69\x6e\x67\x73"));
        if (!empty($A7)) {
            goto ib;
        }
        $A7 = array();
        ib:
        $I7 = "\x44\x45\x46\x41\x55\x4c\x54";
        if (!isset($_POST["\163\x69\164\x65"])) {
            goto AO;
        }
        $I7 = htmlspecialchars($_POST["\163\151\x74\145"]);
        AO:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\x46\101\125\x4c\124"]))) {
            goto HO;
        }
        $A7[$I7] = $A7["\104\x45\106\101\x55\x4c\124"];
        HO:
        if (array_key_exists("\x6d\157\137\x73\x61\x6d\x6c\x5f\163\165\142\x73\151\x74\145\x5f\x61\143\143\145\x73\x73\137\144\x65\x6e\151\x65\x64", $_POST)) {
            goto XS;
        }
        $Ov = "\x66\141\x6c\163\145";
        goto rZ;
        XS:
        $Ov = htmlspecialchars($_POST["\155\157\137\x73\x61\x6d\x6c\x5f\x73\x75\142\163\x69\x74\x65\137\141\x63\143\x65\163\x73\x5f\144\145\x6e\151\145\144"]);
        rZ:
        if ($Ov == "\x74\162\165\145") {
            goto yu;
        }
        $A7[$I7]["\x6d\157\137\x73\141\155\154\137\x73\x75\142\163\x69\164\145\137\141\x63\x63\145\163\x73\x5f\144\x65\x6e\151\x65\144"] = '';
        goto Jy;
        yu:
        $A7[$I7]["\x6d\x6f\137\x73\x61\x6d\154\137\x73\165\x62\x73\151\164\145\137\x61\143\x63\145\163\x73\x5f\144\x65\x6e\151\x65\x64"] = "\164\162\x75\145";
        Jy:
        update_site_option("\163\x61\155\154\137\163\x73\x6f\x5f\x73\145\164\164\x69\x6e\x67\163", $A7);
        update_site_option("\x6d\157\137\163\141\x6d\x6c\x5f\155\145\x73\x73\141\147\145", "\x53\x69\x67\156\x20\151\156\40\x6f\x70\164\151\x6f\x6e\163\x20\165\160\144\x61\164\x65\x64\56");
        $this->mo_saml_show_success_message();
        ch:
        My:
        goto mB;
        a2:
        if (mo_saml_is_sp_configured()) {
            goto Fw;
        }
        update_site_option("\155\x6f\x5f\x73\x61\155\x6c\x5f\x6d\x65\163\163\x61\x67\x65", "\120\x6c\145\x61\163\x65\x20\143\x6f\x6d\160\x6c\x65\164\x65\40\x3c\x61\x20\150\162\145\x66\75\42" . add_query_arg(array("\x74\x61\142" => "\163\141\166\145"), $_SERVER["\x52\x45\x51\x55\x45\123\124\137\x55\x52\x49"]) . "\42\x20\57\x3e\123\x65\x72\x76\151\x63\x65\x20\x50\x72\157\166\x69\144\x65\x72\74\57\141\x3e\x20\143\x6f\156\x66\x69\147\x75\162\x61\x74\151\157\x6e\x20\146\x69\x72\x73\164\x2e");
        $this->mo_saml_show_error_message();
        goto vY;
        Fw:
        if (array_key_exists("\x6d\157\x5f\163\141\x6d\x6c\137\162\145\147\151\x73\164\x65\x72\145\144\x5f\x6f\x6e\154\171\137\x61\x63\143\145\163\x73", $_POST)) {
            goto FT;
        }
        $kM = "\x66\x61\x6c\163\145";
        goto wW;
        FT:
        $kM = htmlspecialchars($_POST["\155\x6f\x5f\x73\x61\x6d\154\x5f\x72\145\147\x69\163\164\x65\x72\145\144\x5f\157\156\154\x79\x5f\x61\143\x63\145\163\163"]);
        wW:
        $A7 = maybe_unserialize(get_site_option("\x73\x61\155\154\137\x73\x73\x6f\137\x73\145\164\164\151\156\147\x73"));
        if (!empty($A7)) {
            goto Bc;
        }
        $A7 = array();
        Bc:
        $I7 = "\x44\x45\x46\101\x55\114\124";
        if (!isset($_POST["\163\151\164\x65"])) {
            goto Ro;
        }
        $I7 = htmlspecialchars($_POST["\163\151\x74\145"]);
        Ro:
        if (!(empty($A7[$I7]) && !empty($A7["\x44\105\106\x41\125\x4c\x54"]))) {
            goto ss;
        }
        $A7[$I7] = $A7["\104\105\x46\101\x55\114\124"];
        ss:
        if ($kM == "\x74\x72\x75\145") {
            goto dK;
        }
        $A7[$I7]["\155\x6f\137\x73\141\x6d\x6c\137\x72\145\x67\x69\x73\x74\x65\x72\x65\144\137\157\156\x6c\x79\137\x61\143\x63\x65\x73\163"] = '';
        goto LR;
        dK:
        $A7[$I7]["\x6d\x6f\x5f\163\x61\x6d\x6c\x5f\x72\x65\147\151\x73\x74\145\162\x65\x64\137\157\x6e\154\171\x5f\x61\143\143\145\x73\x73"] = "\164\162\x75\x65";
        LR:
        update_site_option("\163\x61\155\154\137\x73\163\157\137\163\x65\164\164\x69\x6e\x67\x73", $A7);
        update_site_option("\x6d\157\x5f\x73\141\x6d\154\137\155\145\x73\163\141\147\145", "\123\x69\147\156\x20\151\x6e\40\x6f\x70\164\151\157\156\x73\x20\165\160\144\x61\164\x65\144\x2e");
        $this->mo_saml_show_success_message();
        vY:
        mB:
        goto RJ;
        H8:
        if (mo_saml_is_extension_installed("\143\x75\x72\x6c")) {
            goto GO;
        }
        update_site_option("\x6d\157\x5f\163\141\x6d\154\x5f\155\145\163\x73\141\147\x65", "\x45\x52\122\x4f\x52\72\40\74\141\x20\x68\x72\145\x66\75\42\x68\x74\x74\160\72\57\57\x70\x68\x70\56\x6e\x65\x74\57\x6d\x61\x6e\x75\141\x6c\57\145\156\57\x63\165\162\x6c\56\x69\x6e\163\164\141\x6c\x6c\141\164\151\157\x6e\56\x70\x68\160\42\40\164\141\x72\147\145\164\75\42\137\x62\154\x61\x6e\153\42\x3e\x50\x48\120\x20\x63\x55\122\114\x20\x65\x78\x74\145\156\163\x69\157\156\74\x2f\141\76\40\151\x73\x20\156\x6f\x74\40\x69\156\x73\164\141\154\x6c\145\x64\x20\157\x72\40\144\x69\163\141\142\154\x65\x64\x2e\40\x52\145\x73\x65\x6e\144\40\117\x54\x50\x20\x66\x61\151\154\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        GO:
        $sR = sanitize_text_field($_POST["\160\150\157\156\x65"]);
        $sR = str_replace("\x20", '', $sR);
        $sR = str_replace("\x2d", '', $sR);
        update_site_option("\155\157\137\163\x61\155\154\137\x61\x64\155\x69\x6e\x5f\160\x68\x6f\156\145", $sR);
        $nI = new CustomerSaml();
        $sb = json_decode($nI->send_otp_token('', $sR, $this, FALSE, TRUE), true);
        if (strcasecmp($sb["\163\x74\141\x74\165\163"], "\x53\x55\x43\103\105\x53\123") == 0) {
            goto GY;
        }
        update_site_option("\x6d\x6f\137\x73\141\x6d\x6c\x5f\x6d\x65\x73\163\x61\x67\x65", "\124\x68\145\162\145\40\x77\141\x73\x20\x61\156\x20\x65\x72\x72\157\162\x20\151\x6e\40\x73\x65\x6e\x64\151\156\x67\40\123\115\x53\56\40\120\154\145\141\163\145\40\143\x6c\151\x63\153\40\x6f\x6e\40\x52\x65\163\x65\x6e\144\x20\x4f\124\120\x20\164\157\x20\x74\x72\x79\x20\x61\x67\141\x69\x6e\x2e");
        update_site_option("\155\x6f\137\163\x61\x6d\154\137\x72\145\x67\151\x73\164\162\141\x74\x69\157\156\137\x73\164\141\164\x75\x73", "\x4d\117\137\117\x54\120\x5f\x44\x45\114\111\126\x45\122\x45\104\137\x46\101\111\114\125\122\105\137\x50\x48\117\x4e\105");
        $this->mo_saml_show_error_message();
        goto qZ;
        GY:
        update_site_option("\x6d\x6f\137\x73\141\155\x6c\137\155\x65\x73\x73\141\147\145", "\40\101\x20\157\x6e\145\40\x74\151\155\145\x20\160\141\163\163\143\157\x64\145\40\x69\163\x20\163\x65\156\x74\x20\164\157\x20" . get_site_option("\x6d\157\137\163\x61\x6d\154\x5f\x61\144\x6d\151\156\x5f\x70\x68\x6f\156\145") . "\x2e\40\x50\154\x65\141\x73\145\40\145\x6e\x74\145\x72\x20\164\x68\145\40\157\x74\x70\40\x68\145\162\x65\x20\x74\x6f\x20\166\x65\162\151\x66\x79\x20\x79\x6f\165\x72\40\x65\x6d\x61\x69\x6c\x2e");
        update_site_option("\155\157\x5f\163\141\155\x6c\137\164\162\x61\156\163\141\x63\164\x69\157\156\111\x64", $sb["\x74\x78\111\144"]);
        update_site_option("\x6d\157\137\163\141\155\x6c\x5f\x72\x65\147\x69\x73\x74\x72\141\164\x69\157\x6e\137\163\x74\x61\x74\x75\x73", "\x4d\x4f\x5f\x4f\124\x50\x5f\104\105\114\x49\126\x45\122\105\104\x5f\x53\125\x43\103\x45\123\x53\137\120\110\117\x4e\x45");
        $this->mo_saml_show_success_message();
        qZ:
        RJ:
        goto pk;
        Db:
        update_site_option("\155\x6f\137\x73\x61\x6d\154\137\162\x65\147\x69\163\164\x72\141\164\x69\x6f\x6e\x5f\x73\x74\141\164\x75\x73", '');
        update_site_option("\155\x6f\137\x73\x61\x6d\154\x5f\x76\x65\x72\x69\146\x79\137\x63\x75\163\164\x6f\x6d\145\162", '');
        delete_site_option("\155\x6f\137\x73\141\155\x6c\137\x6e\x65\167\x5f\162\x65\x67\x69\163\x74\162\141\164\x69\157\x6e");
        delete_site_option("\155\x6f\x5f\163\x61\x6d\154\x5f\141\144\155\x69\156\x5f\x65\x6d\141\x69\154");
        delete_site_option("\x6d\157\137\x73\x61\x6d\x6c\x5f\x61\144\x6d\151\x6e\137\160\150\157\x6e\x65");
        delete_site_option("\163\155\154\x5f\x6c\153");
        delete_site_option("\x74\137\x73\151\x74\x65\x5f\163\164\x61\164\x75\163");
        delete_site_option("\163\151\x74\145\137\143\x6b\137\x6c");
        delete_site_option("\156\157\137\x73\142\163");
        delete_site_option("\165\163\145\162\x5f\141\154\145\162\x74\137\x65\155\141\x69\x6c\x5f\x73\x65\156\x74");
        delete_site_option("\154\x69\143\145\x6e\x73\145\137\x61\154\x65\162\x74\137\145\155\x61\x69\154\137\x73\x65\x6e\x74");
        delete_site_option("\155\x6f\137\x73\141\155\x6c\137\141\x6c\x65\162\x74\137\x73\x65\x6e\x74\137\x66\x6f\162\x5f\x6f\156\145");
        delete_site_option("\155\x6f\x5f\163\x61\x6d\154\x5f\141\154\145\162\x74\x5f\x73\x65\156\x74\x5f\x66\x6f\x72\x5f\164\x77\157");
        delete_site_option("\155\x6f\137\163\x61\155\x6c\137\165\163\162\137\x6c\155\x74");
        pk:
        goto vF;
        sM:
        if (mo_saml_is_extension_installed("\143\165\162\x6c")) {
            goto yM;
        }
        update_site_option("\x6d\x6f\x5f\x73\141\x6d\154\x5f\155\x65\x73\x73\141\x67\x65", "\105\122\x52\x4f\x52\72\x20\x3c\141\40\x68\162\145\146\x3d\42\150\x74\164\x70\x3a\57\x2f\x70\x68\160\x2e\156\145\x74\57\155\141\156\x75\141\154\x2f\145\x6e\57\x63\x75\162\x6c\56\151\156\163\164\x61\154\x6c\x61\164\x69\x6f\156\56\x70\150\x70\x22\x20\x74\x61\162\147\145\x74\x3d\x22\137\142\154\x61\156\x6b\x22\x3e\120\110\x50\x20\143\125\x52\114\40\x65\170\x74\145\x6e\x73\x69\x6f\x6e\x3c\x2f\x61\x3e\40\x69\163\40\x6e\x6f\x74\x20\151\x6e\163\164\x61\x6c\x6c\145\144\40\x6f\162\x20\144\151\163\x61\142\154\x65\x64\56\40\x52\x65\x73\145\156\x64\x20\117\124\120\40\x66\141\x69\154\145\144\56");
        $this->mo_saml_show_error_message();
        return;
        yM:
        $sR = get_site_option("\x6d\x6f\x5f\x73\x61\x6d\154\137\141\144\155\x69\156\137\x70\150\x6f\156\145");
        $nI = new CustomerSaml();
        $sb = json_decode($nI->send_otp_token('', $sR, $this, FALSE, TRUE), true);
        if (strcasecmp($sb["\163\164\141\164\x75\x73"], "\x53\125\103\x43\x45\123\123") == 0) {
            goto Qk;
        }
        update_site_option("\x6d\x6f\x5f\163\x61\x6d\154\x5f\155\145\x73\x73\141\x67\x65", "\x54\150\x65\x72\x65\x20\167\141\x73\x20\x61\x6e\40\x65\162\x72\x6f\162\x20\151\156\x20\x73\145\x6e\x64\x69\156\x67\40\x65\155\x61\151\154\56\40\120\x6c\x65\x61\x73\x65\x20\143\154\x69\x63\153\40\157\x6e\40\x52\x65\x73\145\x6e\x64\40\117\124\120\x20\164\x6f\x20\164\x72\171\x20\x61\147\x61\x69\156\x2e");
        update_site_option("\155\x6f\x5f\163\141\x6d\x6c\x5f\x72\145\147\x69\x73\164\162\x61\164\x69\x6f\x6e\x5f\163\x74\x61\164\x75\163", "\x4d\117\137\117\124\x50\137\x44\x45\x4c\111\126\x45\x52\105\104\x5f\106\101\x49\114\125\x52\105\137\x50\x48\x4f\x4e\105");
        $this->mo_saml_show_error_message();
        goto fh;
        Qk:
        update_site_option("\155\157\x5f\x73\141\x6d\x6c\x5f\155\145\x73\163\x61\x67\x65", "\x20\x41\x20\x6f\156\145\x20\x74\x69\155\145\x20\x70\x61\x73\163\143\x6f\x64\145\40\151\x73\x20\x73\x65\156\x74\40\164\157\x20" . $sR . "\40\x61\x67\141\x69\156\56\40\x50\154\145\x61\163\145\x20\143\x68\145\143\153\40\x69\146\x20\171\x6f\x75\40\147\157\x74\40\x74\x68\x65\40\157\164\160\40\x61\x6e\x64\40\145\156\164\145\162\40\151\x74\40\x68\145\x72\145\x2e");
        update_site_option("\155\157\137\x73\x61\x6d\154\x5f\x74\162\x61\x6e\163\x61\143\164\x69\157\156\x49\144", $sb["\x74\170\x49\x64"]);
        update_site_option("\x6d\157\137\163\141\x6d\x6c\x5f\x72\145\x67\x69\163\164\x72\141\164\x69\157\x6e\137\163\164\x61\164\165\163", "\x4d\x4f\x5f\117\124\120\137\x44\105\114\x49\126\x45\122\105\104\137\123\x55\103\103\x45\x53\x53\137\120\x48\x4f\116\x45");
        $this->mo_saml_show_success_message();
        fh:
        vF:
        goto L9;
        XM:
        if (mo_saml_is_extension_installed("\143\165\x72\154")) {
            goto ak;
        }
        update_site_option("\x6d\x6f\x5f\x73\141\155\154\137\x6d\145\x73\163\x61\x67\x65", "\105\x52\x52\117\122\72\40\74\x61\x20\x68\162\145\146\75\42\150\x74\164\x70\x3a\x2f\57\x70\150\160\x2e\x6e\145\x74\57\155\141\x6e\x75\x61\x6c\x2f\x65\x6e\x2f\x63\165\x72\154\x2e\151\156\163\x74\x61\154\x6c\x61\164\151\157\x6e\x2e\x70\x68\x70\x22\x20\x74\141\162\x67\145\x74\x3d\x22\137\142\154\141\156\x6b\x22\76\x50\x48\120\40\x63\x55\x52\x4c\x20\145\x78\164\x65\x6e\x73\151\x6f\x6e\x3c\x2f\x61\76\40\x69\163\x20\x6e\157\164\x20\x69\156\163\x74\x61\154\154\x65\144\x20\x6f\162\x20\x64\x69\163\141\142\154\x65\x64\56\40\x52\x65\x73\x65\x6e\144\x20\117\x54\x50\x20\146\141\x69\x6c\x65\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        ak:
        $KC = get_site_option("\x6d\157\x5f\163\141\155\154\x5f\x61\x64\155\x69\x6e\x5f\145\x6d\141\x69\154");
        $nI = new CustomerSaml();
        $sb = json_decode($nI->send_otp_token($KC, '', $this), true);
        if (strcasecmp($sb["\163\x74\141\x74\x75\163"], "\123\125\103\103\105\123\123") == 0) {
            goto xI;
        }
        update_site_option("\x6d\157\137\163\x61\155\x6c\x5f\x6d\145\163\163\x61\147\145", "\124\x68\145\x72\145\40\167\x61\163\40\141\x6e\40\x65\162\x72\x6f\162\x20\x69\156\40\163\x65\156\x64\151\x6e\x67\x20\145\x6d\141\x69\x6c\x2e\40\x50\x6c\x65\141\x73\145\40\x63\x6c\151\143\153\40\x6f\x6e\40\122\x65\x73\x65\156\x64\x20\x4f\124\x50\x20\164\x6f\x20\164\x72\x79\x20\141\147\141\151\x6e\x2e");
        update_site_option("\155\157\x5f\163\141\155\154\137\162\x65\147\x69\163\x74\162\x61\x74\151\157\x6e\x5f\x73\164\141\164\x75\163", "\x4d\x4f\137\117\124\120\x5f\104\105\x4c\111\126\x45\x52\105\104\x5f\106\x41\111\114\x55\122\x45\137\x45\x4d\x41\111\114");
        $this->mo_saml_show_error_message();
        goto GE;
        xI:
        update_site_option("\x6d\157\137\x73\141\x6d\x6c\x5f\x6d\145\163\163\x61\147\x65", "\x20\x41\40\157\x6e\145\x20\x74\x69\155\145\x20\160\x61\163\x73\143\x6f\144\145\40\151\x73\x20\x73\145\x6e\x74\x20\164\157\x20" . get_site_option("\x6d\157\x5f\163\x61\155\x6c\137\x61\144\155\151\156\x5f\x65\155\141\x69\154") . "\40\x61\147\141\151\x6e\x2e\x20\x50\x6c\145\141\x73\145\x20\143\x68\x65\x63\153\x20\x69\x66\x20\171\x6f\x75\x20\x67\157\x74\40\164\150\x65\x20\x6f\x74\160\x20\x61\x6e\144\40\x65\156\164\x65\162\x20\x69\164\40\x68\x65\x72\145\x2e");
        update_site_option("\155\157\137\163\141\x6d\x6c\x5f\164\x72\x61\x6e\x73\x61\143\164\x69\x6f\156\x49\x64", $sb["\164\170\111\144"]);
        update_site_option("\155\157\x5f\163\x61\x6d\x6c\x5f\162\x65\147\x69\163\x74\162\x61\x74\x69\157\156\x5f\163\164\141\164\x75\163", "\x4d\x4f\137\x4f\x54\x50\137\x44\105\114\x49\x56\x45\122\x45\x44\137\123\125\x43\103\x45\x53\123\137\105\115\101\x49\114");
        $this->mo_saml_show_success_message();
        GE:
        L9:
        goto Mk;
        bc:
        if (mo_saml_is_extension_installed("\143\x75\162\x6c")) {
            goto vv;
        }
        update_site_option("\x6d\x6f\137\x73\x61\155\x6c\137\x6d\145\163\x73\x61\x67\x65", "\x45\122\122\x4f\x52\x3a\40\74\141\x20\x68\x72\x65\x66\x3d\x22\150\x74\x74\x70\72\x2f\x2f\160\x68\160\56\x6e\145\x74\57\155\141\x6e\x75\141\x6c\57\x65\156\57\x63\165\x72\154\56\x69\156\163\164\141\154\154\x61\164\x69\157\x6e\56\x70\150\160\42\x20\x74\141\162\147\x65\164\75\42\x5f\142\154\x61\156\153\42\x3e\x50\x48\x50\40\143\x55\122\x4c\x20\x65\x78\164\x65\x6e\163\x69\157\156\74\57\x61\x3e\x20\151\x73\40\156\157\164\x20\151\156\x73\x74\x61\154\154\x65\144\40\x6f\162\40\x64\x69\163\x61\142\154\145\144\56\40\121\165\145\162\171\40\x73\165\142\155\x69\164\x20\146\x61\x69\x6c\x65\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        vv:
        $KC = htmlspecialchars($_POST["\x6d\x6f\x5f\x73\141\155\x6c\137\x63\x6f\x6e\164\x61\143\x74\x5f\165\163\137\x65\155\x61\x69\x6c"]);
        $sR = htmlspecialchars($_POST["\155\157\137\x73\141\155\x6c\137\x63\x6f\x6e\164\x61\x63\164\137\x75\x73\137\x70\150\157\156\x65"]);
        $FB = htmlspecialchars($_POST["\x6d\x6f\137\x73\141\155\x6c\137\143\157\156\x74\141\143\x74\137\x75\163\137\161\165\145\x72\x79"]);
        if (array_key_exists("\x73\145\156\144\137\x70\x6c\165\x67\x69\x6e\137\143\x6f\156\146\x69\147", $_POST) === true) {
            goto JQ;
        }
        update_site_option("\x73\x65\156\144\x5f\x70\154\x75\x67\x69\x6e\137\x63\x6f\x6e\146\151\147", "\x6f\146\146");
        goto yQ;
        JQ:
        $QI = miniorange_import_export(true, true);
        $FB .= $QI;
        delete_site_option("\x73\145\x6e\144\x5f\x70\154\165\x67\x69\x6e\137\143\157\156\146\151\x67");
        yQ:
        $nI = new CustomerSaml();
        if ($this->mo_saml_check_empty_or_null($KC) || $this->mo_saml_check_empty_or_null($FB)) {
            goto lz;
        }
        $BZ = $nI->submit_contact_us($KC, $sR, $FB, $this);
        if ($BZ == false) {
            goto dQ;
        }
        update_site_option("\x6d\157\x5f\163\x61\155\154\137\x6d\145\x73\x73\x61\x67\145", "\x54\150\141\x6e\x6b\163\x20\x66\x6f\x72\40\x67\145\x74\x74\151\156\147\40\x69\156\x20\x74\157\x75\x63\x68\x21\40\127\x65\40\x73\150\141\x6c\154\x20\147\x65\164\40\142\x61\143\153\x20\x74\157\x20\x79\x6f\165\x20\163\x68\157\x72\x74\x6c\171\56");
        $this->mo_saml_show_success_message();
        goto yL;
        dQ:
        update_site_option("\155\x6f\x5f\163\141\x6d\x6c\137\x6d\145\x73\x73\x61\147\145", "\131\x6f\x75\x72\40\x71\165\145\162\171\x20\x63\x6f\165\x6c\x64\x20\x6e\157\164\40\142\x65\x20\163\165\142\x6d\151\164\x74\145\144\x2e\40\120\154\x65\x61\x73\145\40\164\162\x79\x20\141\147\141\x69\156\56");
        $this->mo_saml_show_error_message();
        yL:
        goto aT;
        lz:
        update_site_option("\155\157\x5f\x73\141\155\154\x5f\155\x65\x73\x73\141\x67\x65", "\x50\x6c\145\141\163\x65\x20\146\x69\x6c\x6c\40\165\x70\x20\x45\155\141\x69\x6c\x20\x61\156\x64\x20\121\x75\x65\162\x79\40\x66\x69\145\154\x64\163\x20\x74\x6f\40\163\x75\x62\x6d\x69\164\x20\171\x6f\165\162\x20\x71\x75\145\x72\x79\x2e");
        $this->mo_saml_show_error_message();
        aT:
        Mk:
        goto ri;
        CP:
        if (mo_saml_is_extension_installed("\143\165\162\154")) {
            goto UF;
        }
        update_site_option("\x6d\157\x5f\x73\x61\x6d\x6c\137\x6d\145\x73\163\141\147\145", "\x45\x52\x52\117\122\x3a\x20\74\141\40\x68\162\145\x66\x3d\42\150\164\x74\160\x3a\x2f\x2f\160\150\160\x2e\156\145\x74\57\155\141\156\x75\141\154\x2f\x65\x6e\x2f\143\165\162\x6c\56\x69\x6e\163\x74\x61\x6c\154\141\x74\151\157\156\x2e\x70\x68\160\42\40\x74\x61\x72\x67\x65\x74\75\42\x5f\x62\154\141\156\x6b\x22\x3e\x50\110\x50\x20\x63\125\x52\x4c\x20\145\x78\x74\x65\x6e\163\151\157\156\74\57\141\76\40\x69\x73\40\x6e\157\164\40\151\156\163\x74\x61\x6c\x6c\x65\144\x20\x6f\x72\x20\x64\151\163\x61\x62\x6c\x65\x64\56\40\114\x6f\x67\151\156\40\x66\141\x69\x6c\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        UF:
        $KC = '';
        $fK = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\x65\x6d\141\151\154"]) || $this->mo_saml_check_empty_or_null($_POST["\x70\141\163\x73\x77\157\x72\144"])) {
            goto Fi;
        }
        if ($this->checkPasswordPattern(strip_tags($_POST["\160\141\x73\x73\x77\x6f\162\x64"]))) {
            goto iI;
        }
        $KC = sanitize_email($_POST["\145\155\x61\151\x6c"]);
        $fK = stripslashes(strip_tags($_POST["\160\x61\163\163\x77\x6f\162\144"]));
        goto yt;
        iI:
        update_site_option("\155\157\x5f\x73\141\155\154\x5f\x6d\145\x73\163\x61\147\145", "\115\151\x6e\151\155\x75\155\40\x36\40\x63\150\141\162\141\143\x74\x65\x72\163\x20\x73\x68\157\165\x6c\144\x20\142\x65\x20\x70\162\145\x73\x65\x6e\164\56\x20\115\141\170\x69\x6d\165\155\40\61\x35\40\x63\x68\x61\x72\x61\143\x74\x65\x72\163\40\x73\150\157\165\x6c\x64\x20\142\145\x20\160\162\x65\163\x65\x6e\x74\x2e\40\117\156\x6c\x79\40\x66\x6f\x6c\x6c\x6f\x77\x69\x6e\147\x20\163\171\155\142\157\x6c\x73\40\x28\x21\100\x23\x2e\44\x25\136\x26\x2a\x2d\x5f\51\x20\x73\x68\x6f\x75\x6c\x64\x20\142\145\x20\x70\x72\145\x73\x65\156\164\x2e");
        $this->mo_saml_show_error_message();
        return;
        yt:
        goto vM;
        Fi:
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\x5f\155\145\163\x73\x61\147\145", "\x41\154\154\40\x74\x68\145\40\146\x69\145\x6c\144\x73\40\141\162\x65\x20\162\145\x71\165\151\x72\145\144\56\x20\x50\x6c\x65\x61\x73\145\x20\145\x6e\164\x65\x72\x20\x76\141\x6c\151\x64\40\x65\156\x74\162\151\145\x73\56");
        $this->mo_saml_show_error_message();
        return;
        vM:
        update_site_option("\x6d\x6f\137\163\x61\x6d\154\x5f\x61\144\x6d\x69\x6e\137\x65\x6d\x61\x69\x6c", $KC);
        update_site_option("\155\x6f\137\163\141\x6d\154\x5f\x61\x64\155\x69\x6e\x5f\x70\141\x73\x73\167\x6f\x72\x64", $fK);
        $nI = new Customersaml();
        $sb = $nI->get_customer_key($this);
        if ($sb) {
            goto qG;
        }
        return;
        qG:
        $Pd = json_decode($sb, true);
        if (json_last_error() == JSON_ERROR_NONE) {
            goto VP;
        }
        update_site_option("\x6d\x6f\x5f\163\x61\155\154\x5f\155\x65\163\x73\141\147\x65", "\111\156\166\141\x6c\x69\144\40\165\163\x65\x72\x6e\141\155\x65\x20\x6f\162\40\160\141\x73\163\x77\157\x72\144\x2e\x20\120\x6c\x65\141\x73\x65\40\164\x72\x79\40\x61\x67\141\151\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto M0;
        VP:
        update_site_option("\x6d\x6f\x5f\x73\141\x6d\154\137\x61\x64\x6d\151\x6e\x5f\143\x75\163\164\157\x6d\x65\x72\137\x6b\x65\171", $Pd["\151\144"]);
        update_site_option("\155\x6f\x5f\x73\141\155\154\137\x61\x64\155\x69\156\137\x61\160\151\137\x6b\x65\x79", $Pd["\141\x70\x69\113\x65\171"]);
        update_site_option("\155\x6f\x5f\x73\x61\155\x6c\137\143\x75\163\164\x6f\155\x65\x72\137\x74\157\153\x65\156", $Pd["\x74\157\153\x65\156"]);
        update_site_option("\155\157\137\x73\x61\x6d\154\x5f\141\x64\x6d\151\x6e\137\x70\141\x73\x73\x77\x6f\162\x64", '');
        update_site_option("\x6d\157\x5f\163\141\155\154\137\155\145\x73\163\x61\147\145", "\x43\x75\x73\164\157\x6d\145\x72\x20\x72\x65\x74\x72\x69\x65\166\x65\x64\40\x73\x75\x63\143\145\163\x73\x66\x75\154\x6c\171");
        update_site_option("\155\x6f\x5f\x73\141\x6d\154\x5f\162\145\147\x69\163\164\x72\x61\164\151\157\x6e\137\x73\x74\141\x74\x75\x73", "\105\x78\151\163\164\151\x6e\x67\x20\x55\163\x65\x72");
        delete_site_option("\x6d\x6f\137\163\x61\x6d\x6c\137\166\x65\x72\x69\x66\x79\x5f\143\x75\x73\164\157\x6d\145\x72");
        if (get_site_option("\x73\155\x6c\137\x6c\153")) {
            goto T5;
        }
        $this->mo_saml_show_success_message();
        goto xD;
        T5:
        $FE = get_site_option("\155\x6f\x5f\x73\141\x6d\x6c\x5f\x63\165\x73\x74\x6f\x6d\145\162\137\x74\x6f\153\145\x6e");
        $wk = AESEncryption::decrypt_data(get_site_option("\x73\155\154\x5f\154\x6b"), $FE);
        $yO = add_query_arg(array("\x74\x61\142" => "\154\x69\143\145\156\163\x69\156\147"), $_SERVER["\122\x45\x51\x55\105\x53\124\x5f\x55\x52\111"]);
        $D3 = $nI->mo_saml_verify_license($wk, $this);
        if ($D3) {
            goto eL;
        }
        return;
        eL:
        $sb = json_decode($D3, true);
        if (strcasecmp($sb["\163\164\141\x74\x75\x73"], "\x53\x55\x43\x43\x45\x53\x53") == 0) {
            goto jY;
        }
        update_site_option("\x6d\157\x5f\x73\141\x6d\154\x5f\x6d\x65\163\163\x61\147\145", "\114\151\x63\145\x6e\163\x65\40\x6b\145\x79\x20\x66\157\x72\40\164\x68\x69\163\40\151\156\163\x74\x61\x6e\x63\x65\x20\x69\163\x20\151\x6e\x63\157\x72\x72\145\143\164\x2e\x20\115\141\153\145\40\x73\165\162\x65\x20\x79\157\165\40\150\141\166\145\40\x6e\157\164\40\x74\x61\155\160\x65\x72\x65\x64\x20\x77\x69\x74\150\40\151\164\x20\x61\164\x20\141\154\x6c\56\x20\x50\x6c\x65\141\x73\x65\40\x65\x6e\164\145\x72\40\141\x20\x76\x61\154\151\144\40\154\x69\x63\x65\156\x73\x65\40\153\x65\171\56");
        delete_site_option("\163\155\x6c\137\x6c\153");
        $this->mo_saml_show_error_message();
        goto W8;
        jY:
        $this->mo_saml_show_success_message();
        W8:
        xD:
        M0:
        update_site_option("\x6d\157\137\x73\x61\155\x6c\x5f\x61\x64\155\151\x6e\137\x70\141\x73\163\x77\157\x72\144", '');
        ri:
        if (!get_site_option("\x6e\157\x5f\x73\x62\163")) {
            goto zG;
        }
        $FE = get_site_option("\x6d\x6f\137\x73\x61\x6d\x6c\137\143\165\x73\x74\x6f\155\x65\162\137\x74\x6f\x6b\145\x6e");
        $FF = AESEncryption::decrypt_data(get_site_option("\156\x6f\137\163\142\x73"), $FE);
        $dE = count(Utilities::get_sites());
        if (!($FF < $dE)) {
            goto vs;
        }
        if (get_site_option("\x6c\x69\143\x65\x6e\163\145\x5f\x61\x6c\145\162\164\x5f\145\155\x61\151\154\x5f\163\145\156\164")) {
            goto lO;
        }
        $nI = new Customersaml();
        $nI->mo_saml_send_alert_email_for_license($FF, $this);
        lO:
        vs:
        zG:
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\x73\x61\x6d\154\137\166\145\162\151\x66\x79\137\x6c\x69\143\x65\156\163\x65")) {
            goto ds;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\x5f\163\141\155\154\x5f\146\x72\x65\145\x5f\164\x72\151\141\x6c")) {
            goto q0;
        }
        if (!self::mo_check_option_admin_referer("\x6d\157\137\x73\x61\x6d\154\137\x63\x68\145\x63\153\137\x6c\x69\x63\145\x6e\163\x65")) {
            goto Fk;
        }
        $nI = new Customersaml();
        $D3 = $nI->check_customer_ln($this);
        if ($D3) {
            goto nG;
        }
        return;
        nG:
        $sb = json_decode($D3, true);
        if (strcasecmp($sb["\163\x74\x61\x74\x75\x73"], "\123\125\x43\x43\x45\x53\123") == 0) {
            goto cb;
        }
        $FE = get_site_option("\155\157\137\x73\x61\155\x6c\x5f\143\165\163\164\157\155\x65\162\137\164\x6f\x6b\145\156");
        $yO = add_query_arg(array("\164\x61\x62" => "\x6c\151\143\x65\x6e\x73\151\x6e\147"), $_SERVER["\x52\105\x51\125\x45\x53\x54\137\125\122\111"]);
        update_site_option("\x6d\157\x5f\163\141\155\x6c\x5f\x6d\x65\x73\163\x61\147\x65", "\x59\157\x75\40\150\x61\x76\x65\40\x6e\157\x74\40\165\x70\147\162\x61\x64\x65\x64\40\171\145\164\56\40\x3c\x61\x20\150\x72\145\146\x3d\x22" . $yO . "\x22\76\x43\154\x69\x63\x6b\x20\150\145\162\145\74\x2f\x61\76\40\164\x6f\x20\165\x70\x67\x72\141\x64\145\x20\164\157\40\x70\x72\145\x6d\151\x75\x6d\40\166\x65\162\x73\151\157\156\x2e");
        $this->mo_saml_show_error_message();
        goto ab;
        cb:
        if (!array_key_exists("\151\163\115\165\154\x74\x69\123\x69\164\x65\120\154\165\147\x69\156\x52\145\161\x75\145\x73\x74\x65\x64", $sb)) {
            goto Ix;
        }
        $wm = $sb["\x69\163\115\165\154\x74\x69\123\151\x74\145\x50\x6c\x75\x67\x69\x6e\122\x65\x71\x75\x65\163\164\x65\x64"];
        Ix:
        $dE = count(Utilities::get_sites());
        if ($wm && array_key_exists("\x6e\x6f\x4f\146\x53\165\x62\x53\x69\x74\145\x73", $sb) && $dE <= $sb["\156\157\117\x66\x53\x75\142\x53\x69\164\145\x73"]) {
            goto Rw;
        }
        $FE = get_site_option("\155\157\x5f\163\x61\x6d\x6c\x5f\143\165\x73\164\x6f\x6d\145\x72\137\x74\x6f\x6b\x65\x6e");
        if (empty($k0)) {
            goto D1;
        }
        update_site_option("\x6e\x6f\x5f\x73\142\x73", AESEncryption::encrypt_data($k0, $FE));
        D1:
        update_site_option("\163\151\x74\x65\137\143\153\x5f\154", AESEncryption::encrypt_data("\x66\x61\154\163\x65", $FE));
        $yO = add_query_arg(array("\164\141\142" => "\154\151\x63\145\156\x73\151\x6e\147"), $_SERVER["\x52\105\121\x55\105\123\124\x5f\x55\x52\x49"]);
        update_site_option("\x6d\x6f\137\x73\141\155\x6c\137\x6d\x65\163\163\141\x67\x65", "\131\x6f\x75\40\150\x61\166\x65\x20\x6e\x6f\x74\40\x75\x70\x67\162\141\144\x65\x64\x20\164\157\x20\x74\x68\145\x20\x63\x6f\162\162\x65\x63\164\x20\154\151\x63\145\156\x73\x65\40\160\x6c\141\x6e\x2e\x20\x45\151\164\x68\x65\162\40\171\157\165\x20\x68\x61\166\145\x20\x70\165\162\143\150\141\x73\x65\x64\40\146\157\162\40\x69\x6e\x63\157\x72\x72\x65\x63\164\x20\156\x6f\56\x20\157\146\x20\x73\151\x74\x65\x73\x20\x6f\x72\x20\171\157\x75\40\x68\x61\x76\x65\40\156\x6f\164\40\x73\x65\x6c\x65\143\164\145\144\x20\x6d\x75\154\164\x69\x73\151\164\x65\x20\x6f\160\164\151\x6f\x6e\x20\167\x68\x69\154\145\40\160\x75\162\143\x68\x61\163\151\x6e\147\x2e\40\74\x61\40\150\162\x65\x66\75\42\x23\x22\40\157\156\x63\154\x69\143\x6b\75\42\x67\x65\164\165\x70\x67\x72\x61\x64\145\154\x69\x63\x65\156\163\x65\163\x66\x6f\162\x6d\50\51\x22\76\x43\154\151\143\153\40\x68\x65\x72\x65\x3c\57\x61\76\40\x74\x6f\40\x75\x70\x67\162\141\x64\145\x20\x74\157\x20\160\x72\x65\155\x69\x75\x6d\x20\x76\x65\x72\163\151\157\156\56");
        $this->mo_saml_show_error_message();
        goto ys;
        Rw:
        $FE = get_site_option("\155\x6f\137\x73\x61\x6d\x6c\137\143\x75\163\164\157\x6d\145\162\137\x74\157\153\x65\x6e");
        $k0 = $sb["\x6e\157\x4f\146\x53\x75\x62\123\151\164\x65\163"];
        if (!(array_key_exists("\x6c\x69\x63\x65\x6e\x73\145\105\x78\x70\x69\x72\171", $sb) && !$this->mo_saml_check_empty_or_null($sb["\x6c\x69\x63\x65\x6e\163\x65\x45\170\x70\x69\x72\171"]))) {
            goto Vy;
        }
        $pG = $this->mo_saml_parse_expiry_date($sb["\x6c\x69\x63\x65\x6e\x73\145\x45\x78\x70\151\162\x79"]);
        update_site_option("\x6d\157\137\163\141\155\x6c\x5f\x6c\x69\x63\145\156\x73\145\137\x65\170\160\151\x72\171\137\x64\141\164\x65", $pG);
        update_site_option("\155\x6f\137\163\x61\x6d\154\x5f\163\154\145", $this->is_license_expired($sb["\154\x69\143\x65\x6e\163\x65\105\170\x70\151\x72\x79"]));
        Vy:
        update_site_option("\x73\x69\x74\145\x5f\x63\x6b\137\154", AESEncryption::encrypt_data("\x74\x72\165\x65", $FE));
        update_site_option("\x6e\157\x5f\x73\142\163", AESEncryption::encrypt_data($k0, $FE));
        $yO = add_query_arg(array("\164\141\142" => "\x6c\x6f\147\x69\x6e"), $_SERVER["\x52\x45\121\x55\105\123\x54\x5f\125\x52\111"]);
        update_site_option("\155\157\137\x73\x61\155\154\137\155\145\163\x73\141\x67\x65", "\131\157\165\40\150\x61\x76\x65\40\163\x75\143\x63\x65\163\163\146\x75\x6c\154\x79\x20\165\x70\147\x72\x61\x64\x65\144\x20\x74\157\40\160\x72\145\155\151\165\x6d\x20\x76\x65\162\x73\x69\x6f\x6e\x2e");
        $this->mo_saml_show_success_message();
        ys:
        ab:
        Fk:
        goto Bv;
        q0:
        if (decryptSamlElement()) {
            goto SN;
        }
        $wk = postResponse();
        $nI = new Customersaml();
        $D3 = $nI->mo_saml_verify_license($wk, $this);
        $sb = json_decode($D3, true);
        if (strcasecmp($sb["\163\x74\x61\x74\165\x73"], "\x53\125\103\103\x45\x53\123") == 0) {
            goto ZG;
        }
        if (strcasecmp($sb["\x73\164\x61\x74\x75\163"], "\106\101\111\114\105\x44") == 0) {
            goto G5;
        }
        update_site_option("\x6d\157\137\163\x61\x6d\154\x5f\x6d\x65\163\x73\x61\147\x65", "\x41\x6e\x20\145\x72\162\x6f\x72\40\157\143\143\165\162\x65\x64\x20\167\x68\x69\x6c\145\x20\x70\162\157\x63\145\163\163\x69\156\147\x20\171\157\165\162\40\x72\145\x71\x75\145\x73\164\56\x20\120\x6c\x65\141\163\x65\40\x54\162\x79\40\x61\147\x61\x69\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto SW;
        G5:
        update_site_option("\x6d\157\x5f\x73\141\x6d\x6c\137\155\x65\163\x73\141\147\x65", "\124\x68\145\162\145\40\x77\141\x73\40\x61\156\x20\x65\x72\x72\x6f\x72\40\141\x63\x74\x69\x76\x61\164\151\x6e\x67\x20\171\157\x75\162\40\124\x52\111\x41\x4c\x20\166\x65\x72\163\151\157\156\56\40\x50\154\x65\x61\163\x65\40\x63\157\x6e\x74\x61\x63\x74\x20\x69\x6e\x66\x6f\x40\155\x69\x6e\x69\x6f\162\141\x6e\147\145\56\x63\x6f\x6d\40\146\157\x72\x20\147\145\x74\x74\x69\156\x67\40\x6e\x65\x77\40\154\x69\143\145\156\163\x65\40\x66\x6f\x72\40\x74\162\151\x61\x6c\x20\166\145\x72\163\151\x6f\156\x2e");
        $this->mo_saml_show_error_message();
        SW:
        goto wF;
        ZG:
        $FE = get_site_option("\x6d\x6f\137\163\x61\155\x6c\137\143\165\x73\164\157\x6d\145\162\x5f\x74\157\153\145\156");
        $FE = get_site_option("\x6d\157\x5f\x73\141\x6d\x6c\x5f\x63\165\x73\x74\x6f\x6d\145\162\x5f\164\x6f\x6b\x65\156");
        update_site_option("\x74\x5f\163\151\x74\145\x5f\x73\164\141\164\x75\x73", AESEncryption::encrypt_data("\x74\x72\x75\x65", $FE));
        update_site_option("\x6d\x6f\137\x73\x61\155\x6c\x5f\155\x65\x73\x73\x61\147\145", "\x59\157\165\162\40\x35\x20\x64\x61\x79\x73\40\124\x52\x49\101\x4c\40\x69\163\40\x61\x63\x74\x69\x76\x61\x74\145\144\56\x20\x59\157\x75\x20\143\x61\x6e\40\x6e\x6f\x77\40\163\x65\x74\165\x70\40\x74\x68\145\40\160\x6c\165\x67\151\x6e\56");
        $this->mo_saml_show_success_message();
        wF:
        goto KS;
        SN:
        update_site_option("\155\x6f\x5f\163\x61\x6d\154\137\155\x65\x73\163\x61\147\x65", "\124\x68\x65\162\145\x20\x77\141\x73\x20\141\x6e\x20\145\x72\162\157\x72\x20\141\x63\x74\151\166\x61\164\151\x6e\x67\40\171\157\x75\x72\40\x54\x52\x49\101\x4c\x20\x76\x65\x72\163\151\x6f\x6e\56\x20\105\151\164\x68\145\x72\x20\x79\157\x75\162\x20\164\162\151\x61\154\40\x70\x65\x72\151\157\x64\40\x69\163\x20\x65\170\160\151\162\x65\x64\x20\157\x72\40\x79\157\165\x20\141\162\145\x20\x75\x73\151\x6e\147\x20\x77\x72\x6f\156\x67\40\x74\162\x69\x61\154\x20\166\x65\x72\163\151\x6f\156\56\40\x50\x6c\x65\x61\163\x65\40\x63\157\x6e\164\x61\143\x74\x20\151\156\x66\x6f\x40\x6d\x69\x6e\151\x6f\x72\141\x6e\x67\145\56\x63\157\x6d\40\146\x6f\162\40\147\x65\x74\x74\151\x6e\147\40\x6e\145\167\40\154\151\143\145\x6e\x73\x65\x20\146\157\x72\40\164\x72\151\141\x6c\40\166\145\162\163\x69\x6f\x6e\x2e");
        $this->mo_saml_show_error_message();
        KS:
        Bv:
        goto rq;
        ds:
        if (!$this->mo_saml_check_empty_or_null($_POST["\x73\141\155\154\x5f\x6c\151\143\145\156\x73\145\137\x6b\145\171"])) {
            goto Ul;
        }
        update_site_option("\x6d\x6f\x5f\163\141\155\154\137\x6d\x65\163\x73\141\x67\145", "\101\x6c\154\x20\164\150\145\x20\146\x69\x65\154\144\x73\x20\141\162\145\40\162\x65\161\x75\151\x72\x65\x64\x2e\40\120\154\145\x61\163\145\x20\x65\156\164\145\x72\40\x76\x61\x6c\151\144\40\x6c\x69\x63\145\x6e\x73\x65\40\x6b\145\x79\x2e");
        $this->mo_saml_show_error_message();
        return;
        Ul:
        $wk = trim($_POST["\163\141\155\x6c\137\154\151\x63\x65\x6e\x73\x65\x5f\x6b\x65\x79"]);
        $nI = new Customersaml();
        $D3 = $nI->check_customer_ln($this);
        if ($D3) {
            goto N4;
        }
        return;
        N4:
        $sb = json_decode($D3, true);
        $yO = add_query_arg(array("\164\141\142" => "\x6c\x69\143\145\x6e\163\x69\156\x67"), $_SERVER["\122\105\x51\125\105\123\124\137\125\122\x49"]);
        if (strcasecmp($sb["\163\x74\141\164\x75\163"], "\x53\125\103\x43\105\123\x53") == 0) {
            goto Ma;
        }
        $FE = get_site_option("\x6d\x6f\x5f\x73\x61\155\x6c\137\143\165\x73\164\157\x6d\145\x72\137\164\157\153\145\x6e");
        $yO = add_query_arg(array("\164\x61\x62" => "\154\x69\x63\x65\156\x73\151\x6e\147"), $_SERVER["\122\x45\121\x55\x45\x53\124\137\125\x52\x49"]);
        update_site_option("\155\157\137\x73\x61\x6d\x6c\137\x6d\145\163\163\x61\147\x65", "\131\157\x75\x20\150\141\166\x65\40\156\157\x74\x20\165\160\x67\162\x61\144\145\x64\40\171\x65\164\56\x20\x3c\141\40\150\x72\x65\146\x3d\x22" . $yO . "\42\x3e\x43\x6c\151\x63\x6b\x20\150\145\x72\x65\74\x2f\x61\x3e\x20\x74\x6f\40\x75\x70\x67\162\141\144\x65\x20\x74\x6f\40\x70\162\145\x6d\151\165\155\x20\x76\145\x72\163\151\157\156\x2e");
        $this->mo_saml_show_error_message();
        goto le;
        Ma:
        if (!array_key_exists("\x69\x73\115\165\x6c\x74\151\x53\151\164\x65\120\154\x75\x67\x69\x6e\122\145\161\165\145\x73\x74\145\144", $sb)) {
            goto P2;
        }
        $wm = $sb["\x69\163\x4d\165\x6c\164\x69\123\x69\x74\x65\120\154\165\x67\151\x6e\122\x65\x71\x75\145\x73\164\145\144"];
        P2:
        $dE = count(Utilities::get_sites());
        if ($wm && array_key_exists("\x6e\157\117\x66\x53\165\142\x53\x69\164\145\x73", $sb) && $dE <= $sb["\x6e\157\117\146\x53\x75\x62\123\151\x74\x65\x73"]) {
            goto wH;
        }
        $FF = $sb["\156\157\x4f\x66\123\x75\x62\x53\151\x74\x65\x73"];
        $FE = get_site_option("\155\x6f\x5f\163\141\155\x6c\x5f\x63\x75\163\x74\x6f\155\x65\x72\x5f\x74\157\153\145\156");
        update_site_option("\156\x6f\137\163\x62\163", AESEncryption::encrypt_data($FF, $FE));
        update_site_option("\x73\x6d\x6c\137\x6c\x6b", AESEncryption::encrypt_data($wk, $FE));
        update_site_option("\x73\151\164\145\137\143\153\137\154", AESEncryption::encrypt_data("\164\x72\x75\x65", $FE));
        update_site_option("\155\157\x5f\163\141\x6d\x6c\137\x6d\145\163\x73\141\x67\x65", "\131\157\x75\x20\x68\x61\x76\145\x20\x70\x75\x72\x63\150\x61\163\145\144\x20\x74\x68\145\40\154\x69\143\145\156\x73\145\40\x66\x6f\162\x20\x3c\142\x3e" . $sb["\156\x6f\x4f\146\123\165\x62\x53\x69\x74\x65\x73"] . "\x20\163\151\164\x65\x73\74\x2f\x62\x3e\x2e\40\x42\165\164\40\171\x6f\x75\40\x68\141\166\x65\40\x3c\142\76" . $dE . "\x20\74\x2f\x62\x3e\x73\151\x74\145\163\40\151\156\x20\171\157\165\162\40\155\x75\x6c\164\151\163\x69\164\145\x20\x6e\x65\164\167\157\x72\153\x2e\x20\x3c\141\40\x68\162\x65\x66\x3d\42\x23\x22\x20\157\156\x63\x6c\151\143\153\x3d\42\147\145\x74\165\160\147\162\141\144\145\154\x69\x63\x65\x6e\x73\x65\163\x66\157\x72\x6d\50\x29\x22\76\103\x6c\151\143\153\40\x68\x65\x72\145\x3c\57\141\x3e\40\x74\157\40\x62\165\x79\40\x6c\x69\143\x65\156\163\145\x20\x66\x6f\162\x20\155\157\162\x65\x20\163\151\164\x65\163\56");
        $this->mo_saml_show_error_message();
        goto qM;
        wH:
        $FF = $sb["\156\157\117\146\123\x75\142\123\x69\x74\x65\x73"];
        $FE = get_site_option("\x6d\157\x5f\x73\x61\155\154\137\x63\x75\x73\164\157\155\x65\162\137\x74\x6f\153\145\x6e");
        if (!array_key_exists("\156\x6f\117\x66\125\163\x65\162\163", $sb)) {
            goto kg;
        }
        $W0 = $sb["\156\x6f\x4f\x66\x55\x73\145\x72\x73"];
        kg:
        $D3 = $nI->mo_saml_verify_license($wk, $this);
        if ($D3) {
            goto cG;
        }
        return;
        cG:
        $sb = json_decode($D3, true);
        if (strcasecmp($sb["\x73\x74\141\x74\x75\163"], "\x53\x55\x43\x43\105\123\123") == 0) {
            goto DC;
        }
        if (strcasecmp($sb["\163\164\141\x74\x75\163"], "\x46\101\111\x4c\105\104") == 0) {
            goto Uo;
        }
        update_site_option("\x6d\x6f\137\x73\x61\x6d\x6c\x5f\x6d\145\163\163\141\x67\x65", "\101\x6e\40\x65\x72\x72\157\162\40\157\143\x63\x75\x72\145\x64\40\x77\150\x69\154\145\40\x70\162\x6f\x63\x65\163\163\151\156\147\40\171\157\165\162\x20\162\x65\x71\165\145\163\x74\56\40\120\x6c\x65\141\163\145\40\x54\x72\x79\x20\141\147\x61\151\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto o_;
        Uo:
        if (strcasecmp($sb["\x6d\x65\163\x73\141\147\x65"], "\103\157\x64\x65\x20\150\141\x73\40\x45\x78\x70\x69\162\x65\144") == 0) {
            goto wa;
        }
        update_site_option("\155\157\x5f\x73\x61\155\154\x5f\155\x65\x73\163\141\147\145", "\131\157\x75\x20\x68\141\166\145\40\x65\156\164\145\162\x65\x64\x20\141\x6e\x20\x69\156\166\141\154\x69\144\40\x6c\151\x63\x65\156\163\x65\40\153\145\171\56\40\x50\x6c\x65\141\163\145\40\x65\x6e\x74\x65\x72\40\x61\x20\166\x61\154\151\144\40\154\151\143\145\x6e\x73\x65\40\x6b\x65\171\x2e");
        goto dv;
        wa:
        update_site_option("\155\x6f\137\x73\141\155\154\137\x6d\145\163\x73\x61\x67\145", "\114\x69\x63\145\x6e\163\x65\x20\153\145\x79\40\x79\x6f\x75\40\x68\141\166\x65\x20\145\156\x74\x65\x72\x65\x64\40\x68\x61\163\40\141\154\x72\145\141\144\x79\40\x62\145\145\x6e\x20\x75\x73\145\144\56\x20\120\x6c\145\x61\x73\145\40\x65\156\x74\145\162\40\141\40\153\x65\x79\x20\x77\150\x69\x63\x68\40\x68\141\163\40\x6e\x6f\x74\x20\x62\145\145\x6e\x20\x75\163\145\x64\x20\142\145\146\x6f\x72\145\x20\157\156\x20\x61\156\171\40\x6f\164\150\x65\162\40\151\x6e\x73\164\141\156\x63\x65\40\157\x72\40\x69\x66\x20\x79\157\x75\x20\150\141\x76\x65\40\x65\170\x61\165\x73\x74\x65\x64\x20\141\x6c\x6c\40\171\157\x75\162\40\x6b\145\x79\x73\x20\x74\150\x65\156\40\x3c\141\x20\150\x72\145\x66\75\42\43\42\40\157\156\143\154\151\x63\x6b\75\x22\147\145\x74\x75\x70\147\x72\141\144\145\x6c\151\143\x65\156\x73\x65\163\146\x6f\162\155\x28\x29\x22\40\76\103\154\x69\143\x6b\40\150\145\162\145\x3c\x2f\141\x3e\40\x74\157\x20\x62\x75\171\x20\155\157\x72\x65\56");
        dv:
        $this->mo_saml_show_error_message();
        o_:
        goto T3;
        DC:
        if (!array_key_exists("\156\x6f\x4f\x66\x55\163\x65\162\163", $sb)) {
            goto kv;
        }
        update_site_option("\x6d\x6f\x5f\163\141\155\154\137\165\x73\x72\x5f\x6c\155\164", AESEncryption::encrypt_data($W0, $FE));
        kv:
        update_site_option("\x73\x6d\154\x5f\x6c\x6b", AESEncryption::encrypt_data($wk, $FE));
        update_site_option("\156\x6f\137\x73\x62\x73", AESEncryption::encrypt_data($FF, $FE));
        update_site_option("\x73\151\164\145\137\x63\153\x5f\x6c", AESEncryption::encrypt_data("\x74\162\165\145", $FE));
        update_site_option("\164\x5f\163\151\x74\x65\137\163\x74\x61\x74\165\163", AESEncryption::encrypt_data("\x66\141\154\x73\x65", $FE));
        update_site_option("\x6d\x6f\137\x73\141\155\x6c\137\155\x65\163\163\x61\147\145", "\131\x6f\x75\162\x20\x6c\151\x63\x65\x6e\163\x65\40\x69\x73\40\166\145\162\151\x66\x69\x65\x64\56\40\131\157\165\x20\143\141\156\40\x6e\x6f\x77\x20\x73\145\164\165\x70\x20\x74\x68\145\x20\x70\154\165\147\x69\x6e\x2e");
        $FE = get_site_option("\x6d\x6f\x5f\163\141\155\x6c\137\x63\x75\x73\164\x6f\x6d\x65\x72\137\x74\x6f\153\145\156");
        update_site_option("\x74\137\x73\x69\x74\x65\137\x73\164\x61\164\x75\163", AESEncryption::encrypt_data("\x66\141\x6c\x73\145", $FE));
        $this->mo_saml_show_success_message();
        T3:
        qM:
        le:
        rq:
        if (!(isset($_REQUEST["\x75\x70\144\141\164\x65"]) && "\141\x64\x64\x65\144" == $_REQUEST["\165\160\x64\x61\164\145"] && get_site_option("\155\157\137\x73\x61\x6d\154\137\x65\156\x61\x62\x6c\145\137\163\163\x6f\x5f\x6e\x65\167\x5f\163\x69\x74\x65") == "\164\162\165\x65")) {
            goto ML;
        }
        $QB = isset($_REQUEST["\x62\154\157\x67\x5b\144\x6f\155\141\151\x6e\x5d"]) ? $_REQUEST["\142\154\x6f\x67\x5b\x64\157\155\x61\x69\156\135"] : '';
        if (!isset($_REQUEST["\x69\144"])) {
            goto v_;
        }
        $HC = $_REQUEST["\151\x64"];
        v_:
        if (empty($HC)) {
            goto Hv;
        }
        $Qf = Utilities::get_active_sites();
        if (in_array($HC, $Qf)) {
            goto uI;
        }
        array_push($Qf, $HC);
        uI:
        update_site_option("\x6d\157\137\x65\x6e\x61\142\154\145\137\x73\163\x6f\137\163\x69\x74\145\163", $Qf);
        Hv:
        ML:
        DJ:
        if (mo_saml_is_trial_active()) {
            goto TN;
        }
        if (!site_check()) {
            goto Xe;
        }
        goto re;
        TN:
        if (!decryptSamlElement()) {
            goto vH;
        }
        $FE = get_site_option("\x6d\157\x5f\163\141\155\x6c\137\143\165\x73\164\157\x6d\x65\x72\x5f\x74\157\153\145\156");
        update_site_option("\x74\137\163\x69\164\145\137\x73\x74\x61\164\165\x73", AESEncryption::encrypt_data("\146\x61\x6c\163\x65", $FE));
        vH:
        goto re;
        Xe:
        delete_site_option("\155\157\137\163\x61\x6d\154\137\x65\156\141\142\154\x65\137\x6c\157\147\151\156\137\x72\145\144\151\x72\145\143\x74");
        delete_site_option("\155\x6f\137\x73\141\x6d\154\x5f\141\x6c\154\157\167\137\167\160\137\163\151\147\156\151\x6e");
        delete_site_option("\x6d\157\137\x73\x61\155\154\137\x72\145\147\x69\163\x74\145\x72\x65\x64\137\157\x6e\154\x79\137\141\143\143\145\x73\163");
        delete_site_option("\155\157\x5f\163\x61\155\x6c\x5f\x66\x6f\162\143\145\137\141\x75\x74\150\145\156\164\151\x63\x61\x74\x69\x6f\156");
        re:
    }
    function create_customer()
    {
        $nI = new CustomerSaml();
        $Pd = json_decode($nI->create_customer($this), true);
        if (strcasecmp($Pd["\163\164\141\164\x75\x73"], "\103\x55\x53\x54\117\x4d\x45\122\137\x55\x53\105\122\116\101\115\105\137\x41\114\x52\105\x41\104\131\137\x45\130\x49\123\x54\123") == 0) {
            goto IT;
        }
        if (!(strcasecmp($Pd["\x73\x74\141\164\165\163"], "\x53\x55\x43\x43\105\123\123") == 0)) {
            goto yG;
        }
        update_site_option("\155\157\137\x73\141\x6d\x6c\x5f\x61\x64\155\x69\x6e\137\x63\165\x73\x74\x6f\x6d\145\162\x5f\153\145\x79", $Pd["\x69\144"]);
        update_site_option("\x6d\157\137\x73\x61\x6d\x6c\x5f\141\x64\x6d\x69\x6e\137\x61\x70\151\x5f\153\145\x79", $Pd["\141\160\151\x4b\x65\x79"]);
        update_site_option("\x6d\157\137\163\x61\155\154\x5f\x63\165\163\x74\157\155\x65\162\137\164\x6f\153\x65\x6e", $Pd["\164\x6f\x6b\145\156"]);
        update_site_option("\x6d\x6f\137\163\x61\x6d\154\x5f\x61\x64\x6d\151\x6e\137\x70\141\163\163\x77\x6f\162\144", '');
        update_site_option("\155\x6f\x5f\x73\141\155\154\x5f\x6d\x65\x73\163\141\147\x65", "\x54\150\x61\156\153\40\171\157\165\40\146\157\x72\x20\162\x65\x67\x69\x73\x74\145\x72\151\156\147\40\167\151\164\150\x20\155\151\x6e\x69\157\162\x61\156\x67\145\56");
        update_site_option("\155\x6f\137\x73\141\x6d\154\137\x72\145\147\151\163\x74\x72\x61\164\151\157\x6e\137\x73\x74\141\x74\x75\163", '');
        delete_site_option("\155\x6f\137\x73\141\155\154\137\x76\145\x72\151\146\171\x5f\143\165\163\164\157\x6d\x65\162");
        delete_site_option("\155\x6f\137\x73\141\x6d\154\x5f\156\x65\x77\137\x72\145\x67\151\x73\x74\162\x61\164\151\157\156");
        $this->mo_saml_show_success_message();
        yG:
        goto Nr;
        IT:
        $this->get_current_customer();
        Nr:
        update_site_option("\155\x6f\x5f\x73\x61\x6d\154\137\x61\x64\155\x69\x6e\137\x70\141\163\163\167\157\x72\144", '');
    }
    function get_current_customer()
    {
        $nI = new CustomerSaml();
        $sb = $nI->get_customer_key($this);
        if ($sb) {
            goto kE;
        }
        return;
        kE:
        $Pd = json_decode($sb, true);
        if (json_last_error() == JSON_ERROR_NONE) {
            goto SF;
        }
        update_site_option("\x6d\x6f\x5f\x73\x61\155\154\x5f\155\145\x73\x73\141\147\145", "\131\x6f\x75\x20\x61\x6c\162\145\x61\144\171\x20\150\x61\x76\x65\40\x61\x6e\40\141\143\143\157\x75\156\164\40\167\151\164\150\x20\155\151\156\x69\117\x72\141\156\147\x65\x2e\x20\x50\154\x65\141\163\x65\x20\x65\156\x74\x65\x72\40\141\x20\166\141\154\151\x64\x20\160\x61\x73\x73\167\x6f\x72\144\x2e");
        update_site_option("\155\157\x5f\163\x61\155\x6c\137\x76\145\x72\151\146\171\137\x63\165\x73\x74\157\x6d\x65\162", "\164\x72\165\x65");
        delete_site_option("\x6d\157\x5f\163\141\x6d\x6c\x5f\x6e\145\x77\x5f\x72\x65\147\151\x73\164\162\x61\x74\x69\x6f\x6e");
        $this->mo_saml_show_error_message();
        goto gx;
        SF:
        update_site_option("\x6d\x6f\137\x73\x61\155\154\137\141\x64\155\151\156\x5f\x63\165\163\164\157\155\x65\x72\x5f\153\145\x79", $Pd["\151\x64"]);
        update_site_option("\155\x6f\x5f\163\x61\155\154\x5f\141\x64\155\x69\156\137\141\x70\151\137\x6b\x65\171", $Pd["\x61\160\151\x4b\145\171"]);
        update_site_option("\155\157\x5f\163\141\x6d\154\137\143\165\163\x74\157\155\x65\x72\137\164\x6f\x6b\145\156", $Pd["\x74\157\x6b\145\x6e"]);
        update_site_option("\x6d\157\x5f\163\x61\155\154\x5f\x61\x64\x6d\x69\x6e\x5f\160\141\x73\x73\167\157\162\144", '');
        update_site_option("\155\157\x5f\x73\141\x6d\x6c\x5f\155\145\163\x73\141\147\x65", "\x59\x6f\x75\162\x20\141\x63\143\157\165\156\164\x20\x68\x61\x73\x20\142\145\145\156\x20\x72\x65\164\x72\x69\145\166\x65\144\x20\163\x75\143\x63\145\x73\163\x66\165\154\x6c\171\56");
        delete_site_option("\155\157\137\x73\141\155\154\137\x76\x65\x72\151\x66\171\x5f\143\165\x73\164\157\155\x65\162");
        delete_site_option("\155\157\137\163\x61\x6d\154\x5f\156\145\167\x5f\162\x65\x67\x69\x73\x74\x72\x61\x74\x69\x6f\x6e");
        $this->mo_saml_show_success_message();
        gx:
    }
    public function mo_saml_check_empty_or_null($Ng)
    {
        if (!(!isset($Ng) || empty($Ng))) {
            goto iy;
        }
        return true;
        iy:
        return false;
    }
    function miniorange_sso_menu()
    {
        $l8 = add_menu_page("\x4d\x4f\40\x53\x41\115\x4c\40\123\x65\164\164\151\156\147\163\40" . __("\x43\x6f\x6e\146\151\147\x75\x72\x65\x20\123\101\x4d\114\x20\x49\x64\x65\156\x74\x69\164\171\40\x50\x72\x6f\166\151\144\145\x72\40\146\157\x72\40\123\x53\117", "\155\157\137\163\x61\155\x6c\x5f\163\145\164\164\x69\156\x67\x73"), "\x6d\x69\x6e\151\117\x72\x61\156\x67\145\40\x53\101\115\x4c\x20\x32\x2e\60\40\x53\x53\x4f", "\x61\144\155\151\156\x69\x73\164\162\x61\164\x6f\x72", "\x6d\x6f\137\x73\x61\155\x6c\x5f\x73\145\164\x74\x69\156\147\x73", array($this, "\155\157\x5f\x6c\x6f\147\x69\x6e\137\167\x69\x64\x67\145\164\137\163\x61\155\x6c\x5f\157\x70\x74\x69\157\x6e\x73"), plugin_dir_url(__FILE__) . "\151\155\x61\x67\145\163\x2f\x6d\x69\x6e\x69\157\162\x61\x6e\147\x65\56\160\x6e\147");
    }
    function mo_saml_redirect_for_authentication($GH, $Y1 = false)
    {
        if (!mo_saml_is_customer_license_key_verified()) {
            goto P_;
        }
        $A7 = maybe_unserialize(get_site_option("\x73\x61\x6d\x6c\137\x73\163\157\137\163\145\x74\164\x69\x6e\x67\163"));
        $P0 = Utilities::get_active_sites();
        $I7 = get_current_blog_id();
        if (in_array($I7, $P0)) {
            goto Lw;
        }
        return;
        Lw:
        if (!(empty($A7[$I7]) && !empty($A7["\104\x45\106\101\125\x4c\124"]))) {
            goto Hd;
        }
        $A7[$I7] = $A7["\104\105\106\101\125\x4c\124"];
        Hd:
        if (isset($A7[$I7]["\155\x6f\x5f\163\141\x6d\x6c\x5f\162\x65\x67\151\x73\x74\145\162\x65\144\137\157\156\x6c\x79\137\141\143\143\145\163\x73"]) && $A7[$I7]["\155\x6f\137\x73\x61\x6d\x6c\137\x72\145\147\x69\163\x74\x65\162\x65\144\x5f\157\156\154\x79\137\141\x63\x63\x65\x73\x73"] == "\164\162\165\x65" || isset($A7[$I7]["\155\x6f\x5f\x73\x61\x6d\x6c\x5f\x65\156\x61\142\154\x65\x5f\x6c\x6f\x67\151\156\x5f\x72\145\144\151\x72\145\x63\164"]) && $A7[$I7]["\155\157\137\x73\x61\155\154\x5f\145\x6e\141\x62\154\145\x5f\x6c\x6f\147\x69\x6e\x5f\162\x65\144\x69\x72\145\x63\164"] == "\164\x72\x75\x65" || $Y1) {
            goto eP;
        }
        if (!(isset($A7[$I7]["\155\x6f\x5f\x73\x61\x6d\x6c\x5f\162\145\144\x69\x72\145\143\164\137\x74\x6f\137\167\x70\137\x6c\157\x67\x69\x6e"]) and $A7[$I7]["\155\157\x5f\163\x61\x6d\x6c\x5f\162\x65\x64\151\162\145\143\164\137\164\x6f\x5f\x77\x70\x5f\154\x6f\147\x69\156"] == "\164\x72\x75\145")) {
            goto P7;
        }
        if (!(mo_saml_is_sp_configured() && !is_user_logged_in())) {
            goto Ft;
        }
        $yO = get_site_url($I7) . "\x2f\167\160\55\154\157\147\151\156\56\x70\x68\x70";
        if (empty($GH)) {
            goto M1;
        }
        $yO = $yO . "\77\x72\145\x64\151\x72\145\143\164\137\x74\157\x3d" . urlencode($GH) . "\x26\x72\x65\141\165\164\x68\x3d\x31";
        M1:
        header("\x4c\157\x63\141\x74\x69\x6f\156\x3a\x20" . $yO);
        exit;
        Ft:
        P7:
        goto QR;
        eP:
        if (!(mo_saml_is_sp_configured() && !is_user_logged_in())) {
            goto Fa;
        }
        $jt = get_site_option("\x6d\x6f\137\163\141\155\154\137\163\x70\x5f\142\141\163\145\137\165\162\x6c");
        if (!empty($jt)) {
            goto mk;
        }
        $jt = get_network_site_url();
        mk:
        if (empty($A7[$I7]["\x6d\x6f\137\x73\141\155\x6c\137\x72\x65\154\141\171\x5f\163\x74\141\x74\x65"])) {
            goto zV;
        }
        $GH = $A7[$I7]["\155\157\137\x73\141\x6d\x6c\x5f\162\x65\154\141\171\137\x73\164\x61\164\145"];
        zV:
        $MF = $GH;
        $J0 = get_site_option("\x73\141\x6d\154\137\154\x6f\147\151\156\x5f\x75\162\x6c");
        $Xz = !empty(get_site_option("\163\x61\155\x6c\x5f\154\157\x67\x69\156\137\x62\151\x6e\x64\151\156\147\x5f\x74\x79\x70\145")) ? get_site_option("\x73\141\155\x6c\x5f\154\157\x67\x69\156\137\x62\x69\156\x64\151\156\147\137\x74\171\160\x65") : "\110\x74\164\160\x50\x6f\163\x74";
        $A7 = maybe_unserialize(get_site_option("\x73\x61\155\x6c\137\163\163\x6f\137\163\145\x74\164\151\x6e\147\163"));
        $I7 = get_current_blog_id();
        if (!(empty($A7[$I7]) && !empty($A7["\104\x45\x46\x41\125\x4c\124"]))) {
            goto A2;
        }
        $A7[$I7] = $A7["\x44\x45\106\x41\125\x4c\x54"];
        A2:
        if (isset($A7[$I7]["\155\x6f\x5f\x73\x61\155\x6c\137\x66\157\162\143\145\137\141\165\x74\x68\x65\156\x74\x69\x63\141\x74\151\157\x6e"])) {
            goto sC;
        }
        $PW = '';
        goto G1;
        sC:
        $PW = $A7[$I7]["\155\x6f\137\163\141\x6d\154\137\x66\x6f\x72\143\x65\x5f\x61\165\164\150\x65\156\164\x69\143\141\x74\x69\157\x6e"];
        G1:
        $pD = $jt . "\57";
        $N5 = get_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\137\x73\x70\137\145\156\164\x69\164\x79\137\x69\x64");
        $RC = get_site_option("\163\x61\x6d\154\x5f\x6e\x61\155\145\x69\144\x5f\146\157\x72\x6d\x61\x74");
        if (!empty($RC)) {
            goto Mg;
        }
        $RC = "\61\56\x31\x3a\x6e\x61\155\x65\151\144\55\146\157\162\x6d\141\x74\x3a\165\x6e\x73\x70\x65\143\x69\146\151\145\144";
        Mg:
        if (!empty($N5)) {
            goto fM;
        }
        $N5 = $jt . "\57\x77\160\55\143\157\156\164\x65\156\x74\x2f\x70\154\x75\147\151\156\x73\x2f\155\151\156\x69\157\162\141\156\x67\x65\55\x73\141\x6d\154\x2d\x32\x30\x2d\x73\x69\x6e\x67\x6c\145\x2d\163\151\x67\156\x2d\157\x6e\57";
        fM:
        $Qh = Utilities::createAuthnRequest($pD, $N5, $J0, $PW, $Xz, $RC);
        $MF = mo_saml_relaystate_url($MF);
        if ($Xz == "\110\x74\164\x70\122\x65\144\x69\x72\145\143\164") {
            goto tN;
        }
        if (!(get_site_option("\x73\141\x6d\x6c\x5f\162\145\161\165\145\x73\164\x5f\x73\x69\147\156\145\x64") == "\x75\x6e\x63\150\x65\143\153\x65\144")) {
            goto Yt;
        }
        $WO = base64_encode($Qh);
        Utilities::postSAMLRequest($J0, $WO, $MF);
        exit;
        Yt:
        $ng = '';
        $Yg = '';
        $WO = Utilities::signXML($Qh, "\x4e\141\155\145\111\x44\120\157\x6c\151\143\x79");
        Utilities::postSAMLRequest($J0, $WO, $MF);
        goto Uw;
        tN:
        $UF = htmlspecialchars_decode($J0);
        if (strpos($J0, "\x3f") !== false) {
            goto Oj;
        }
        $UF .= "\x3f";
        goto U0;
        Oj:
        $UF .= "\46";
        U0:
        if (!(get_site_option("\x73\x61\x6d\154\x5f\x72\x65\x71\165\x65\163\x74\x5f\163\x69\147\x6e\x65\144") == "\x75\x6e\x63\x68\145\x63\153\x65\x64")) {
            goto V7;
        }
        $UF .= "\x53\101\x4d\114\122\x65\161\x75\x65\x73\164\75" . $Qh . "\46\122\145\x6c\x61\171\x53\164\141\x74\145\x3d" . urlencode($MF);
        header("\x4c\x6f\x63\x61\164\151\x6f\x6e\x3a\40" . $UF);
        exit;
        V7:
        $Qh = "\x53\101\115\x4c\122\145\161\x75\x65\x73\164\x3d" . $Qh . "\46\x52\x65\x6c\141\171\123\164\141\x74\145\x3d" . urlencode($MF) . "\x26\x53\x69\x67\101\154\147\75" . urlencode(XMLSecurityKey::RSA_SHA256);
        $IP = array("\164\171\x70\x65" => "\x70\x72\x69\166\141\164\145");
        $FE = new XMLSecurityKey(XMLSecurityKey::RSA_SHA256, $IP);
        $JH = get_site_option("\155\157\137\163\141\x6d\x6c\137\x63\165\x72\x72\x65\x6e\x74\x5f\x63\x65\x72\164\137\160\x72\151\166\x61\x74\x65\x5f\153\x65\171");
        $FE->loadKey($JH, FALSE);
        $Nf = new XMLSecurityDSig();
        $PN = $FE->signData($Qh);
        $PN = base64_encode($PN);
        $UF .= $Qh . "\46\123\151\147\x6e\141\164\165\162\145\x3d" . urlencode($PN);
        header("\114\157\143\141\x74\151\x6f\x6e\x3a\x20" . $UF);
        exit;
        Uw:
        Fa:
        QR:
        P_:
    }
    function mo_saml_init_login_form()
    {
        $Y1 = get_site_option("\x73\141\155\154\x5f\x69\x64\x70\x5f\x64\x6f\x6d\141\151\x6e\x5f\x6d\141\160\160\x69\156\147");
        $eC = get_site_option("\155\157\137\x73\141\155\x6c\x5f\x62\x61\x63\x6b\x64\x6f\157\162\x5f\165\x72\154") ? get_site_option("\155\157\x5f\163\x61\x6d\154\137\x62\x61\x63\x6b\x64\157\157\x72\137\x75\162\x6c") : "\146\x61\x6c\x73\145";
        if (!(!empty($Y1) && mo_saml_is_customer_registered_saml() && mo_saml_is_customer_license_key_verified())) {
            goto gJ;
        }
        $oZ = get_site_option("\x6d\x6f\x5f\x73\141\155\x6c\x5f\141\x6c\154\x6f\x77\137\167\x70\137\x73\151\147\x6e\x69\156");
        if (isset($_GET["\147\x65\164\137\144\x6f\155\x61\x69\x6e\x5f\155\x61\x70\x70\151\x6e\x67"]) && $_GET["\147\x65\164\x5f\x64\x6f\155\141\151\x6e\137\155\x61\160\x70\151\156\147"] == "\164\162\x75\x65") {
            goto C0;
        }
        if ($oZ != "\146\141\154\163\x65" && (isset($_GET["\163\141\155\x6c\x5f\x73\163\x6f"]) && $_GET["\x73\x61\x6d\154\x5f\163\163\157"] == $eC) || isset($_POST["\x73\x61\x6d\x6c\137\163\x73\157"]) && $_POST["\163\x61\155\154\x5f\x73\x73\x6f"] == $eC) {
            goto m1;
        }
        if (isset($_REQUEST["\x72\145\144\151\x72\145\x63\164\137\164\157"])) {
            goto nz;
        }
        goto q4;
        m1:
        return;
        goto q4;
        nz:
        $Yu = $_REQUEST["\162\x65\x64\x69\162\x65\x63\x74\137\x74\157"];
        if (!(strpos($Yu, "\x77\x70\x2d\x61\x64\155\x69\x6e") !== false && strpos($Yu, "\x73\141\155\x6c\137\x73\163\157\x3d\x66\141\154\163\x65") !== false)) {
            goto ta;
        }
        return;
        ta:
        q4:
        goto Ru;
        C0:
        echo json_encode($Y1);
        exit;
        Ru:
        add_filter("\147\145\164\x74\145\170\x74", function ($FJ) {
            if (!in_array($GLOBALS["\160\x61\x67\x65\156\157\x77"], array("\x77\x70\x2d\154\157\147\x69\x6e\x2e\160\x68\x70"))) {
                goto Ze;
            }
            if (!("\125\x73\145\162\x6e\x61\x6d\x65" == $FJ)) {
                goto fj;
            }
            return "\x45\155\x61\x69\154";
            fj:
            Ze:
            return $FJ;
        }, 20);
        wp_register_style("\150\151\144\x65\55\154\157\147\151\x6e", plugins_url("\151\x6e\143\154\x75\144\x65\163\57\x63\163\163\x2f\x68\151\144\x65\55\x6c\x6f\147\151\x6e\x2e\143\x73\163\77\x76\x65\162\x73\151\157\156\x3d\x34\x2e\x31\56\63", __FILE__));
        wp_register_style("\163\150\157\x77\x2d\x6c\x6f\147\151\156", plugins_url("\151\156\143\154\165\x64\x65\163\x2f\x63\163\x73\57\163\150\x6f\x77\55\x6c\157\147\x69\x6e\x2e\143\x73\163\x3f\166\145\x72\x73\x69\157\x6e\x3d\x34\56\61\56\63", __FILE__));
        wp_enqueue_style("\163\150\x6f\x77\55\x6c\157\147\151\x6e");
        wp_enqueue_style("\x68\151\x64\145\55\154\x6f\x67\151\x6e");
        gJ:
    }
    function mo_saml_footer_form()
    {
        $Ck = get_site_option("\155\x6f\137\x73\x61\x6d\154\x5f\145\156\141\142\x6c\x65\137\144\x6f\155\x61\x69\156\137\155\141\160\160\151\156\x67");
        $es = true;
        $Sn = get_site_option("\x73\141\155\x6c\x5f\151\x64\x70\x5f\x64\157\x6d\x61\x69\156\137\x6d\141\160\x70\x69\156\x67");
        if ($Ck == "\x74\x72\165\145" && !empty($Sn)) {
            goto aB;
        }
        echo "\11\x9\11\x3c\163\143\162\151\160\x74\x3e\15\12\11\11\x9\15\12\11\x9\x9\152\121\x75\145\x72\x79\50\x27\x6c\141\x62\145\154\x5b\146\157\x72\x3d\42\165\163\145\x72\137\160\141\x73\163\42\x5d\47\51\x2e\163\x68\x6f\167\50\x29\73\15\12\11\x9\11\x6a\121\x75\145\x72\171\x28\47\x23\x75\x73\145\x72\137\160\141\x73\x73\47\51\56\x73\150\157\x77\x28\51\x3b\xd\xa\x9\x9\x9\152\121\165\145\x72\171\x28\x27\x64\x69\x76\x23\154\x6f\x67\151\x6e\40\x70\43\x6e\141\166\47\51\x2e\x73\150\x6f\167\x28\x29\x3b\15\xa\x9\x9\11\15\12\11\11\x9\x6a\x51\x75\145\x72\171\50\47\43\x75\163\x65\162\x5f\160\141\163\x73\x27\x29\56\x76\141\x6c\50\x22\x22\51\73\15\xa\11\x9\x9\xd\xa\x9\11\x9\74\57\163\143\x72\x69\x70\164\x3e\xd\12\x9\11\x9";
        goto gs;
        aB:
        echo "\x9\x9\x3c\163\143\162\x69\x70\164\x3e\xd\xa\x9\11\x9\x6a\121\165\x65\x72\171\x28\47\x23\x75\x73\145\x72\137\x70\x61\163\x73\47\51\56\141\164\164\x72\x28\x27\144\x69\x73\x61\x62\154\145\144\x27\54\40\47\144\151\x73\141\x62\x6c\145\144\47\51\73\xd\12\11\x9\11\x6a\121\x75\x65\x72\171\x28\40\x22\43\x6c\157\x67\x69\156\146\x6f\x72\155\42\40\x29\x2e\163\165\x62\x6d\151\164\x28\x66\x75\156\143\164\x69\x6f\156\50\x20\145\x76\145\156\164\x20\51\40\x7b\15\12\x9\11\11\x9\166\x61\162\x20\165\163\145\162\156\x61\x6d\145\40\x3d\40\152\x51\165\145\162\171\x28\47\x23\x75\163\145\162\x5f\154\157\147\x69\156\47\51\x2e\x76\141\154\x28\51\73\xd\xa\11\x9\x9\11\x69\146\x28\x75\163\145\x72\156\x61\x6d\145\40\41\75\x20\47\x27\x29\x7b\15\xa\11\x9\x9\x9\x9\x76\x61\162\40\x76\141\154\151\144\x65\155\141\151\x6c\40\75\40\165\x73\145\x72\x6e\141\x6d\x65\56\151\x6e\144\x65\x78\117\x66\50\42\x40\42\x29\x3b\15\12\11\x9\x9\x9\11\x69\146\50\x76\141\154\x69\x64\x65\155\x61\151\154\40\x21\75\40\x2d\x31\51\x7b\xd\12\11\x9\x9\x9\11\11\166\x61\162\x20\x75\163\x65\x72\156\141\155\145\137\163\160\154\151\x74\40\75\x20\165\x73\x65\x72\x6e\x61\x6d\x65\56\163\x70\154\x69\164\50\x27\100\47\51\73\xd\xa\11\11\11\x9\x9\11\166\x61\x72\x20\144\157\x6d\141\151\x6e\40\x3d\40\x75\163\x65\162\156\x61\x6d\145\137\163\160\154\x69\x74\x5b\x31\x5d\x3b\15\12\11\x9\x9\11\x9\x9\x6a\121\x75\x65\x72\x79\56\x61\x6a\141\x78\50\x7b\15\xa\x9\x9\x9\11\x9\11\11\x75\162\x6c\x3a\x22";
        echo home_url() . "\77\147\x65\x74\x5f\x64\x6f\155\141\x69\x6e\137\155\x61\x70\x70\151\156\147\x3d\164\x72\165\x65";
        echo "\x22\54\xd\12\x9\x9\x9\11\x9\x9\x9\x61\x73\x79\156\143\72\x20\x66\141\x6c\x73\x65\x2c\xd\xa\11\x9\11\x9\x9\x9\11\x73\165\143\143\x65\163\x73\72\x66\x75\156\x63\164\151\x6f\156\x28\144\x61\164\141\x29\x20\173\15\xa\11\x9\x9\11\11\11\11\11\151\146\x28\144\141\x74\x61\x20\75\75\75\x20\165\156\144\x65\146\151\156\x65\144\40\x7c\174\x20\x21\x64\141\x74\141\x29\x7b\15\12\x9\11\x9\11\x9\x9\x9\x9\x9\x76\141\x72\x20\160\141\x73\x73\x77\157\162\144\x20\x3d\x20\152\121\x75\145\x72\171\x28\47\x23\x75\163\x65\162\x5f\x70\141\163\163\47\x29\x2e\x76\141\x6c\x28\51\73\15\12\11\11\x9\11\11\11\11\x9\x9\x69\146\x28\164\x79\x70\145\x6f\x66\40\160\141\x73\x73\x77\157\x72\144\x20\x3d\75\x3d\40\x27\x75\156\x64\x65\x66\x69\x6e\x65\x64\47\x20\174\174\40\x70\141\x73\163\167\157\162\144\x20\75\x3d\x20\x27\x27\x29\x7b\15\12\x9\x9\x9\11\11\x9\11\11\x9\x9\152\121\x75\145\x72\x79\x28\x27\x6c\x61\142\x65\154\133\x66\157\x72\x3d\x22\165\163\x65\162\137\x70\141\x73\163\42\x5d\47\51\x2e\x73\x68\x6f\167\x28\x29\x3b\xd\12\x9\x9\11\11\11\11\11\11\x9\x9\152\121\165\145\x72\x79\50\x27\x23\165\163\145\162\137\x70\x61\163\163\x27\51\56\x73\x68\x6f\x77\50\51\x3b\15\12\x9\11\x9\11\x9\x9\x9\11\11\11\x6a\121\x75\x65\x72\171\50\x27\x64\151\166\43\154\157\147\151\x6e\40\x70\x23\156\141\166\47\51\x2e\163\150\x6f\x77\50\51\x3b\15\12\11\11\11\11\x9\x9\x9\11\x9\11\x65\x76\145\156\x74\x2e\x70\x72\x65\166\x65\x6e\x74\104\145\146\x61\165\x6c\x74\50\51\73\xd\12\11\11\x9\x9\x9\11\11\11\11\175\15\xa\11\11\11\11\x9\11\x9\x9\x7d\145\154\163\145\173\xd\xa\11\11\11\11\11\11\x9\x9\x9\x76\x61\x72\x20\x64\157\155\141\x69\156\137\155\x61\164\x63\x68\40\x3d\x20\x66\x61\x6c\x73\x65\73\15\xa\11\x9\11\11\x9\x9\x9\x9\11\166\141\162\x20\144\141\164\141\117\142\152\x20\x3d\40\x4a\x53\x4f\x4e\x2e\160\141\162\x73\145\x28\x64\141\x74\141\x29\x3b\15\xa\x9\11\x9\11\11\x9\x9\11\11\166\141\x72\40\x75\x73\x65\137\x77\x70\137\143\162\x65\144\145\156\164\x69\141\x6c\163\40\75\x20\x22";
        echo $es;
        echo "\42\73\xd\12\11\x9\11\x9\x9\x9\11\11\11\xd\12\15\xa\x9\x9\11\11\x9\11\11\x9\x9\152\121\x75\x65\162\x79\56\145\141\143\150\x20\50\x64\x61\164\x61\117\142\x6a\54\40\x66\x75\x6e\143\x74\151\x6f\156\x20\50\153\145\171\x2c\40\166\141\x6c\165\x65\51\x7b\15\12\11\x9\x9\11\x9\11\x9\x9\11\11\166\141\162\40\x6d\141\160\x70\151\x6e\x67\137\144\x6f\155\x61\151\156\x73\40\75\x20\166\x61\154\165\x65\56\163\160\154\151\x74\x28\42\73\x22\51\73\15\xa\11\11\x9\11\11\x9\11\x9\x9\x9\x76\x61\x72\40\144\x6f\155\141\151\156\137\x66\x6f\x75\x6e\x64\x20\x3d\x20\x6a\121\x75\x65\x72\171\56\x69\156\101\x72\162\141\171\x28\144\157\x6d\141\x69\156\x2c\155\141\x70\x70\x69\156\147\137\144\x6f\155\x61\151\156\163\x29\x3b\15\xa\11\11\x9\x9\11\x9\x9\11\11\x9\151\x66\x28\x64\157\x6d\x61\151\x6e\137\146\157\x75\156\x64\40\x3e\x20\55\x31\x29\x7b\15\xa\x9\11\x9\11\x9\11\11\11\x9\11\11\144\157\155\141\151\x6e\137\x6d\141\164\143\x68\40\x3d\x20\164\x72\x75\145\x3b\xd\xa\11\x9\x9\11\x9\x9\x9\11\11\x9\175\15\12\x9\x9\x9\x9\11\11\11\11\x9\x7d\51\x3b\15\xa\11\11\x9\11\x9\x9\x9\x9\11\x69\146\50\x21\x64\157\x6d\x61\x69\156\x5f\x6d\x61\164\x63\150\51\x7b\15\xa\x9\x9\11\11\x9\11\x9\11\11\x9\x9\x9\xd\xa\11\x9\11\11\x9\x9\11\x9\x9\11\11\x9\151\x66\50\165\163\x65\x5f\167\x70\137\x63\x72\x65\x64\x65\x6e\x74\x69\x61\154\163\51\x7b\15\12\x9\11\11\11\11\x9\x9\11\11\x9\11\11\x9\152\x51\x75\x65\162\171\x28\x27\x6c\141\142\x65\154\133\x66\x6f\162\75\42\165\163\x65\162\137\x70\x61\163\x73\42\135\x27\x29\x2e\163\x68\157\x77\50\51\x3b\xd\12\x9\11\x9\x9\x9\x9\x9\x9\11\11\11\x9\11\x6a\x51\x75\145\162\x79\x28\x27\43\x75\163\145\162\x5f\160\x61\163\x73\x27\x29\56\x73\x68\157\167\50\x29\x3b\15\12\11\x9\11\11\x9\x9\x9\11\x9\x9\x9\11\11\152\x51\165\x65\162\171\50\47\144\x69\166\43\x6c\x6f\147\151\x6e\x20\x70\x23\156\x61\166\x27\51\x2e\x73\x68\x6f\167\50\51\73\xd\xa\11\11\x9\x9\x9\x9\x9\x9\x9\11\x9\x9\x9\xd\12\x9\x9\11\11\x9\11\x9\11\x9\11\x9\x9\11\x76\141\x72\x20\x70\x61\x73\x73\167\x6f\162\144\x20\75\40\x6a\121\x75\145\162\171\x28\47\43\x75\x73\145\162\x5f\160\141\163\163\x27\51\x2e\x76\141\x6c\50\x29\x3b\xd\xa\11\11\11\11\x9\11\11\x9\11\x9\11\x9\11\xd\12\x9\11\x9\11\x9\11\x9\11\11\11\11\x9\11\151\146\50\x70\x61\163\x73\167\157\162\144\40\x3d\x3d\40\x27\47\51\173\xd\12\11\x9\11\11\11\x9\x9\11\11\11\11\x9\x9\11\145\x76\x65\156\x74\x2e\160\x72\x65\x76\x65\x6e\164\x44\145\x66\x61\x75\154\164\x28\x29\73\xd\xa\x9\x9\x9\x9\11\x9\x9\11\x9\x9\x9\x9\x9\175\xd\xa\11\11\11\x9\x9\11\x9\11\11\11\x9\11\x9\152\121\165\x65\162\x79\x28\47\43\165\163\x65\162\137\x70\141\x73\163\x27\x29\56\x72\145\x6d\x6f\x76\145\x41\x74\x74\162\50\x27\x64\x69\x73\x61\142\154\x65\144\x27\x29\x3b\xd\xa\15\xa\x9\x9\11\x9\11\x9\11\11\11\x9\x9\11\x7d\15\12\x9\x9\11\x9\x9\x9\x9\11\11\175\15\12\11\x9\x9\11\x9\x9\x9\11\x7d\xd\xa\x9\x9\x9\x9\11\11\x9\x7d\xd\xa\x9\x9\x9\x9\11\11\x7d\51\x3b\15\12\11\x9\x9\x9\x9\x7d\15\xa\11\11\11\11\175\xd\12\x9\x9\11\x7d\x29\x3b\xd\xa\11\x9\x9\xd\12\11\x9\74\x2f\163\143\x72\x69\160\x74\x3e\15\xa\11\15\12\11";
        gs:
        $this->mo_saml_modify_login_form();
    }
    function mo_saml_handle_domain_mapping($user, $fi, $fK)
    {
        $eC = get_site_option("\155\x6f\137\x73\x61\x6d\154\x5f\142\x61\143\x6b\144\157\x6f\162\x5f\165\162\154") ? get_site_option("\155\157\137\x73\141\x6d\154\x5f\142\x61\x63\x6b\x64\x6f\x6f\x72\x5f\x75\162\x6c") : "\146\141\x6c\163\145";
        if (get_site_option("\155\157\137\163\x61\x6d\154\137\145\x6e\x61\142\154\x65\137\x64\x6f\155\x61\x69\156\137\155\x61\160\160\151\x6e\147") == "\x74\x72\165\x65" && (!isset($_REQUEST["\x73\x61\x6d\x6c\137\x73\x73\x6f"]) || isset($_REQUEST["\x73\141\155\154\x5f\x73\163\x6f"]) && $_REQUEST["\163\141\x6d\154\137\163\x73\x6f"] != $eC)) {
            goto Tg;
        }
        $id = wp_authenticate_username_password($user, $fi, $fK);
        return $id;
        goto cZ;
        Tg:
        if (empty($fi)) {
            goto zC;
        }
        $Y1 = get_site_option("\163\x61\x6d\154\137\151\x64\160\x5f\144\157\155\x61\151\x6e\137\x6d\x61\x70\x70\151\156\x67");
        $Yu = '';
        if (!isset($_REQUEST["\x72\145\144\151\x72\145\143\x74\137\x74\x6f"])) {
            goto WP;
        }
        $Yu = $_REQUEST["\162\x65\144\x69\x72\145\x63\x74\137\164\157"];
        WP:
        if (strpos($fi, "\x40") !== false) {
            goto qn;
        }
        if (empty($Y1) || get_site_option("\155\157\137\x73\141\x6d\154\137\x61\x6c\x6c\x6f\x77\137\x77\160\x5f\163\151\x67\x6e\151\x6e") != "\x66\141\154\163\x65" && isset($_REQUEST["\x73\141\x6d\154\x5f\163\x73\157"]) && $_REQUEST["\163\x61\x6d\154\x5f\163\x73\157"] == $eC) {
            goto Uy;
        }
        if (!empty($fK)) {
            goto yH;
        }
        $aF = new WP_Error("\151\156\166\141\x6c\151\x64\x5f\x65\155\141\151\x6c", __("\x3c\x73\x74\x72\x6f\x6e\x67\76\x45\122\122\x4f\122\x3c\57\x73\x74\x72\x6f\156\147\x3e\72\x20\x50\154\x65\141\x73\x65\40\x65\x6e\164\x65\x72\x20\x61\x20\166\141\x6c\x69\x64\x20\x65\155\141\x69\x6c\x20\141\144\144\x72\145\x73\163\x2e"), '');
        return $aF;
        goto BZ;
        qn:
        $Nx = explode("\x40", $fi, 2);
        $QB = trim($Nx[1]);
        $Yh = false;
        if (empty($Y1)) {
            goto gy;
        }
        $xI = get_site_option("\x73\x61\155\x6c\x5f\x69\144\145\156\164\151\x74\171\137\x6e\141\x6d\145");
        $Sn = array_map("\164\162\x69\155", explode("\x3b", $Y1[$xI]));
        if (!in_array($QB, $Sn)) {
            goto TE;
        }
        $Yh = true;
        $this->mo_saml_redirect_for_authentication($Yu, true);
        TE:
        gy:
        if ($Yh) {
            goto ks;
        }
        $id = wp_authenticate_username_password($user, $fi, $fK);
        return $id;
        ks:
        goto BZ;
        Uy:
        $id = wp_authenticate_username_password(null, $fi, $fK);
        return $id;
        goto BZ;
        yH:
        $id = wp_authenticate_username_password($user, $fi, $fK);
        return $id;
        BZ:
        zC:
        $aF = new WP_Error();
        $aF->add("\x65\x6d\160\x74\x79\x5f\x75\x73\x65\x72\156\141\155\x65", __("\74\x73\164\x72\157\156\147\76\x45\122\x52\117\x52\x3c\57\x73\164\162\x6f\x6e\147\76\72\40\105\x6d\x70\x74\171\40\x75\x73\145\162\x6e\141\x6d\145\56"));
        $aF->add("\145\x6d\160\164\171\x5f\160\141\x73\x73\167\157\x72\x64", __("\74\x73\164\x72\x6f\x6e\x67\x3e\x45\122\x52\x4f\x52\74\57\x73\x74\x72\157\156\147\x3e\72\40\x45\155\x70\164\171\40\x70\141\x73\x73\x77\157\162\144\x2e"));
        return $aF;
        cZ:
    }
    function mo_saml_authenticate()
    {
        $Yu = '';
        if (!isset($_REQUEST["\162\x65\144\151\162\x65\143\164\137\x74\157"])) {
            goto UP;
        }
        $Yu = $_REQUEST["\x72\x65\x64\x69\x72\x65\x63\x74\x5f\164\157"];
        UP:
        if (!is_user_logged_in()) {
            goto WO;
        }
        if (!empty($Yu)) {
            goto Gn;
        }
        $yO = saml_get_current_page_url();
        if (!(strpos($yO, "\167\160\x2d\x6c\157\147\151\x6e\x2e\160\x68\x70") !== false)) {
            goto ki;
        }
        $yO = str_replace("\167\x70\55\x6c\x6f\147\x69\156\56\x70\150\160", '', $yO);
        if (!filter_var($yO, FILTER_VALIDATE_URL)) {
            goto Rz;
        }
        header("\114\157\143\x61\x74\x69\x6f\x6e\x3a\x20" . $yO);
        exit;
        Rz:
        ki:
        goto OT;
        Gn:
        header("\114\x6f\143\x61\x74\x69\x6f\156\72\40" . $Yu);
        exit;
        OT:
        WO:
        global $blog_id;
        $A7 = maybe_unserialize(get_site_option("\163\141\155\x6c\137\x73\163\157\x5f\x73\x65\164\x74\x69\156\x67\x73"));
        $I7 = get_current_blog_id();
        $P0 = Utilities::get_active_sites();
        if (in_array($I7, $P0)) {
            goto ut;
        }
        return;
        ut:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\x46\x41\x55\x4c\x54"]))) {
            goto gw;
        }
        $A7[$I7] = $A7["\104\105\x46\101\x55\x4c\124"];
        gw:
        if (!(isset($A7[$I7]["\155\x6f\137\x73\x61\x6d\154\137\x65\x6e\141\x62\154\x65\137\154\157\x67\151\x6e\137\x72\145\x64\151\162\145\x63\x74"]) and $A7[$I7]["\155\x6f\x5f\x73\141\x6d\x6c\137\x65\156\141\142\154\x65\x5f\x6c\157\147\151\156\137\x72\145\144\x69\x72\145\x63\x74"] == "\164\162\165\x65")) {
            goto be;
        }
        $eC = isset($A7[$I7]["\155\157\x5f\163\x61\155\x6c\137\142\141\x63\153\x64\x6f\157\162\137\x75\162\154"]) ? trim($A7[$I7]["\x6d\x6f\x5f\x73\141\155\x6c\x5f\142\x61\143\153\x64\x6f\x6f\x72\137\165\162\x6c"]) : "\146\x61\x6c\163\x65";
        if (isset($_GET["\154\157\147\x67\x65\144\x6f\x75\164"]) && $_GET["\154\x6f\147\147\145\144\x6f\165\x74"] == "\164\x72\x75\145") {
            goto k8;
        }
        if (isset($A7[$I7]["\155\157\x5f\x73\x61\x6d\154\137\141\x6c\x6c\x6f\167\x5f\x77\160\x5f\x73\151\x67\x6e\x69\x6e"]) and $A7[$I7]["\155\157\137\163\x61\x6d\154\x5f\x61\x6c\x6c\157\x77\x5f\167\x70\x5f\163\x69\x67\x6e\151\x6e"] == "\x74\x72\x75\x65") {
            goto kB;
        }
        goto XD;
        k8:
        header("\114\157\x63\x61\x74\151\157\156\x3a\40" . get_network_site_url());
        exit;
        goto XD;
        kB:
        if (isset($_GET["\x73\141\155\154\137\163\x73\x6f"]) && $_GET["\x73\141\x6d\154\x5f\x73\x73\x6f"] == $eC || isset($_POST["\163\x61\155\x6c\x5f\163\163\x6f"]) && $_POST["\x73\141\x6d\x6c\137\163\163\157"] == $eC) {
            goto fq;
        }
        if (isset($_REQUEST["\x72\x65\x64\x69\x72\145\143\x74\137\164\x6f"])) {
            goto no;
        }
        goto Dj;
        fq:
        return;
        goto Dj;
        no:
        $Yu = $_REQUEST["\x72\145\144\151\162\x65\143\x74\137\x74\157"];
        if (!(strpos($Yu, "\167\x70\x2d\x61\x64\155\151\x6e") !== false && strpos($Yu, "\x73\141\155\154\137\163\163\157\x3d" . $eC) !== false)) {
            goto lZ;
        }
        return;
        lZ:
        Dj:
        XD:
        if (!empty($Yu)) {
            goto gz;
        }
        $Yu = saml_get_current_page_url();
        gz:
        $this->mo_saml_redirect_for_authentication($Yu);
        be:
    }
    function mo_saml_auto_redirect()
    {
        if (!current_user_can("\x72\145\141\x64")) {
            goto Y5;
        }
        return;
        Y5:
        global $blog_id;
        $A7 = maybe_unserialize(get_site_option("\x73\141\x6d\x6c\x5f\x73\x73\157\137\163\145\164\164\x69\156\147\163"));
        $I7 = get_current_blog_id();
        $P0 = Utilities::get_active_sites();
        if (in_array($I7, $P0)) {
            goto cf;
        }
        return;
        cf:
        if (!(empty($A7[$I7]) && !empty($A7["\104\105\x46\101\x55\x4c\124"]))) {
            goto Sd;
        }
        $A7[$I7] = $A7["\x44\x45\x46\101\x55\x4c\124"];
        Sd:
        if (is_user_logged_in() && !empty($A7[$I7]["\x6d\157\137\x73\141\155\x6c\137\x73\x75\142\163\151\x74\x65\x5f\141\143\x63\x65\163\163\x5f\144\x65\156\151\145\x64"])) {
            goto lq;
        }
        if (!((isset($A7[$I7]["\x6d\x6f\x5f\x73\x61\x6d\x6c\x5f\162\145\x67\151\163\164\145\x72\x65\144\x5f\x6f\156\x6c\171\x5f\x61\143\x63\x65\163\163"]) and $A7[$I7]["\x6d\157\137\x73\x61\155\x6c\137\x72\x65\x67\x69\163\x74\x65\x72\x65\144\137\157\x6e\x6c\x79\x5f\x61\143\x63\x65\x73\x73"] == "\x74\x72\165\x65") || (isset($A7[$I7]["\x6d\x6f\137\x73\141\155\x6c\137\162\145\x64\x69\x72\x65\x63\164\x5f\164\x6f\137\167\x70\x5f\x6c\x6f\147\x69\156"]) and $A7[$I7]["\x6d\157\137\163\x61\155\x6c\137\162\145\x64\x69\162\145\x63\x74\137\164\x6f\137\x77\x70\x5f\x6c\157\x67\x69\x6e"] == "\164\x72\165\x65"))) {
            goto Qd;
        }
        $AO = $_SERVER["\x48\124\x54\x50\x5f\110\x4f\x53\x54"];
        if (!(substr($AO, -1) == "\x2f")) {
            goto IW;
        }
        $AO = substr($AO, 0, -1);
        IW:
        $c0 = $_SERVER["\x52\x45\121\x55\x45\x53\x54\137\x55\122\x49"];
        if (!(substr($c0, 0, 1) == "\57")) {
            goto Mf;
        }
        $c0 = substr($c0, 1);
        Mf:
        $GH = "\x68\164\x74\160" . (isset($_SERVER["\110\x54\x54\x50\x53"]) ? "\x73" : '') . "\72\x2f\x2f" . $AO . "\57" . $c0;
        $this->mo_saml_redirect_for_authentication($GH);
        Qd:
        goto n9;
        lq:
        global $current_user;
        if (is_user_member_of_blog($current_user->ID)) {
            goto MQ;
        }
        $this->mo_saml_admin_page_access_denied();
        MQ:
        n9:
    }
    function mo_saml_modify_login_form()
    {
        $A7 = maybe_unserialize(get_site_option("\163\x61\155\154\137\163\x73\x6f\x5f\163\x65\x74\x74\151\156\147\163"));
        $I7 = get_current_blog_id();
        $P0 = Utilities::get_active_sites();
        if (in_array($I7, $P0)) {
            goto Cj;
        }
        return;
        Cj:
        if (!(empty($A7[$I7]) && !empty($A7["\x44\105\x46\101\125\x4c\x54"]))) {
            goto jm;
        }
        $A7[$I7] = $A7["\x44\105\106\x41\125\114\x54"];
        jm:
        $eC = isset($A7[$I7]["\x6d\157\x5f\x73\141\x6d\154\x5f\x62\x61\143\153\x64\x6f\x6f\x72\x5f\165\x72\154"]) ? trim($A7[$I7]["\155\x6f\137\x73\141\x6d\x6c\x5f\142\x61\x63\153\144\x6f\157\162\137\x75\x72\x6c"]) : "\146\141\x6c\x73\x65";
        if (!(get_site_option("\x6d\157\x5f\163\x61\155\154\137\141\x6c\154\157\x77\x5f\x77\x70\137\x73\x69\x67\156\151\x6e") != "\x66\141\154\163\x65" && (isset($_GET["\163\141\x6d\154\137\x73\x73\x6f"]) && $_GET["\163\141\155\x6c\137\x73\163\157"] == $eC) || isset($_POST["\163\141\x6d\154\x5f\x73\163\157"]) && $_POST["\163\x61\155\x6c\137\x73\163\x6f"] == $eC)) {
            goto gk;
        }
        echo "\11\11\11\74\x73\143\x72\151\160\164\x3e\15\12\11\x9\x9\11\152\x51\165\x65\x72\x79\50\42\x23\165\163\x65\x72\137\160\141\x73\163\x22\51\x2e\162\145\155\x6f\166\x65\101\x74\164\x72\50\x22\x64\x69\163\141\x62\154\145\x64\x22\51\73\15\xa\x9\x9\11\x3c\57\x73\x63\162\x69\x70\x74\76\xd\xa\11\11\11";
        echo "\x3c\x69\x6e\160\165\x74\x20\x74\x79\160\145\x3d\x22\x68\x69\x64\144\145\x6e\x22\x20\x6e\141\x6d\x65\x3d\42\163\x61\155\x6c\137\163\163\157\x22\40\x76\141\x6c\165\x65\x3d\42" . $eC . "\x22\x3e" . "\12";
        return;
        gk:
        if (!(isset($A7[$I7]["\155\157\x5f\163\141\155\154\x5f\141\144\144\137\163\x73\x6f\x5f\142\165\164\164\x6f\156\137\x77\x70"]) and $A7[$I7]["\x6d\157\137\x73\141\x6d\154\137\141\x64\144\x5f\163\163\157\137\x62\165\164\164\157\156\137\167\160"] == "\164\162\165\145")) {
            goto G9;
        }
        $this->mo_saml_add_sso_button();
        G9:
    }
    function mo_saml_add_sso_button()
    {
        $A7 = maybe_unserialize(get_site_option("\x73\141\x6d\x6c\x5f\x73\163\157\x5f\x73\145\164\164\x69\156\147\x73"));
        $I7 = get_current_blog_id();
        $P0 = Utilities::get_active_sites();
        if (in_array($I7, $P0)) {
            goto dc;
        }
        return;
        dc:
        if (!(empty($A7[$I7]) && !empty($A7["\x44\105\x46\x41\125\114\x54"]))) {
            goto nn;
        }
        $A7[$I7] = $A7["\x44\105\106\x41\125\114\x54"];
        nn:
        if (is_user_logged_in()) {
            goto kf;
        }
        $jt = home_url();
        $QP = isset($A7[$I7]["\x6d\x6f\x5f\x73\x61\x6d\x6c\x5f\x62\165\x74\164\157\156\137\x77\x69\144\x74\x68"]) ? $A7[$I7]["\x6d\157\x5f\x73\141\x6d\154\137\x62\165\164\x74\157\156\x5f\x77\x69\144\x74\x68"] : "\61\x30\x30";
        $w5 = isset($A7[$I7]["\x6d\x6f\137\x73\x61\155\154\137\x62\165\x74\x74\x6f\x6e\137\150\x65\x69\x67\x68\164"]) ? $A7[$I7]["\x6d\x6f\x5f\163\x61\155\x6c\x5f\x62\165\x74\x74\x6f\x6e\137\150\x65\151\x67\150\x74"] : "\65\60";
        $t6 = isset($A7[$I7]["\155\x6f\x5f\x73\x61\x6d\154\x5f\x62\x75\x74\x74\x6f\156\x5f\x73\151\x7a\145"]) ? $A7[$I7]["\155\157\x5f\163\x61\155\x6c\x5f\142\x75\164\x74\157\156\x5f\x73\x69\172\145"] : "\65\x30";
        $Yq = isset($A7[$I7]["\155\157\x5f\x73\x61\x6d\154\137\x62\165\164\164\157\x6e\x5f\143\165\162\166\x65"]) ? $A7[$I7]["\x6d\157\x5f\163\141\155\154\137\142\x75\164\x74\x6f\156\x5f\x63\165\162\166\145"] : "\x35";
        $Ur = isset($A7[$I7]["\x6d\157\137\x73\141\155\x6c\137\142\x75\164\x74\x6f\156\x5f\143\x6f\x6c\x6f\162"]) ? $A7[$I7]["\155\x6f\137\163\x61\x6d\154\x5f\142\x75\x74\164\157\156\x5f\x63\157\154\x6f\x72"] : "\60\60\70\65\x62\141";
        $TE = isset($A7[$I7]["\155\157\137\163\141\x6d\x6c\x5f\142\x75\164\x74\157\x6e\x5f\164\x68\145\x6d\x65"]) ? $A7[$I7]["\155\x6f\137\x73\141\155\154\x5f\x62\165\x74\164\157\x6e\137\x74\150\145\155\x65"] : "\154\157\x6e\x67\142\165\164\x74\157\x6e";
        $lF = isset($A7[$I7]["\155\x6f\137\x73\x61\x6d\154\137\142\165\164\x74\x6f\156\x5f\164\x65\170\164"]) ? $A7[$I7]["\x6d\x6f\137\x73\141\155\x6c\137\x62\165\164\x74\x6f\x6e\x5f\164\x65\170\x74"] : (get_site_option("\163\141\x6d\154\137\x69\144\x65\x6e\164\151\x74\171\137\156\141\155\145") ? get_site_option("\x73\x61\155\x6c\x5f\151\x64\145\156\x74\151\x74\x79\x5f\x6e\141\x6d\145") : "\x4c\x6f\147\x69\x6e");
        $mC = isset($A7[$I7]["\155\x6f\x5f\163\141\155\x6c\x5f\146\157\x6e\164\x5f\x63\x6f\154\157\x72"]) ? $A7[$I7]["\x6d\x6f\137\163\141\x6d\154\x5f\x66\x6f\156\164\137\143\x6f\154\x6f\162"] : "\146\146\x66\x66\146\146";
        $zH = isset($A7[$I7]["\x6d\x6f\137\x73\x61\155\154\137\146\x6f\156\164\137\x73\151\x7a\145"]) ? $A7[$I7]["\155\157\x5f\x73\141\155\x6c\137\146\x6f\x6e\164\137\163\151\172\x65"] : "\x32\x30";
        $NA = isset($A7[$I7]["\163\x73\157\137\x62\x75\x74\164\157\x6e\x5f\x6c\x6f\x67\151\x6e\137\146\x6f\162\x6d\137\160\x6f\163\x69\x74\151\157\156"]) ? $A7[$I7]["\x73\163\x6f\x5f\142\165\x74\x74\157\156\x5f\x6c\157\x67\151\x6e\137\146\x6f\x72\x6d\x5f\160\x6f\x73\x69\x74\x69\x6f\156"] : "\x61\142\157\166\x65";
        $hP = "\x3c\151\x6e\160\x75\x74\40\x74\171\160\145\75\42\142\x75\164\164\x6f\156\x22\x20\156\141\x6d\145\x3d\42\x6d\x6f\137\x73\141\155\x6c\x5f\x77\160\x5f\163\163\157\137\142\x75\164\x74\x6f\x6e\42\40\x76\141\x6c\165\145\75\x22" . $lF . "\42\x20\163\x74\171\x6c\x65\x3d\42";
        $Xn = '';
        if ($TE == "\154\x6f\x6e\x67\x62\165\164\x74\157\x6e") {
            goto Mb;
        }
        if ($TE == "\143\x69\162\143\154\145") {
            goto HN;
        }
        if ($TE == "\157\166\x61\x6c") {
            goto Aw;
        }
        if ($TE == "\163\x71\x75\x61\162\x65") {
            goto jD;
        }
        goto GU;
        HN:
        $Xn = $Xn . "\167\151\x64\x74\x68\x3a" . $t6 . "\x70\x78\x3b";
        $Xn = $Xn . "\150\x65\x69\147\x68\x74\72" . $t6 . "\160\170\x3b";
        $Xn = $Xn . "\142\x6f\x72\x64\x65\162\x2d\162\x61\144\151\x75\x73\x3a\71\x39\x39\x70\170\x3b";
        goto GU;
        Aw:
        $Xn = $Xn . "\167\x69\x64\x74\150\72" . $t6 . "\x70\x78\x3b";
        $Xn = $Xn . "\150\x65\151\147\150\164\x3a" . $t6 . "\x70\170\73";
        $Xn = $Xn . "\142\x6f\x72\144\145\162\55\x72\x61\144\x69\165\163\x3a\x35\160\170\x3b";
        goto GU;
        jD:
        $Xn = $Xn . "\167\x69\x64\164\x68\x3a" . $t6 . "\x70\170\73";
        $Xn = $Xn . "\150\x65\151\147\150\x74\72" . $t6 . "\x70\x78\73";
        $Xn = $Xn . "\x62\157\162\144\145\x72\55\x72\x61\144\151\165\163\x3a\60\160\170\x3b";
        $Xn = $Xn . "\160\141\144\144\151\x6e\x67\72\60\x70\x78\73";
        GU:
        goto Ij;
        Mb:
        $Xn = $Xn . "\167\x69\x64\x74\150\x3a" . $QP . "\160\170\73";
        $Xn = $Xn . "\150\x65\151\x67\150\164\x3a" . $w5 . "\160\170\73";
        $Xn = $Xn . "\142\x6f\x72\x64\x65\x72\x2d\162\x61\x64\151\165\x73\72" . $Yq . "\160\x78\73";
        Ij:
        $Xn = $Xn . "\142\141\143\x6b\x67\x72\x6f\x75\156\144\x2d\x63\x6f\x6c\x6f\x72\x3a\x23" . $Ur . "\73";
        $Xn = $Xn . "\142\x6f\162\144\145\x72\x2d\143\157\154\157\162\x3a\x74\x72\x61\156\163\160\141\x72\x65\156\x74\73";
        $Xn = $Xn . "\143\x6f\x6c\x6f\162\x3a\43" . $mC . "\x3b";
        $Xn = $Xn . "\x66\x6f\x6e\x74\55\x73\151\172\145\x3a" . $zH . "\x70\x78\73";
        $hP = $hP . $Xn . "\x22\x2f\76";
        $Yu = urlencode(saml_get_current_page_url());
        if (!isset($_GET["\x72\145\144\x69\162\145\x63\x74\137\x74\157"])) {
            goto Ny;
        }
        $Yu = urlencode($_GET["\x72\145\x64\151\162\145\143\x74\137\x74\x6f"]);
        Ny:
        $WS = "\74\141\x20\150\162\x65\146\x3d\42" . $jt . "\x2f\77\157\160\x74\x69\157\x6e\75\163\141\155\154\137\x75\x73\145\162\137\154\157\147\151\156\x26\162\x65\144\151\x72\145\x63\x74\137\164\157\75" . $Yu . "\x22\40\163\164\171\x6c\x65\x3d\x22\164\x65\x78\164\x2d\x64\145\143\x6f\x72\x61\164\x69\157\156\72\x6e\x6f\x6e\x65\42\x3e" . $hP . "\x3c\x2f\x61\x3e";
        $WS = "\x3c\x64\x69\x76\40\163\164\171\154\x65\x3d\42\x70\x61\144\144\x69\156\x67\72\61\60\160\x78\x3b\42\x3e" . $WS . "\x3c\x2f\x64\151\x76\x3e";
        if ($NA == "\141\142\157\166\x65") {
            goto j1;
        }
        $WS = "\x3c\144\151\x76\x20\151\144\75\x22\x73\163\157\x5f\x62\x75\164\164\157\156\x22\x20\x73\x74\x79\x6c\x65\x3d\42\x74\145\170\164\55\x61\x6c\x69\x67\x6e\x3a\143\x65\156\164\x65\162\42\x3e\x3c\144\x69\166\40\x73\x74\x79\x6c\145\75\x22\160\141\x64\144\151\156\x67\x3a\x35\x70\x78\73\x66\x6f\x6e\164\x2d\163\151\172\145\x3a\61\64\160\x78\x3b\42\x3e\74\x62\76\x4f\122\74\x2f\x62\x3e\x3c\57\144\x69\166\76" . $WS . "\x3c\x2f\x64\x69\x76\x3e\x3c\x62\162\57\76";
        goto g1;
        j1:
        $WS = "\x3c\x64\151\x76\40\x69\144\75\42\x73\163\157\x5f\x62\x75\x74\164\x6f\156\x22\40\163\x74\171\x6c\145\x3d\x22\x74\x65\x78\x74\x2d\141\x6c\151\147\x6e\72\143\145\156\164\145\x72\42\x3e" . $WS . "\74\144\x69\x76\x20\x73\x74\171\154\x65\75\42\x70\x61\144\144\x69\x6e\147\x3a\x35\x70\x78\73\x66\157\x6e\x74\55\163\x69\x7a\145\72\61\64\x70\170\73\42\x3e\74\x62\76\117\122\x3c\57\142\x3e\74\57\x64\x69\166\76\74\57\144\x69\166\x3e\x3c\x62\x72\x2f\x3e";
        $WS = $WS . "\74\163\143\x72\151\x70\x74\x3e\xd\12\11\x9\x9\11\166\x61\162\40\44\145\154\x65\155\145\156\164\x20\x3d\40\152\x51\x75\x65\162\x79\x28\x22\x23\165\x73\x65\x72\137\154\x6f\147\151\156\x22\51\73\15\12\11\11\x9\11\152\x51\165\x65\162\171\50\42\x23\163\x73\x6f\x5f\142\165\164\x74\157\x6e\42\51\56\151\156\163\145\x72\164\x42\145\x66\x6f\x72\x65\50\152\x51\x75\145\x72\171\50\42\154\x61\x62\145\154\133\x66\x6f\x72\75\47\x22\x2b\x24\x65\x6c\145\155\145\156\x74\56\x61\164\x74\162\50\x27\x69\144\47\51\x2b\42\x27\135\42\51\51\x3b\15\xa\11\x9\11\11\74\57\163\143\162\151\x70\x74\x3e";
        g1:
        echo $WS;
        kf:
    }
    function mo_get_saml_shortcode()
    {
        $A7 = maybe_unserialize(get_site_option("\x73\141\155\154\x5f\x73\163\x6f\137\x73\145\x74\x74\151\156\147\163"));
        $I7 = get_current_blog_id();
        $P0 = Utilities::get_active_sites();
        if (in_array($I7, $P0)) {
            goto Rd;
        }
        return;
        Rd:
        if (!(empty($A7[$I7]) && !empty($A7["\x44\105\x46\101\x55\x4c\x54"]))) {
            goto gA;
        }
        $A7[$I7] = $A7["\104\105\106\x41\125\114\124"];
        gA:
        if (!is_user_logged_in()) {
            goto UC;
        }
        $current_user = wp_get_current_user();
        $t2 = "\110\x65\x6c\x6c\157\x2c";
        if (empty($A7[$I7]["\x6d\x6f\x5f\163\x61\155\x6c\137\x63\165\163\x74\x6f\x6d\x5f\x67\x72\x65\x65\164\151\156\147\x5f\x74\x65\x78\164"])) {
            goto Ti;
        }
        $t2 = $A7[$I7]["\155\x6f\x5f\x73\x61\155\154\137\143\165\163\x74\157\x6d\x5f\x67\x72\x65\145\164\x69\x6e\147\x5f\164\x65\170\164"];
        Ti:
        $fh = '';
        if (empty($A7[$I7]["\155\157\137\x73\141\155\x6c\137\147\162\145\x65\x74\x69\156\x67\137\x6e\x61\155\145"])) {
            goto Th;
        }
        switch ($A7[$I7]["\155\x6f\137\163\141\x6d\154\x5f\x67\162\x65\x65\164\x69\x6e\147\x5f\156\x61\x6d\145"]) {
            case "\x55\123\105\122\x4e\101\115\x45":
                $fh = $current_user->user_login;
                goto ke;
            case "\x45\115\101\111\x4c":
                $fh = $current_user->user_email;
                goto ke;
            case "\x46\x4e\x41\x4d\x45":
                $fh = $current_user->user_firstname;
                goto ke;
            case "\x4c\116\101\x4d\x45":
                $fh = $current_user->user_lastname;
                goto ke;
            case "\106\x4e\101\115\x45\x5f\x4c\116\101\115\x45":
                $fh = $current_user->user_firstname . "\40" . $current_user->user_lastname;
                goto ke;
            case "\114\116\x41\115\x45\x5f\x46\116\101\x4d\x45":
                $fh = $current_user->user_lastname . "\40" . $current_user->user_firstname;
                goto ke;
            default:
                $fh = $current_user->user_login;
        }
        fe:
        ke:
        Th:
        if (!empty(trim($fh))) {
            goto R7;
        }
        $fh = $current_user->user_login;
        R7:
        $G4 = $t2 . "\x20" . $fh;
        $QF = "\x4c\x6f\147\x6f\x75\x74";
        if (empty($A7[$I7]["\155\157\x5f\x73\141\x6d\154\137\x63\165\163\164\157\x6d\x5f\x6c\157\147\x6f\165\x74\x5f\x74\145\x78\x74"])) {
            goto WS;
        }
        $QF = $A7[$I7]["\155\x6f\137\163\x61\155\x6c\x5f\x63\x75\163\x74\157\x6d\x5f\x6c\157\147\157\165\164\137\164\x65\170\x74"];
        WS:
        $WS = $G4 . "\x20\174\40\x3c\x61\40\x68\x72\x65\146\x3d\x22" . wp_logout_url(home_url()) . "\42\40\x74\151\x74\154\145\75\42\x6c\157\x67\x6f\x75\x74\x22\40\76" . $QF . "\74\x2f\x61\x3e\x3c\57\x6c\151\76";
        goto SH;
        UC:
        $jt = get_site_option("\155\157\x5f\163\x61\x6d\x6c\137\163\x70\137\142\141\163\145\137\165\x72\154");
        if (!empty($jt)) {
            goto QD;
        }
        $jt = home_url();
        QD:
        if (mo_saml_is_sp_configured() && mo_saml_is_customer_license_key_verified()) {
            goto Y6;
        }
        $WS = "\x53\120\40\151\x73\40\x6e\x6f\x74\x20\143\x6f\156\146\x69\147\165\x72\x65\x64\x2e";
        goto lC;
        Y6:
        $Ed = "\114\157\147\151\x6e\x20\167\151\x74\x68\40" . get_site_option("\163\141\x6d\154\x5f\151\144\x65\156\x74\151\x74\171\137\156\141\x6d\x65");
        if (empty($A7[$I7]["\x6d\x6f\137\163\x61\x6d\x6c\137\x63\165\163\164\x6f\x6d\137\154\x6f\x67\151\156\x5f\164\145\x78\164"])) {
            goto NS;
        }
        $Ed = $A7[$I7]["\x6d\x6f\137\x73\141\155\154\137\x63\x75\x73\164\157\x6d\137\x6c\157\x67\x69\x6e\137\x74\145\x78\164"];
        NS:
        $B0 = get_site_option("\x73\x61\x6d\154\x5f\151\x64\145\x6e\164\151\x74\x79\137\156\141\x6d\145");
        $Ed = str_replace("\x23\x23\x49\104\120\43\43", $B0, $Ed);
        $kQ = false;
        if (!(isset($A7[$I7]["\x6d\x6f\x5f\163\x61\x6d\x6c\x5f\165\163\145\x5f\142\x75\164\x74\157\156\137\x61\163\137\163\x68\x6f\162\164\143\157\x64\145"]) and $A7[$I7]["\x6d\x6f\x5f\163\x61\x6d\x6c\137\165\163\x65\137\142\x75\x74\x74\x6f\156\137\x61\163\x5f\x73\150\x6f\x72\x74\x63\x6f\144\145"] == "\164\162\165\x65")) {
            goto e9;
        }
        $kQ = true;
        e9:
        if (!$kQ) {
            goto Ms;
        }
        $QP = isset($A7[$I7]["\155\x6f\x5f\163\141\x6d\x6c\x5f\x62\x75\x74\x74\157\156\x5f\167\x69\x64\x74\150"]) ? $A7[$I7]["\x6d\x6f\137\163\x61\x6d\154\137\142\165\164\x74\157\x6e\137\167\151\x64\x74\x68"] : "\x31\60\60";
        $w5 = isset($A7[$I7]["\x6d\x6f\x5f\x73\x61\155\154\x5f\142\165\x74\164\x6f\156\x5f\x68\x65\x69\x67\150\164"]) ? $A7[$I7]["\155\x6f\137\x73\141\155\x6c\x5f\142\x75\x74\x74\157\x6e\x5f\x68\145\x69\147\150\x74"] : "\65\60";
        $t6 = isset($A7[$I7]["\155\x6f\x5f\163\x61\155\154\137\x62\165\164\164\x6f\156\x5f\x73\151\172\x65"]) ? $A7[$I7]["\155\x6f\x5f\163\x61\155\x6c\137\142\165\x74\x74\x6f\x6e\x5f\163\151\x7a\145"] : "\x35\x30";
        $Yq = isset($A7[$I7]["\x6d\157\137\163\141\155\x6c\137\x62\165\164\164\x6f\156\137\143\165\x72\166\145"]) ? $A7[$I7]["\x6d\x6f\137\x73\141\155\154\x5f\x62\x75\164\x74\x6f\156\x5f\x63\x75\x72\166\x65"] : "\x35";
        $Ur = isset($A7[$I7]["\x6d\157\137\x73\x61\155\x6c\137\x62\165\x74\164\x6f\x6e\x5f\x63\x6f\154\157\x72"]) ? $A7[$I7]["\155\x6f\137\163\141\155\154\x5f\142\x75\x74\x74\157\x6e\x5f\x63\x6f\x6c\157\162"] : "\x30\x30\70\65\x62\x61";
        $TE = isset($A7[$I7]["\155\157\x5f\x73\141\x6d\x6c\x5f\142\165\164\x74\x6f\x6e\x5f\164\150\x65\x6d\145"]) ? $A7[$I7]["\155\157\137\x73\x61\155\154\137\142\x75\x74\x74\157\x6e\137\x74\150\145\x6d\x65"] : "\154\157\x6e\147\142\165\x74\164\x6f\x6e";
        $lF = isset($A7[$I7]["\155\x6f\x5f\163\141\155\154\137\x62\165\x74\164\x6f\x6e\x5f\x74\145\x78\164"]) ? $A7[$I7]["\155\x6f\137\163\141\155\x6c\x5f\142\x75\164\164\x6f\x6e\x5f\164\145\170\x74"] : (get_site_option("\163\141\x6d\x6c\x5f\151\x64\145\156\x74\151\x74\171\137\x6e\141\155\145") ? get_site_option("\163\141\155\154\137\151\144\145\156\164\151\164\x79\x5f\156\x61\x6d\x65") : "\x4c\x6f\x67\151\x6e");
        $mC = isset($A7[$I7]["\155\x6f\x5f\163\x61\x6d\154\x5f\x66\157\x6e\164\x5f\x63\x6f\154\157\x72"]) ? $A7[$I7]["\x6d\x6f\x5f\x73\x61\155\x6c\x5f\x66\157\156\x74\x5f\x63\x6f\x6c\157\162"] : "\146\146\x66\x66\146\146";
        $ZY = isset($A7[$I7]["\155\x6f\137\163\x61\155\x6c\137\146\157\x6e\164\137\163\x69\x7a\145"]) ? $A7[$I7]["\155\157\137\163\x61\x6d\154\137\146\x6f\156\x74\x5f\x73\151\x7a\145"] : "\62\60";
        $Ed = "\x3c\151\x6e\160\x75\164\40\x74\171\160\145\x3d\42\142\x75\x74\164\157\156\42\40\x6e\141\155\x65\75\42\x6d\157\x5f\x73\141\155\154\x5f\x77\160\137\163\x73\x6f\137\x62\165\164\x74\x6f\156\x22\40\x76\141\154\165\145\x3d\42" . $lF . "\x22\x20\x73\164\x79\154\x65\75\42";
        $Xn = '';
        if ($TE == "\x6c\157\x6e\147\x62\x75\x74\164\157\156") {
            goto Yc;
        }
        if ($TE == "\143\x69\x72\143\154\145") {
            goto oY;
        }
        if ($TE == "\x6f\x76\141\154") {
            goto n0;
        }
        if ($TE == "\x73\161\x75\x61\x72\x65") {
            goto Yk;
        }
        goto V9;
        oY:
        $Xn = $Xn . "\x77\x69\x64\x74\x68\x3a" . $t6 . "\160\170\x3b";
        $Xn = $Xn . "\x68\x65\151\x67\150\164\x3a" . $t6 . "\x70\170\73";
        $Xn = $Xn . "\142\x6f\162\144\x65\x72\55\x72\x61\x64\151\165\163\72\x39\x39\71\160\170\x3b";
        goto V9;
        n0:
        $Xn = $Xn . "\x77\x69\x64\164\150\72" . $t6 . "\160\x78\73";
        $Xn = $Xn . "\150\145\151\147\x68\164\72" . $t6 . "\x70\170\73";
        $Xn = $Xn . "\142\157\x72\x64\x65\162\55\x72\x61\144\151\x75\163\72\65\x70\x78\x3b";
        goto V9;
        Yk:
        $Xn = $Xn . "\x77\x69\144\x74\150\72" . $t6 . "\x70\x78\x3b";
        $Xn = $Xn . "\150\x65\151\x67\x68\x74\72" . $t6 . "\160\x78\x3b";
        $Xn = $Xn . "\142\x6f\162\144\145\x72\55\x72\141\144\151\165\x73\72\60\160\x78\x3b";
        V9:
        goto WA;
        Yc:
        $Xn = $Xn . "\167\x69\144\x74\x68\x3a" . $QP . "\x70\x78\73";
        $Xn = $Xn . "\150\145\151\x67\x68\x74\x3a" . $w5 . "\x70\x78\73";
        $Xn = $Xn . "\x62\157\x72\x64\x65\162\x2d\162\x61\x64\151\165\163\72" . $Yq . "\160\x78\x3b";
        WA:
        $Xn = $Xn . "\x62\x61\143\x6b\x67\x72\x6f\x75\x6e\144\55\143\x6f\x6c\x6f\162\72\x23" . $Ur . "\x3b";
        $Xn = $Xn . "\142\x6f\162\x64\x65\162\x2d\x63\x6f\154\157\x72\72\x74\162\x61\156\163\160\141\x72\145\x6e\x74\x3b";
        $Xn = $Xn . "\x63\157\154\157\x72\x3a\43" . $mC . "\73";
        $Xn = $Xn . "\146\157\x6e\x74\x2d\x73\x69\x7a\145\72" . $ZY . "\160\170\x3b";
        $Xn = $Xn . "\x70\x61\144\144\151\156\147\72\60\x70\x78\73";
        $Ed = $Ed . $Xn . "\42\57\76";
        Ms:
        $Yu = urlencode(saml_get_current_page_url());
        $WS = "\74\x61\40\x68\162\145\146\x3d\42" . $jt . "\57\77\x6f\x70\164\151\157\156\75\163\x61\x6d\x6c\x5f\x75\x73\x65\x72\137\154\157\x67\151\156\46\x72\145\144\x69\x72\x65\143\x74\137\164\157\75" . $Yu . "\42";
        if (!$kQ) {
            goto eu;
        }
        $WS = $WS . "\x73\x74\x79\154\x65\x3d\42\x74\145\x78\x74\55\144\145\x63\x6f\162\141\x74\x69\x6f\156\72\156\157\156\x65\x3b\42";
        eu:
        $WS = $WS . "\76" . $Ed . "\x3c\x2f\x61\x3e";
        lC:
        SH:
        return $WS;
    }
    function upload_metadata()
    {
        if (!(isset($_FILES["\155\x65\x74\x61\144\141\x74\x61\x5f\x66\x69\x6c\145"]) || isset($_POST["\x6d\x65\164\141\x64\x61\164\x61\x5f\165\x72\x6c"]))) {
            goto HV;
        }
        if (!empty($_FILES["\x6d\145\x74\x61\x64\x61\x74\x61\137\146\151\x6c\145"]["\x74\x6d\160\x5f\156\x61\155\145"])) {
            goto SX;
        }
        if (mo_saml_is_extension_installed("\x63\x75\162\x6c")) {
            goto hv;
        }
        update_option("\155\x6f\x5f\x73\141\x6d\154\137\155\145\x73\x73\x61\147\x65", "\x50\x48\x50\x20\143\125\x52\x4c\40\145\170\x74\x65\156\163\151\157\x6e\x20\x69\163\40\156\157\x74\x20\x69\x6e\163\x74\x61\x6c\154\x65\144\40\157\x72\x20\144\151\163\141\x62\x6c\x65\144\56\40\103\141\x6e\156\157\164\x20\146\x65\164\x63\150\x20\x6d\145\x74\141\x64\x61\x74\x61\40\146\x72\x6f\155\x20\x55\x52\x4c\x2e");
        $this->mo_saml_show_error_message();
        return;
        hv:
        $yO = filter_var(htmlspecialchars($_POST["\155\x65\x74\x61\144\141\x74\x61\137\x75\x72\x6c"]), FILTER_SANITIZE_URL);
        $rD = Utilities::mo_saml_wp_remote_call($yO, $this, array("\x73\x73\x6c\x76\x65\162\151\x66\171" => false), true);
        if ($rD) {
            goto Gp;
        }
        update_site_option("\155\x6f\x5f\x73\x61\155\154\137\155\x65\x73\x73\x61\x67\145", "\120\154\x65\x61\163\145\40\x70\162\157\x76\x69\x64\145\40\141\40\x76\x61\x6c\x69\144\40\x6d\145\x74\141\x64\141\x74\x61\40\125\122\x4c\x2e");
        return;
        Gp:
        if (!is_null($rD)) {
            goto VB;
        }
        $CZ = null;
        goto K9;
        VB:
        $CZ = $rD;
        K9:
        if (isset($_POST["\163\x79\x6e\x63\137\x6d\x65\x74\141\144\141\x74\x61"])) {
            goto qo;
        }
        delete_site_option("\163\x61\155\154\x5f\x6d\145\x74\141\x64\141\164\141\137\x75\x72\154\x5f\x66\157\x72\137\x73\x79\156\x63");
        delete_site_option("\163\x61\x6d\154\137\155\x65\x74\x61\144\x61\x74\141\137\163\171\156\x63\137\151\156\164\x65\162\166\141\x6c");
        wp_unschedule_event(wp_next_scheduled("\155\x65\164\x61\x64\141\164\141\137\x73\x79\x6e\143\x5f\143\162\157\x6e\137\141\143\164\x69\x6f\156"), "\155\x65\x74\x61\x64\x61\164\141\x5f\x73\x79\x6e\x63\x5f\x63\162\x6f\x6e\x5f\x61\x63\x74\151\157\156");
        goto VS;
        qo:
        update_site_option("\x73\141\155\154\x5f\155\145\164\x61\144\x61\164\x61\x5f\165\x72\154\137\x66\x6f\162\x5f\x73\171\156\143", htmlspecialchars($_POST["\x6d\x65\x74\141\x64\141\164\x61\x5f\x75\162\154"]));
        update_site_option("\163\141\x6d\154\x5f\155\x65\164\x61\x64\x61\x74\x61\x5f\163\171\156\x63\137\x69\156\x74\145\x72\x76\141\154", htmlspecialchars($_POST["\163\171\x6e\x63\x5f\151\x6e\164\x65\x72\x76\x61\154"]));
        if (wp_next_scheduled("\x6d\x65\164\x61\x64\x61\x74\141\x5f\x73\171\x6e\143\137\x63\x72\x6f\156\x5f\x61\143\164\x69\x6f\x6e")) {
            goto Oa;
        }
        wp_schedule_event(time(), htmlspecialchars($_POST["\163\171\x6e\x63\137\151\x6e\164\145\162\166\x61\154"]), "\155\x65\x74\141\144\141\x74\141\137\x73\x79\x6e\143\137\143\x72\x6f\x6e\x5f\141\143\164\x69\x6f\156");
        Oa:
        VS:
        goto df;
        SX:
        $CZ = @file_get_contents($_FILES["\x6d\x65\x74\x61\x64\x61\164\x61\137\x66\x69\154\x65"]["\164\x6d\160\137\x6e\x61\x6d\145"]);
        df:
        $WV = set_error_handler(array($this, "\x68\141\156\x64\x6c\x65\x58\155\154\x45\x72\x72\x6f\x72"));
        $Mo = new DOMDocument();
        $Mo->loadXML($CZ);
        restore_error_handler();
        if (!empty($Mo->firstChild)) {
            goto P8;
        }
        if (isset($_POST["\165\160\154\157\141\144\x5f\155\145\x74\141\x64\141\164\x61"])) {
            goto hC;
        }
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\137\x6d\x65\163\163\x61\147\x65", "\x50\x6c\145\141\163\x65\40\160\x72\x6f\x76\151\144\x65\40\x61\40\166\x61\x6c\151\144\x20\155\x65\x74\x61\x64\141\164\141\x20\x55\x52\114\x2e");
        goto D2;
        hC:
        update_site_option("\155\157\137\163\x61\155\x6c\x5f\155\x65\x73\163\141\147\145", "\120\x6c\145\x61\x73\145\x20\160\162\157\166\x69\x64\145\x20\141\40\166\141\x6c\x69\144\40\155\145\164\141\x64\141\x74\x61\x20\x66\x69\x6c\145\x2e");
        D2:
        $this->mo_saml_show_error_message();
        goto fQ;
        P8:
        $TK = new MetadataReader($Mo);
        foreach ($TK->getIdentityProviders() as $FE => $n0) {
            $xI = $_POST["\163\141\155\154\137\x69\x64\145\x6e\164\x69\x74\171\x5f\x70\x72\157\166\151\144\145\162\137\156\x61\x6d\145"];
            $z_ = "\110\x74\164\160\122\x65\144\151\162\x65\x63\x74";
            $zW = '';
            if (array_key_exists("\x48\124\124\x50\x2d\122\145\x64\151\162\x65\143\x74", $n0->getLoginDetails())) {
                goto Dd;
            }
            if (!array_key_exists("\x48\x54\x54\x50\55\x50\117\123\x54", $n0->getLoginDetails())) {
                goto cP;
            }
            $z_ = "\x48\x74\x74\160\120\157\x73\164";
            $zW = $n0->getLoginURL("\110\x54\x54\x50\x2d\120\117\x53\x54");
            cP:
            goto sd;
            Dd:
            $zW = $n0->getLoginURL("\110\124\124\x50\x2d\x52\145\144\x69\x72\145\143\164");
            sd:
            $Gx = "\x48\x74\x74\160\x52\x65\x64\x69\162\x65\143\164";
            $Jy = '';
            if (array_key_exists("\110\124\x54\120\55\x52\145\144\151\x72\145\143\x74", $n0->getLogoutDetails())) {
                goto er;
            }
            if (!array_key_exists("\x48\124\x54\x50\55\120\x4f\123\x54", $n0->getLogoutDetails())) {
                goto Ua;
            }
            $Gx = "\110\164\164\x70\120\x6f\163\x74";
            $Jy = $n0->getLogoutURL("\x48\124\124\x50\55\x50\117\123\x54");
            Ua:
            goto tP;
            er:
            $Jy = $n0->getLogoutURL("\110\124\x54\x50\x2d\x52\145\144\x69\x72\145\x63\x74");
            tP:
            $UN = $n0->getEntityID();
            $ea = $n0->getSigningCertificate();
            update_site_option("\x73\141\155\154\137\151\144\145\156\164\151\164\x79\137\x6e\x61\155\145", $xI);
            update_site_option("\163\141\155\154\137\154\157\147\151\x6e\x5f\142\151\x6e\x64\151\x6e\x67\x5f\x74\x79\160\145", $z_);
            update_site_option("\163\141\x6d\154\x5f\154\157\147\151\156\x5f\x75\x72\x6c", $zW);
            update_site_option("\163\141\155\154\x5f\x6c\157\147\x6f\165\x74\x5f\142\x69\156\x64\151\x6e\147\137\x74\171\x70\145", $Gx);
            update_site_option("\163\x61\155\x6c\x5f\154\x6f\147\157\165\164\x5f\x75\x72\x6c", $Jy);
            update_site_option("\x73\x61\x6d\x6c\137\x69\x73\x73\165\x65\x72", $UN);
            update_site_option("\163\141\x6d\154\137\x6e\141\x6d\145\151\144\137\146\157\162\x6d\x61\x74", "\61\56\61\72\156\141\x6d\x65\x69\144\x2d\x66\157\x72\x6d\x61\x74\72\x75\156\163\160\x65\143\151\146\151\145\144");
            $ea = is_array($ea) ? $ea : array(0 => $ea);
            $ea;
            foreach ($ea as $FE => $Ng) {
                $ea[$FE] = Utilities::sanitize_certificate($Ng);
                Tq:
            }
            Bd:
            update_site_option("\163\141\155\154\137\170\x35\60\x39\x5f\143\x65\x72\x74\151\146\x69\143\141\x74\145", $ea);
            goto x4;
            yS:
        }
        x4:
        update_site_option("\x6d\157\137\x73\141\155\154\x5f\155\x65\163\163\x61\x67\145", "\x49\144\x65\156\164\151\164\x79\x20\120\x72\157\x76\x69\x64\145\x72\x20\144\145\164\141\151\x6c\x73\x20\163\x61\x76\x65\x64\x20\163\x75\143\x63\x65\163\x73\x66\165\x6c\154\x79\56");
        $this->mo_saml_show_success_message();
        fQ:
        HV:
    }
    function handleXmlError($DP, $WW, $x7, $Hc)
    {
        if ($DP == E_WARNING && substr_count($WW, "\x44\x4f\115\x44\x6f\x63\x75\155\x65\156\164\72\72\154\x6f\141\x64\x58\115\114\50\x29") > 0) {
            goto Bl;
        }
        return false;
        goto H1;
        Bl:
        return;
        H1:
    }
    function mo_saml_admin_page_access_denied()
    {
        $yP = get_blogs_of_user(get_current_user_id());
        if (!wp_list_filter($yP, array("\x75\x73\x65\x72\142\x6c\157\x67\x5f\151\144" => get_current_blog_id()))) {
            goto nu;
        }
        return;
        nu:
        $oJ = get_bloginfo("\156\x61\155\145");
        if (!empty($yP)) {
            goto qC;
        }
        $OM = "\131\157\165\40\x61\164\164\x65\155\160\164\145\x64\40\164\x6f\40\141\143\x63\145\x73\x73\40\x74\150\x65\40" . $oJ . "\x20\163\x69\x74\145\x2c\x20\x62\165\x74\40\x79\157\165\40\144\x6f\40\156\157\164\x20\143\165\x72\x72\145\156\164\x6c\x79\40\150\x61\166\x65\x20\160\162\x69\x76\x69\x6c\145\147\145\x73\40\157\x6e\40\164\150\x69\x73\40\x73\151\x74\x65\x2e\x20\x49\x66\x20\171\x6f\165\40\x62\145\154\x69\145\166\145\x20\x79\157\x75\40\x73\x68\157\x75\154\144\40\x62\145\40\x61\x62\x6c\x65\40\164\157\40\141\x63\143\145\x73\163\x20\164\x68\145\40" . $oJ . "\40\163\x69\164\145\54\40\x70\x6c\x65\x61\x73\x65\40\x63\x6f\x6e\x74\141\x63\x74\x20\171\157\x75\162\x20\156\145\x74\x77\x6f\x72\153\x20\141\x64\x6d\x69\x6e\x69\163\x74\162\141\164\157\162\x2e";
        mo_saml_subsite_access_denied_page($OM);
        exit;
        qC:
        $OM = "\x3c\160\76\x59\x6f\x75\40\141\x74\164\145\x6d\x70\164\145\x64\x20\x74\x6f\x20\141\143\143\145\x73\x73\x20\164\150\145\x20" . $oJ . "\x20\163\x69\164\x65\x2c\x20\142\165\164\40\x79\x6f\x75\x20\x64\157\x20\x6e\157\164\40\143\x75\162\x72\145\156\164\154\x79\40\150\x61\166\x65\x20\160\x72\151\166\x69\154\145\147\x65\x73\x20\157\156\40\x74\150\151\x73\x20\x73\151\164\145\x2e\x20\x49\x66\40\171\x6f\x75\x20\142\x65\x6c\151\145\166\x65\40\x79\x6f\x75\40\163\x68\157\165\154\x64\x20\142\145\40\x61\x62\154\145\40\164\x6f\40\141\x63\x63\x65\163\x73\x20\x74\x68\145\x20" . $oJ . "\40\x73\151\164\x65\x2c\x20\160\154\x65\141\163\145\x20\143\157\156\x74\141\143\164\x20\171\x6f\165\x72\x20\156\145\x74\167\157\x72\153\x20\141\x64\155\151\x6e\x69\x73\x74\x72\x61\164\157\162\56\74\x2f\x70\x3e";
        $OM .= "\74\160\x3e\x49\146\40\x79\x6f\x75\40\162\x65\x61\x63\150\x65\144\40\x74\150\x69\163\x20\x73\x63\x72\x65\x65\x6e\40\x62\171\40\141\143\x63\151\144\145\x6e\164\40\141\x6e\144\40\x6d\x65\141\156\x74\x20\164\157\x20\166\x69\x73\x69\164\40\157\x6e\145\x20\157\146\x20\x79\x6f\x75\162\x20\x6f\x77\x6e\40\x73\x69\x74\x65\x73\x2c\x20\150\145\x72\145\x20\141\162\145\x20\x73\157\155\x65\40\163\150\157\162\x74\x63\x75\x74\163\x20\x74\157\x20\150\145\x6c\160\40\x79\x6f\x75\x20\146\151\156\144\40\x79\157\165\162\x20\x77\x61\171\56\74\x2f\x70\76";
        $OM .= "\74\150\63\x3e\131\x6f\165\162\x20\x53\151\164\x65\163\74\x2f\150\x33\76";
        $OM .= "\x3c\x74\141\x62\154\x65\76";
        foreach ($yP as $sT) {
            $OM .= "\74\164\x72\76";
            $OM .= "\x3c\x74\144\x3e" . $sT->blogname . "\x3c\x2f\164\144\76";
            $OM .= "\74\x74\x64\76\x3c\141\x20\150\162\x65\x66\75\42" . esc_url(get_admin_url($sT->userblog_id)) . "\x22\76\126\151\x73\x69\x74\40\104\x61\163\x68\x62\x6f\141\x72\x64\x3c\x2f\141\x3e\40\x7c\x20\x3c\x61\x20\x68\x72\145\146\x3d\42" . esc_url(get_home_url($sT->userblog_id)) . "\x22\76\x56\151\145\x77\40\x53\151\164\x65\74\57\x61\x3e\74\x2f\164\x64\76";
            $OM .= "\x3c\x2f\x74\x72\x3e";
            Kz:
        }
        YA:
        $OM .= "\74\x2f\x74\x61\142\154\x65\76";
        mo_saml_subsite_access_denied_page($OM);
        exit;
    }
    function mo_saml_plugin_action_links($JI)
    {
        $JI = array_merge(array("\x3c\141\x20\150\x72\145\x66\75\x22" . esc_url(network_admin_url("\141\144\155\x69\156\x2e\160\x68\160\x3f\160\x61\147\145\75\155\x6f\137\163\141\x6d\x6c\x5f\163\x65\x74\164\x69\x6e\147\163")) . "\x22\x3e" . __("\x53\x65\164\164\151\x6e\x67\x73", "\164\145\x78\164\144\x6f\x6d\141\x69\x6e") . "\74\57\141\76"), $JI);
        return $JI;
    }
    function mo_saml_parse_expiry_date($Vx)
    {
        $eO = new DateTime($Vx);
        $EK = $eO->getTimestamp();
        return date("\x46\x20\x6a\x2c\x20\131", $EK);
    }
    function is_license_expired($kX)
    {
        $eO = new DateTime($kX);
        $b4 = new DateTime();
        if ($b4 > $eO) {
            goto f1;
        }
        return false;
        goto pM;
        f1:
        return true;
        pM:
    }
    function checkPasswordPattern($fK)
    {
        $Ay = "\x2f\x5e\x5b\50\x5c\167\51\52\50\x5c\x21\x5c\x40\x5c\43\134\x24\134\45\x5c\x5e\134\46\x5c\x2a\134\x2e\134\55\x5c\137\51\52\135\53\x24\57";
        return !preg_match($Ay, $fK);
    }
}
new saml_mo_login();
